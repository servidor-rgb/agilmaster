<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÁgilMasterPlan</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>if(typeof pdfjsLib!=='undefined'){pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';}</script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
<div id="root"></div>

<!-- Cloud sync patch: salva/ler clientes na Netlify sem mudar o app -->
<script>
(function(){
  const NETLIFY_BASE = 'https://masteragil.netlify.app/.netlify/functions';
  async function saveClientesCloud(clientes){
    try{
      await fetch(NETLIFY_BASE + '/save-clientes', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ clientes })
      });
    }catch(e){ console.warn('Falha ao salvar na nuvem', e); }
  }
  async function loadClientesCloud(){
    try{
      const r = await fetch(NETLIFY_BASE + '/get-clientes');
      const j = await r.json();
      return Array.isArray(j.clientes) ? j.clientes : [];
    }catch(e){ console.warn('Falha ao carregar da nuvem', e); return []; }
  }
  // intercepta salvamento local para também salvar na nuvem
  const __ls_set = window.localStorage.setItem.bind(window.localStorage);
  window.localStorage.setItem = function(key, value){
    try{
      if(key === 'agilmaster_clientes'){
        try { const clientes = JSON.parse(value); saveClientesCloud(clientes); } catch(e){}
      }
    }catch(e){}
    return __ls_set(key, value);
  };
  // opcional: tenta carregar da nuvem e popular o local na primeira carga
  window.addEventListener('DOMContentLoaded', async () => {
    try{
      const local = JSON.parse(localStorage.getItem('agilmaster_clientes') || '[]');
      if(!local || local.length === 0){
        const cloud = await loadClientesCloud();
        if(cloud && cloud.length){
          __ls_set('agilmaster_clientes', JSON.stringify(cloud));
          // emite evento para quem escuta mudanças (se o app ouvir)
          try{
            window.dispatchEvent(new StorageEvent('storage', {key:'agilmaster_clientes'}));
          }catch(e){}
        }
      }
    }catch(e){}
  });
})();
</script>

<script type="text/babel">
const {useState, useEffect}=React;
const FileText=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>;
const DollarSign=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>;
const AlertCircle=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>;
const Users=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
const Package=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>;
const Home=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;
const Upload=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>;
const Plus=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
const Bell=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>;
const X=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>;
const Save=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>;
const Building2=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>;
const User=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
const Truck=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 3h15v13H1z"/><path d="M16 8h4l3 3v5h-7V8z"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>;
const Tractor=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 14h12"/><circle cx="17" cy="18" r="3"/><circle cx="6" cy="18" r="3"/><path d="M21 15V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v9"/></svg>;
const Building=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><rect x="4" y="2" width="16" height="20" rx="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>;
const TrendingUp=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>;
const Trash2=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>;
const Edit=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>;
const Edit2=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>;
const BarChart3=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>;
const CheckCircle=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
const ArrowLeft=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>;
const Eye=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>;
const Search=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>;
const Filter=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>;
const Clock=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;
const ChevronRight=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"/></svg>;
const Calendar=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>;
const MapPin=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>;
const FileCheck=p=><svg width={p.size||24} height={p.size||24} fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><polyline points="9 15 11 17 15 13"/></svg>;
function AgilMasterPC() {
  const [currentView, setCurrentView] = useState('home');
  const [showNewClientWizard, setShowNewClientWizard] = useState(false);
  const [searchCPF, setSearchCPF] = useState('');
  const [selectedClient, setSelectedClient] = useState(null);
  const [isEditMode, setIsEditMode] = useState(false);

  const maskCPFBusca = (value) => {
    value = value.replace(/\D/g, '');
    if (value.length <= 3) return value;
    if (value.length <= 6) return value.slice(0,3) + '.' + value.slice(3);
    if (value.length <= 9) return value.slice(0,3) + '.' + value.slice(3,6) + '.' + value.slice(6);
    return value.slice(0,3) + '.' + value.slice(3,6) + '.' + value.slice(6,9) + '-' + value.slice(9,11);
  };

  // Carregar clientes do localStorage
  const [clients, setClients] = useState(() => {
    const saved = localStorage.getItem('agilmaster_clientes');
    if (saved) {
      const parsed = JSON.parse(saved);
      
      // Remover duplicatas por CPF (mantém o mais recente)
      const clientesUnicos = [];
      const cpfsVistos = new Set();
      
      // Ordenar por data de cadastro (mais recente primeiro)
      const ordenados = parsed.sort((a, b) => {
        const dataA = new Date(a.dataAtualizacao || a.dataCadastro || 0);
        const dataB = new Date(b.dataAtualizacao || b.dataCadastro || 0);
        return dataB - dataA;
      });
      
      for (const cliente of ordenados) {
        if (!cpfsVistos.has(cliente.cpf)) {
          clientesUnicos.push(cliente);
          cpfsVistos.add(cliente.cpf);
        }
      }
      
      // Salvar de volta sem duplicatas
      if (clientesUnicos.length !== parsed.length) {
        localStorage.setItem('agilmaster_clientes', JSON.stringify(clientesUnicos));
      }
      
      // Converter formato novo para formato de exibição
      return clientesUnicos.map(c => ({
        // Campos para exibição
        id: c.id,
        nomeCompleto: c.nomeCompleto,
        cpf: c.cpf,
        telefone: c.telefone,
        name: c.nomeCompleto,
        company: c.nomeEmpresa || 'Sem empresa',
        type: c.tipoAtendimento || 'Padrão',
        properties: c.propriedades || [],
        totalPropriedades: c.totalPropriedades || (c.propriedades ? c.propriedades.length : 0),
        hectares: c.totalHectares || 0,
        totalHectares: c.totalHectares || 0,
        volume: (c.totalHectares || 0) * 10000,
        alertsCount: c.alertsCount || 0,
        
        // ✅ MANTER DADOS COMPLETOS PARA EDIÇÃO
        dataNascimento: c.dataNascimento,
        cnpj: c.cnpj,
        email: c.email,
        enderecoCompleto: c.enderecoCompleto,
        casado: c.casado,
        nomeConjuge: c.nomeConjuge,
        cpfConjuge: c.cpfConjuge,
        nomeEmpresa: c.nomeEmpresa,
        tipoAtendimento: c.tipoAtendimento,
        grupo: c.grupo || { atuaSozinho: true, membros: [] },
        propriedades: c.propriedades || [],
        maquinas: c.maquinas || [],
        veiculos: c.veiculos || [],
        imoveis: c.imoveis || [],
        producao: c.producao || [],
        culturas: c.culturas || [],
        fruticultura: c.fruticultura || [],
        totalHectaresAgricola: c.totalHectaresAgricola || 0,
        dataCadastro: c.dataCadastro,
        dataAtualizacao: c.dataAtualizacao
      }));
    }
    // BACKUP REAL - Eliana + Vinicius
    const backupReal = [{"id":1761008127581,"nomeCompleto":"ELIANA DOS SANTOS ","dataNascimento":"10/12/1977","cpf":"274.160.458-43","cnpj":"","telefone":"19-98932-2940","email":"elianadossantos@gmail.com","enderecoCompleto":"RUA 1, N38, PARICA-PARAGOMINAS/PA","casado":true,"nomeConjuge":"VINICIUS ROCHA","cpfConjuge":"224.256.608-36","nomeEmpresa":"","tipoAtendimento":"VIP","grupo":{"atuaSozinho":false,"membros":[{"nome":"VINICIUS ALEXANDRE","cpf":"224.256.608-36","parentesco":"CÔNJUGE","participacao":"50,00","id":1761076161647}]},"propriedades":[{"numeroMatricula":"1778","nomePropriedade":"Lote 16   da  Gleba 63","hectares":"104","cidade":"Pacajá","uf":"PA","cartorio":"Pacajá ","dataEmissao":"30/09/2025","matriculaFile":"“CERTIDÃO DE INTEIRO TEOR”  TEREZA   CRISTINA   ARANHA  BATISTA, Oficial e Registradora   do Único  Ofício da Comarca de Pacajá, Estado do Pará,  por nomeação legal, etc__  CERTIFICO   que a presente é reprodução autêntica da   matrícula nº 0001778,  Livro 02, deste Cartório,   que foi extraída por meio reprográfico nos termos do Art. 19, § 1º da Lei 6.015  de 1973 e Art. 41 da Lei 8.935 de 1994, na qual ficou constatado o teor do seguinte IMÓVEL: Lote 16   da  Gleba 63,   integrante do Projeto Integrado de Altamira, localizado neste Município,   com área total de  104ha.,23a.25ca (cento e quatro hectares, vinte e três ares e vinte e cinco centiares),   com os limites e  confrontações seguintes: ao NORTE: com o lote 18 da mesma gleba; ao SUL: com o lote 14 da mesma  gleba; a ESTE: com o lote 19 da gleba 65, separados pela vicinal 63/65; e, a OESTE: com o lote 11 da  mesma gleba, descrição esta de acordo com Mapa e Memorial Descritivo e Título Definitivo de  Propriedade 4.(01)82.(01)1577 expedido pelo Instituto Nacional de Colonização e Reforma Agrária -  INCRA.   PROPRIETÁRIOS:   FRANCISCO DE ASSIS FREITAS , comerciante, portador da Cédula de  Identidade nº 27198-SSP-TO, expedida em 28/07/1989, inscrito no CPF/MF sob nº 095.947.445-53,  casado com MARIA CIDÁLIA DA SILVA FREITAS, comerciante, portadora da Cédula de Identidade nº  6065429-PC-PA, expedida em 20/04/2006, inscrita no CPF/MF sob nº 304.541.666-72, ambos casados  entre si sob regime de comunhão de bens, residentes e domiciliados na Avenida Juscelino Kubistchek n.º  220 neste Município de Pacajá - PA.   FORMA   DE   AQUISIÇÃO:   O imóvel foi adquirido por MANOEL  FERREIRA DA SILVA, lavrador, portador da Cédula de Identidade nº 6589054-PC-PA, inscrito no  CPF/MF sob nº 134.516.505-68 e sua mulher MARLY BRAGA DA SILVA, lavradora, portadora da  Cédula de Identidade nº 6660973-PC-PA, inscrita no CPF/MF sob nº 363.461.792-68, ambos brasileiros,  casados entre si sob o regime de Comunhão de Bens, residentes e domiciliados na Rua Inês Soares n.º 162,  Centro, nesta cidade de Pacajá-PA, através do Título Definitivo de Propriedade n.º 4.01.92.01/1736  expedido pelo Instituto Nacional de Colonização e Reforma Agrária – INCRA, em data de 25.10.1981,  devidamente transcrito sob o n.º-4.216, às fls. 28 do Livro 3-AE, devidamente registrado em 31 de outubro  de 1986 sob a matrícula n.º 161, às fls. 161, do Livro 02 do CRI da Comarca de Portel - PA,  posteriormente foi transferido para o Sr. FRANCISCO DE ASSIS FREITAS, acima qualificado, conforme  Escritura Pública de Compra e Venda, lavrada nas Notas deste Cartório às fls. 86 e 87 do Livro 12-A,  devidamente registrada conforme R-3-M-1626 Livro 2AG fl. 135 deste Cartório.   DOS   DOCUMENTOS  APRESENTADOS:   a) Certidão Negativa de Imóvel Rural, na qual consta as seguintes informações: a)  NIRF 7.393.198-5, Nome do   Imóvel:   Fazenda Boa   Esperança, emitida em 03.10.2011, válida até  31.03.2012, código de controle da Certidão: E8D9.1459.B6D8.7479; b) CCIR 2006/2007/2008/2009 - n.º  06260901090 em que nele consta os seguintes dados/informações a) Denominação do Imóvel: Fazenda  Boa Esperança; b) Indicações para localização do imóvel rural: BR-230 Rod. Transamazônica, Vicinal  Alagoano - TAM Lt 16 Gl 63; c) Classificação Fundiária: Pequena Propriedade; d) Código do Imóvel  Rural: 045.101.004.502-0; e) Município Sede do Imóvel Rural: Pacajá-PA; f) data de emissão: 14.12.2009.  c) Certidões de Inteiro Teor deste Cartório.   Cujos documentos apresentados ficarão arquivados na Pasta  n.º 12/2011.   TÍTULOS   AQUISITIVOS:   Transcrição n.º 4.216, às fls. 28 do Livro 3-AE e Matrícula n.º  161, às fls. 161 do Livro 02 do CRI da Comarca de Portel - PA e Matricula 1626 Livro 2AG fl. 135 deste  Cartório. Pacajá – Pará, 21 de dezembro de 2011. O presente Ato foi selado com selo de Segurança de Ato  Geral n.º 001.224.117 - R$ 88,80 - Protocolo - (item 166 da Tabela) e 001.224.118 - Abertura de Matricula  - R$ 59,20 - (item 123 da Tabela). Eu, Valdeci Paz de Jesus Filho, Escrevente Autorizado, escrevi e  subscrevo do que Dou Fé.  R-1-M-1778-Protocolo:3230-Data:-22 de dezembro de 2011.   COMPRA   E   VENDA:   O imóvel desta  Página 1   Continua na Página 2 (Verso)\nmatrícula foi transmitido pelos seus proprietários FRANCISCO DE ASSIS FREITAS, e sua mulher a Sra.  MARIA CIDÁLIA DA SILVA FREITAS, acima qualificados, a favor de   JANETE FAUSTINA DIAS ,  brasileira,   solteira,   maior   e   capaz,   agricultora,   portadora   da   Cédula   de   Identidade   nº  MG12098698-SSP-MG, inscrita no CPF/MF sob nº 938.852.966-91, residente e domiciliada na Rua Jose  Carlos Pereira, nº 903, Vila de Barra do Cuieté, Conselheiro Pena-MG. Por escritura pública de compra e  venda lavrada às fls. 70/71 do livro nº 14-A, deste Cartório. Valor – R$ 80.000,00 (oitenta mil reais).  Consta da Escritura a apresentações dos seguintes documentos: a) Certidão Negativa de Imóvel Rural, na  qual consta as seguintes informações: a) NIRF 7.393.198-5, Nome do Imóvel: Fazenda Boa Esperança,  emitida em 03.10.2011, válida até 31.03.2012, código de controle da Certidão: E8D9.1459.B6D8.7479; b)  CCIR 2006/2007/2008/2009 - n.º 06260901090 em que nele consta os seguintes dados/informações a)  Denominação do Imóvel: Fazenda Boa Esperança; b) Indicações para localização do imóvel rural: BR-230  Rod. Transamazônica, Vicinal Alagoano - TAM Lt 16 Gl 63; c) Classificação Fundiária: Pequena  Propriedade; d) Código do Imóvel Rural: 045.101.004.502-0; e) Município Sede do Imóvel Rural:  Pacajá-PA; f) data de emissão: 14.12.2009 e foi ainda me apresentado o Comprovante de Pagamento do  Imposto de Transmissão de \"Inter Vivos\", pago o valor de R$ 1.600,00 no dia 20.12.2011 no Setor de  Tributos da Prefeitura Municipal de Pacajá - Pará. Demais Condições e certidões: consta da escritura. O  presente Ato foi selado com selo de Segurança de Ato Geral n.º 001.224.121 - R$ 88,80 - Protocolo - (item  166 da Tabela) e 001.224.122 - Registro - R$ 355,10 - (item 127 da Tabela). Eu, Valdeci Paz de Jesus  Filho, Escrevente Autorizado, escrevi e subscrevo do que Dou Fé.  R-2-M-1778-Protocolo:-0007924-Data:-18 de setembro de 2019.   Por Escritura Pública de Compra e  Venda, lavrada neste Cartório às fls. 155/156 do Livro 23-E em data de 10/09/2019. A proprietária  JANETE FAUSTINA DIAS, acima qualificada, vendeu o imóvel objeto desta matricula ao Sr.   WAGNER  GUIDO DA CRUZ,   brasileiro, solteiro, maior e capaz, pecuarista, portador da Cédula de Identidade nº  103196/SSP/TO, inscrito no CPF/MF sob nº 625.256.701-91, residente e domiciliado à Rua 14 de Abril,  Alameda Pôr do Sol, 70-E, Tozette, Pacajá-PA. Pelo Preço de R$40.000,00 (quarenta mil reais) e avaliado  pela Prefeitura Municipal de Pacajá-Pará.   DOCUMENTOS   APRESENTADOS:   a) CCIR 2019: n.º  06260901090 em que nele consta os seguintes dados/informações a) Indicações para localização do imóvel  rural: BR-230 Rod. Transamazônica, Vicinal Alagoano - TAM Lt 16 Gl 63; b) Classificação Fundiária:  Pequena Propriedade; c) Código do Imóvel Rural: 045.101.004.502-0; d) Município Sede do Imóvel  Rural: Pacajá-PA;b) Certidão Negativa de Débitos relativo ao ITR's, cuja o número NIRF de referência é:  7.393.198-5, c) Declaração emitida pela Prefeitura Municipal que comprova o pagamento do Imposto de  Transmissão de \"Inter Vivos\". Demais Condições e certidões: consta da escritura. As cópias dos  documentos apresentados ficarão arquivados na pasta 09/2019 deste Cartório.   O presente Ato foi selado  com selo de Segurança de Ato Geral n.º 11.744.367 Registro (item 184 da Tabela TJ) Série H.   Eu, Valdeci  Paz de Jesus Filho, Tabelião Oficial Interino, que o digitei, conferi, assino e Dou Fé.  R-3-M-1778-Protocolo:-0008015-Data:-28 de novembro de 2019.   Pela   Cédula Rural Pignoratícia  Hipotecária n.º 130-19/0141-2,   emitida em 27/11/2019, com vencimento para 10/12/2029, a favor do  BANCO   DA   AMAZÔNIA   S/A,   Agência   de   Pacajá   -   Pará,   e   inscrito   no   CNPJ/MF   sob   nº  04.902.979/0065-09.   VALOR   FINANCIADO:   R$5.708.727,00 (cinco milhões, setecentos e oito mil e  setecentos e vinte e sete reais).   FINALIDADE:   INVESTIMENTO MISTO - CONST. CERCAS DE  ARAME, RECUPERAÇÃO DE PASTAGENS, AQUISIÇÃO DE ANIMAIS, CUSTEIO (RECRIA E  ENGORDA) + CUSTEIO ASSOCIADO.   EMITENTE:   WAGNER GUIDO DA CRUZ , brasileiro,  produtor agropecuário em geral, portador da Cédula de Identidade Civil sob nº   103196 SSP/TO,   inscrito o  CPF/MF sob nº   625.256.701-91,   residente e domiciliado à Rua Inês Soares, nº 60, Centro, Pacajá – PA.  F IÉL   DEPOSITÁRIO:   Os bens dados em garantia pignoratícia, bem como os adquiridos com o presente  financiamento, alienados fiduciariamente, ficam em poder e guarda do Sr.   WAGNER GUIDO DA CRUZ  acima qualificado, que na condição de fiel depositário, obrigando-se a zelar pela sua conservação e a não  os remover para outro local, sem prévia e expresso consentimento do Banco. O crédito deferido destina-se  para utilização na forma do ORÇAMENTO DE APLICAÇÃO constante da cédula, acrescida das taxas de  juros e demais encargos.   BENS VINCULADOS :   EM HIPOTECA CEDULAR DE PRIMEIRO GRAU E  SEM CONCORRÊNCIA DE TERCEIROS DE:   imóvel objeto desta matricula. O imóvel hipotecado fica  avaliado em R$884.095,02 (oitocentos e oitenta e quatro mil e noventa e cinco reais e dois centavos).  Página 2   Continua na Página 3\nD EMAIS   CONDIÇÕES   E   OBRIGAÇÕES :   Consta na Cédula, cuja cópia ficará arquivada na Pasta  11/2019 deste Cartório. CERTIFICO, que a cédula (Hipoteca e Penhor) fora registrada ainda no R-2  M-3054, fls. 147, livro 2AQ; R-6 M-505, fls. 09, livro 2AC; Reg-3318, fls. 115, livro 3AO. O Presente  Ato foi selado com selo de segurança de Ato Geral 11.930.357 Registro (item 219 da Tabela TJ) da Série  H. Eu, Valdeci Paz de Jesus Filho, Tabelião Oficial Interino que o digitei, conferi, assino e dou fé.  Av-4-M-1778 . Considerando o disposto no artigo 173, parágrafo único da Lei 6015/73 e artigo 765 do  Código de Normas do Estado do Pará, e a Informatização dos sistemas desta Serventia, procedo esta  averbação de ofício para constar que a presente matrícula foi transportada para o sistema de Ficha de igual  número, do Registro Geral de Imóveis desta Serventia. Pacajá - PA, 23 de novembro de 2020. Eu, Valdeci  Paz de Jesus Filho, Tabelião Oficial Interino, que o digitei, conferi, assino e dou fé.  Encerra-se o Inteiro Teor desta matrícula_____   A presente Certidão fora emitida com base nas  informações e parâmetros contidos no Pedido efetuado através da plataforma digital \"Ofício  Eletrônico\", sob gestão da ONR (Operador Nacional do Sistema de Registro Eletrônico de  Imóveis), tendo a demanda o Protocolo n°   S25090931258D ; observando esta Serventia, a atender  estritamente o disposto na solicitação.   A   presente   Certidão   fora   selada   com   o   Selo   de  segurança digital e assinada digitalmente por Kessia Lorena Mendonça Cordeiro, Escrevente. O  referido é verdade e dou fé.   Pacajá-PA; 30 de setembro de 2025.  Pacajá (PA), 30 de setembro de 2025.  Kessia Lorena Mendonça Cordeiro  Escrevente  Página 3   Última Página  SELO DIGITAL CERTIDÃO Nº:3007598 - SÉRIE:A - SELADO EM:30/09/2025  CÓDIGO DE SEGURANÇA Nº:8957003000008189321398280  1   60,80   9,12   1,52  CÓDIGO DE SEGURANÇA Nº:8957003000008189321398280\n","registroCAR":"PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12","nomeImovelRuralCAR":"FAZENDA BOA VISTA","municipioCAR":"Novo Repartimento","areaTotalCAR":"999,77","nomeProprietarioCAR":"WAGNER GUIDO DA CRUZ","cpfProprietarioCAR":"625.256.701-91","areaConsolidada":"999.7783","areaReservaLegal":"0.0000","numeroMatriculaCAR":"6931","carFile":"1. 2. 3. 4. 5. 6. 7. 8. 9.  RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Nome do Imóvel Rural: FAZENDA BOA VISTA Município: Novo Repartimento   UF: Pará Coordenadas Geográficas do Centroide do Imóvel Rural:   Latitude: 03°58'35,89\" S   Longitude: 50°45'21,65\" O Área Total (ha) do Imóvel Rural: 999,7783   Módulos Fiscais: 14,2825 Código do Protocolo: PA-1505064-6A26.F1E8.9514.8171.BC8B.A8E3.5D21.3A5A  INFORMAÇÕES GERAIS  Este documento garante o cumprimento do disposto nos § 2º do art. 14 e § 3º do art. 29 da Lei nº 12.651, de 2012, e se constitui em instrumento suficiente para atender ao disposto no art. 78-A da referida lei; O presente documento representa a confirmação de que foi realizada a declaração do imóvel rural no Cadastro Ambiental Rural-CAR e que está sujeito à validação pelo órgão competente; As informações prestadas no CAR são de caráter declaratório; Os documentos, especialmente os de caráter pessoal ou dominial, são de responsabilidade do proprietário ou possuidor rural declarante, que ficarão sujeitos às penas previstas no art. 299, do Código Penal (Decreto-Lei nº 2.848, de 7 de setembro de 1940) e no art. 69-A da Lei nº 9.605, de 12 de fevereiro de 1998; O demonstrativo da situação das informações declaradas no CAR, relativas às áreas de Preservação Permanente, de uso restrito e de Reserva Legal poderá ser acompanhado no sítio eletrônico   ; www.car.gov.br Esta inscrição do Imóvel Rural no CAR poderá ser suspensa ou cancelada, a qualquer tempo, em função do não atendimento de notificações de pendência ou inconsistências detectadas pelo órgão competente nos prazos concedidos ou por motivo de irregularidades constatadas; Este documento não substitui qualquer licença ou autorização ambiental para exploração florestal ou supressão de vegetação, como também nãodispensa as autorizações necessárias ao exercício da atividade econômica no imóvel rural; A inscrição do Imóvel Rural no CAR não será considerada título para fins de reconhecimento de direito de propriedade ou posse; e O declarante assume plena responsabilidade ambiental sobre o Imóvel Rural declarado em seu nome, sem prejuízo de responsabilização por danos ambientais em área contígua, posteriormente comprovada como de sua propriedade ou posse. RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 1/3\nImóvel  Área Consolidada   999,7783 Remanescente de Vegetação Nativa   0,0000  Reserva Legal  Área de Reserva Legal   0,0000  Imóvel  Área Total do Imóvel   999,7783 Área de Servidão Administrativa   0,0000 Área Líquida do Imóvel   999,7783  APP / Uso Restrito  Área de Preservação Permanente   0,0000 Área de Uso Restrito   0,0000  INFORMAÇÕES ADICIONAIS  Não foi detectada diferença entre a área do imóvel rural declarada conforme documentação comprobatória de propriedade ou posse e a área do imóvel identificada em representação gráfica.  REPRESENTAÇÃO GRÁFICA  IDENTIFICAÇÃO DO PROPRIETÁRIO/POSSUIDOR  CPF: 625.256.701-91   Nome: WAGNER GUIDO DA CRUZ  ÁREAS DECLARADAS (em hectares) RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 2/3\nMATRÍCULAS DAS PROPRIEDADES DO IMÓVEL  Número da Matrícula   Data do Documento   Livro   Folha   Município do Cartório  6931   13/12/2024   2   1   Novo Repartimento/PA RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 3/3\n","exercicioCCIR":"2025","codigoImovelCCIR":"950.254.203.220-9","denominacaoImovelCCIR":"FAZENDA BOA VISTA","areaTotalCCIR":"999,77","municipioCCIR":"NOVO REPARTIMENTO","ufCCIR":"PA","cpfCnpjTitularCCIR":"625.256.701-91","nomeTitularCCIR":"WAGNER GUIDO DA CRUZ","ccirFile":"MINISTÉRIO DO DESENVOLVIMENTO AGRÁRIO E AGRICULTURA FAMILIAR - MDA INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA - INCRA  CERTIFICADO DE CADASTRO DE IMÓVEL RURAL - CCIR EMISSÃO EXERCÍCIO 2025  DADOS DO IMÓVEL RURAL   PÁG.: 1 / 1  CÓDIGO DO IMÓVEL RURAL   DENOMINAÇÃO DO IMÓVEL RURAL  950.254.203.220-9   FAZENDA BOA VISTA  ÁREA TOTAL (ha)   CLASSIFICAÇÃO FUNDIÁRIA   DATA DO PROCESSAMENTO DA ÚLTIMA DECLARAÇÃO   ÁREA CERTIFICADA 7  999,7700   Média Propriedade Produtiva   10/01/2025   0,0000  INDICAÇÕES PARA LOCALIZAÇÃO DO IMÓVEL RURAL   MUNICÍPIO SEDE DO IMÓVEL RURAL   UF  LOTE 101-D GLEBA ENGENHO   NOVO REPARTIMENTO   PA  MÓDULO RURAL (ha)   Nº MÓDULOS RURAIS   MÓDULO FISCAL (ha)   Nº MÓDULOS FISCAIS   FRAÇÃO MÍNIMA DE PARCELAMENTO (ha)  70,0525   11,42   70,0000   14,2824   4,00  SITUAÇÃO JURÍDICA DO IMÓVEL RURAL (ÁREAS REGISTRADAS)  REGISTRO   ÁREA (ha) UF/MUNICÍPIO DO CARTÓRIO   DATA REGISTRO   CNS OU OFÍCIO   MATRÍCULA OU TRANSCRIÇÃO LIVRO OU FICHA  999,7700 2 PA/NOVO REPARTIMENTO   11/12/2024   67553   6931   R  ÁREA DO IMÓVEL RURAL (ha)  REGISTRADA   POSSE A JUSTO TÍTULO   POSSE POR SIMPLES OCUPAÇÃO   ÁREA MEDIDA  999,7700   0,0000   - 0,0000  DADOS DO DECLARANTE  NOME   CPF/CNPJ  WAGNER GUIDO DA CRUZ   625.256.701-91  NACIONALIDADE   TOTAL DE PESSOAS RELACIONADAS AO IMÓVEL  BRASILEIRA   1  DADOS DOS TITULARES  CPF/CNPJ   NOME   CONDIÇÃO   DETENÇÃO (%)  625.256.701-91   WAGNER GUIDO DA CRUZ   Proprietario Ou Posseiro Individual   100,00  DADOS DE CONTROLE  DATA DE LANÇAMENTO   NÚMERO DO CCIR   DATA DE GERAÇÃO DO CCIR  DATA DE VENCIMENTO: **/**/**** 16/06/2025   71184867257   29/07/2025  TAXA DE SERVIÇOS CADASTRAIS (R$)  DÉBITOS ANTERIORES   TAXA DE SERVIÇOS CADASTRAIS   VALOR COBRADO   MULTA   VALOR TOTAL JUROS  0,00   118,55   118,55   11,85   1,19   *** QUITADO ***  OBSERVAÇÕES  1. ESTE DOCUMENTO SÓ TEM VALIDADE APÓS A QUITAÇÃO DA DEVIDA TAXA. 2. TAXA DE SERVIÇOS CADASTRAIS DO EXERCÍCIO JÁ QUITADAS. 3. IMÓVEL NÃO POSSUI DADOS GEOGRÁFICOS CADASTRADOS NA BASE SIGEF/INCRA PARA APRESENTAR O CROQUI/PLANTA.  ESCLARECIMENTOS GERAIS  1. ESTE CERTIFICADO É DOCUMENTO INDISPENSÁVEL PARA DESMEMBRAR, ARRENDAR, HIPOTECAR, VENDER OU PROMETER EM VENDA O IMÓVEL RURAL E PARA HOMOLOGAÇÃO DE PARTILHA AMIGÁVEL OU JUDICIAL \"SUCESSÃO CAUSA MORTIS\", DE ACORDO COM OS PARÁGRAFOS 1º e 2º DO ARTIGO 22 DA LEI 4.947/66. 2. SEMPRE QUE OCORREREM ALTERAÇÕES NO SEU IMÓVEL, SEJA POR COMPRA, VENDA, PERMUTA, DOAÇÃO, ETC. OU NAS CONDIÇÕES DE UTILIZAÇÃO E EXPLORAÇÃO, REALIZE DECLARAÇÃO DE ATUALIZAÇÃO ATRAVÉS DA DECLARAÇÃO ELETRÔNICA DE PROPRIEDADE (DCR) OU PROCURE O INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA – INCRA OU A UNIDADE MUNICIPAL DE CADASTRAMENTO – UMC, PARA ATUALIZAR O SEU CADASTRO RURAL. 3. AS INFORMAÇÕES DESTE CERTIFICADO SÃO EXCLUSIVAMENTE CADASTRAIS, NÃO LEGITIMANDO DIREITO DE DOMÍNIO OU POSSE, CONFORME PRECEITUA O ARTIGO 3º DA LEI 5.868/72. 4. A TAXA DE SERVIÇOS CADASTRAIS FOI LANÇADA COM BASE NAS SEGUINTES LEGISLAÇÕES: LEI 8.847/94, DECRETO LEI 1.989/82, LEI 4.504/64, DECRETO 55.891/65 E DECRETOS LEI 57/66. 5. O TERMO “IMPRODUTIVO” NO CAMPO “CLASSIFICAÇÃO FUNDIÁRIA” INDICA QUE O IMÓVEL RURAL NÃO ATINGIU OS ÍNDICES QUE O CLASSIFICARIAM COMO PRODUTIVO, DE ACORDO COM O ESTABELECIDO NO ARTIGO 6º DA LEI 8.629/93. 6. FMP – FRAÇÃO MÍNIMA DE PARCELAMENTO DE ACORDO COM O ESTABELECIDO NO PARÁGRAFO 1º DO ARTIGO 8º DA LEI 5.868/72. 7. ÁREA CERTIFICADA CONFORME DISPOSTO NA LEI 10.267/01 E SUAS ALTERAÇÕES.  TAXA DE SERVIÇOS CADASTRAIS  1. O PRESENTE DOCUMENTO SÓ PODERÁ SER PAGO NO BANCO DO BRASIL. 2. O CCIR COM A TAXA DE SERVIÇOS CADASTRAIS NÃO QUITADA ATÉ A DATA DE VENCIMENTO DEVERÁ SER REEMITIDO, PARA ATUALIZAÇÃO DOS CÁLCULOS DE MULTA E JUROS - LEIS 8.022/90, 8.847/94 E 8.383/91.  3. O CCIR SÓ É VÁLIDO COM A QUITAÇÃO DA TAXA.  4. A COBRANÇA DA TAXA DE SERVIÇOS CADASTRAIS OBEDECERÁ OS SEGUINTES CRITÉRIOS: A) PARA OS IMÓVEIS RURAIS CONSTANTES NO SNCR ANTES DO ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA É RELATIVO A TODOS OS EXERCÍCIOS NÃO LANÇADOS; B) PARA OS IMÓVEIS RURAIS INCLUÍDOS NO SNCR APÓS O ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA REFERE-SE AOS EXERCÍCIOS NÃO LANÇADOS, A PARTIR DO EXERCÍCIO DE INCLUSÃO; 5. O VALOR DE DÉBITOS ANTERIORES REFERE-SE ÀS TAXAS DE EXERCÍCIOS ANTERIORES AOS EXERCÍCIOS CORRESPONDENTES AO ÚLTIMO LANÇAMENTO MASSIVO, CUJA COMPROVAÇÃO DE PAGAMENTO NÃO FOI REGISTRADA ATÉ A DATA DE EMISSÃO DESTE CERTIFICADO.  09080.11560.13527.02249 Número de Autenticidade\n","temOnus":false,"onusAtivos":"","onusFile":null,"cibITR":"7.393.198-5","nomeImovelITR":"FAZENDA 2VGA","municipioITR":"PACAJA","ufITR":"PA","areaTotalITR":"104.2","contribuinteITR":"WAGNER GUIDO DA CRUZ","cpfContribuinteITR":"625.256.701-91","validadeITR":"07/04/2026","itrFile":"MINISTÉRIO DA FAZENDA Secretaria da Receita Federal do Brasil Procuradoria-Geral da Fazenda Nacional  CERTIDÃO NEGATIVA DE DÉBITOS RELATIVOS AOS TRIBUTOS FEDERAIS E À DÍVIDA ATIVA DA UNIÃO DE IMÓVEL RURAL  CIB: 7.393.198-5 Nome do Imóvel: FAZENDA 2VGA  Município: PACAJA   UF: PA Área total (em hectares): 104,2  Contribuinte: WAGNER GUIDO DA CRUZ CPF: 625.256.701-91  Ressalvado o direito de a Fazenda Nacional cobrar e inscrever quaisquer dívidas do imóvel rural acima identificado que vierem a ser apuradas, é certificado que não constam pendências para esse imóvel rural, relativas a créditos tributários administrados pela Secretaria da Receita Federal do Brasil (RFB) e a inscrições em Dívida Ativa da União (DAU) junto à Procuradoria-Geral da Fazenda nacional (PGFN). Esta certidão se refere à situação do imóvel rural no âmbito da RFB e da PGFN. A aceitação desta certidão está condicionada à verificação de sua autenticidade na Internet, nos endereços <http://rfb.gov.br> ou <http://www.pgfn.gov.br>. Certidão emitida gratuitamente com base na Portaria Conjunta RFB/PGFN n o   1.751, de 2/10/2014. Emitida às 14:02:25 do dia 09/10/2025 <hora e data de Brasília>. Válida até 07/04/2026. Código de controle da certidão:   F733.E2E6.8C96.D4AA  Qualquer rasura ou emenda invalidará este documento.\n","quantidadeAnimais":"","fichaSanitariaFile":null,"dataEmissaoMatricula":"30/09/2025","id":1761008438654},{"numeroMatricula":"8567","nomePropriedade":"FAZENDA ARIZONA","hectares":"55,14","cidade":"ABEL FIGUEIREDO","uf":"PA","cartorio":"Rondon do Pará","dataEmissao":"09/09/2025","matriculaFile":"\n\n\n\n\n\n\nMANIFESTO DE ASSINATURAS  DAYONE ROSA DA SILVA:60501731253  https://verificador.iti.gov.br/  Documento assinado com o uso de certificado digital ICP Brasil, pelos seguinte(s) signatário(s):  Documento assinado no Assinador do Cartório do Único Ofício de Rondon do Pará/PA. Para validar acessse o link abaixo:\n","registroCAR":"PA-1500131-844A.B367.6E35.4EDD.9BE5.C333.4509.62C7","nomeImovelRuralCAR":"FAZENDA ARIZONA","municipioCAR":"Abel Figueiredo","areaTotalCAR":"55,14","nomeProprietarioCAR":"CLÁUDIO DA SILVA PEREIRA","cpfProprietarioCAR":"667.389.462-87","areaConsolidada":"46,71","areaReservaLegal":"8,40","numeroMatriculaCAR":"8.567","carFile":"1. 2. 3. 4. 5. 6. 7. 8. 9.  RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Nome do Imóvel Rural: FAZENDA ARIZONA Município: Abel Figueiredo   UF: Pará Coordenadas Geográficas do Centroide do Imóvel Rural:   Latitude: 04°51'54,92\" S   Longitude: 48°29'40,35\" O Área Total (ha) do Imóvel Rural: 55,1461   Módulos Fiscais: 0,8004 Código do Protocolo: PA-1500131-338D.A7C4.A3D8.1EC8.D28B.9CEB.7806.19C7  INFORMAÇÕES GERAIS  Este documento garante o cumprimento do disposto nos § 2º do art. 14 e § 3º do art. 29 da Lei nº 12.651, de 2012, e se constitui em instrumento suficiente para atender ao disposto no art. 78-A da referida lei; O presente documento representa a confirmação de que foi realizada a declaração do imóvel rural no Cadastro Ambiental Rural-CAR e que está sujeito à validação pelo órgão competente; As informações prestadas no CAR são de caráter declaratório; Os documentos, especialmente os de caráter pessoal ou dominial, são de responsabilidade do proprietário ou possuidor rural declarante, que ficarão sujeitos às penas previstas no art. 299, do Código Penal (Decreto-Lei nº 2.848, de 7 de setembro de 1940) e no art. 69-A da Lei nº 9.605, de 12 de fevereiro de 1998; O demonstrativo da situação das informações declaradas no CAR, relativas às áreas de Preservação Permanente, de uso restrito e de Reserva Legal poderá ser acompanhado no sítio eletrônico   ; www.car.gov.br Esta inscrição do Imóvel Rural no CAR poderá ser suspensa ou cancelada, a qualquer tempo, em função do não atendimento de notificações de pendência ou inconsistências detectadas pelo órgão competente nos prazos concedidos ou por motivo de irregularidades constatadas; Este documento não substitui qualquer licença ou autorização ambiental para exploração florestal ou supressão de vegetação, como também nãodispensa as autorizações necessárias ao exercício da atividade econômica no imóvel rural; A inscrição do Imóvel Rural no CAR não será considerada título para fins de reconhecimento de direito de propriedade ou posse; e O declarante assume plena responsabilidade ambiental sobre o Imóvel Rural declarado em seu nome, sem prejuízo de responsabilização por danos ambientais em área contígua, posteriormente comprovada como de sua propriedade ou posse. RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1500131-844A.B367.6E35.4EDD.9BE5.C333.4509.62C7   Data de Cadastro: 09/09/2019 15:17:00 CAR - Cadastro Ambiental Rural  Página 1/3\nImóvel  Área Consolidada   46,7192 Remanescente de Vegetação Nativa   8,4024  Reserva Legal  Área de Reserva Legal   8,4024  Imóvel  Área Total do Imóvel   55,1461 Área de Servidão Administrativa   0,0000 Área Líquida do Imóvel   55,1461  APP / Uso Restrito  Área de Preservação Permanente   1,6020 Área de Uso Restrito   0,0000  INFORMAÇÕES ADICIONAIS  Não foi detectada diferença entre a área do imóvel rural declarada conforme documentação comprobatória de propriedade ou posse e a área do imóvel identificada em representação gráfica.  REPRESENTAÇÃO GRÁFICA  IDENTIFICAÇÃO DO PROPRIETÁRIO/POSSUIDOR  CPF: 667.389.462-87   Nome: CLÁUDIO DA SILVA PEREIRA  ÁREAS DECLARADAS (em hectares) RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1500131-844A.B367.6E35.4EDD.9BE5.C333.4509.62C7   Data de Cadastro: 09/09/2019 15:17:00 CAR - Cadastro Ambiental Rural  Página 2/3\nMATRÍCULAS DAS PROPRIEDADES DO IMÓVEL  Número da Matrícula   Data do Documento   Livro   Folha   Município do Cartório  8.567   01/11/2019   2   -   Rondon do Pará/PA RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1500131-844A.B367.6E35.4EDD.9BE5.C333.4509.62C7   Data de Cadastro: 09/09/2019 15:17:00 CAR - Cadastro Ambiental Rural  Página 3/3\n","exercicioCCIR":"2025","codigoImovelCCIR":"951.064.063.029-0","denominacaoImovelCCIR":"FAZENDA ARIZONA","areaTotalCCIR":"55,14","municipioCCIR":"ABEL FIGUEIREDO","ufCCIR":"PA","cpfCnpjTitularCCIR":"667.389.462-87","nomeTitularCCIR":"CLAUDIO DA SILVA PEREIRA","ccirFile":"MINISTÉRIO DO DESENVOLVIMENTO AGRÁRIO E AGRICULTURA FAMILIAR - MDA INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA - INCRA  CERTIFICADO DE CADASTRO DE IMÓVEL RURAL - CCIR EMISSÃO EXERCÍCIO 2025  DADOS DO IMÓVEL RURAL   PÁG.: 1 / 1  CÓDIGO DO IMÓVEL RURAL   DENOMINAÇÃO DO IMÓVEL RURAL  951.064.063.029-0   SITIO SAVANA e FAZENDA ARIZONA  ÁREA TOTAL (ha)   CLASSIFICAÇÃO FUNDIÁRIA   DATA DO PROCESSAMENTO DA ÚLTIMA DECLARAÇÃO   ÁREA CERTIFICADA 7  125,7550   Pequena Propriedade Produtiva   21/06/2021   0,0000  INDICAÇÕES PARA LOCALIZAÇÃO DO IMÓVEL RURAL   MUNICÍPIO SEDE DO IMÓVEL RURAL   UF  BR-222, VICINAL OSVALDO BRITO, MARGEM DIREITA 6 KM   ABEL FIGUEIREDO   PA  MÓDULO RURAL (ha)   Nº MÓDULOS RURAIS   MÓDULO FISCAL (ha)   Nº MÓDULOS FISCAIS   FRAÇÃO MÍNIMA DE PARCELAMENTO (ha)  30,0131   4,19   70,0000   1,7965   3,00  SITUAÇÃO JURÍDICA DO IMÓVEL RURAL (ÁREAS REGISTRADAS)  REGISTRO   ÁREA (ha) UF/MUNICÍPIO DO CARTÓRIO   DATA REGISTRO   CNS OU OFÍCIO   MATRÍCULA OU TRANSCRIÇÃO LIVRO OU FICHA  70,6089 2 PA/RONDON DO PARÁ   19/11/2018   67355   8287   RG 55,1461 2-AM PA/RONDON DO PARÁ   01/11/2019   67355   8567   -  ÁREA DO IMÓVEL RURAL (ha)  REGISTRADA   POSSE A JUSTO TÍTULO   POSSE POR SIMPLES OCUPAÇÃO   ÁREA MEDIDA  125,7550   0,0000   125,7550 0,0000  DADOS DO DECLARANTE  NOME   CPF/CNPJ  CLAUDIO DA SILVA PEREIRA   667.389.462-87  NACIONALIDADE   TOTAL DE PESSOAS RELACIONADAS AO IMÓVEL  BRASILEIRA   1  DADOS DOS TITULARES  CPF/CNPJ   NOME   CONDIÇÃO   DETENÇÃO (%)  667.389.462-87   CLAUDIO DA SILVA PEREIRA   Proprietario Ou Posseiro Individual   100,00  DADOS DE CONTROLE  DATA DE LANÇAMENTO   NÚMERO DO CCIR   DATA DE GERAÇÃO DO CCIR  DATA DE VENCIMENTO: **/**/**** 16/06/2025   69677664254   25/06/2025  TAXA DE SERVIÇOS CADASTRAIS (R$)  DÉBITOS ANTERIORES   TAXA DE SERVIÇOS CADASTRAIS   VALOR COBRADO   MULTA   VALOR TOTAL JUROS  0,00   22,58   22,58   0,00   0,00   *** QUITADO ***  OBSERVAÇÕES  1. ESTE DOCUMENTO SÓ TEM VALIDADE APÓS A QUITAÇÃO DA DEVIDA TAXA. 2. TAXA DE SERVIÇOS CADASTRAIS DO EXERCÍCIO JÁ QUITADAS. 3. IMÓVEL NÃO POSSUI DADOS GEOGRÁFICOS CADASTRADOS NA BASE SIGEF/INCRA PARA APRESENTAR O CROQUI/PLANTA.  ESCLARECIMENTOS GERAIS  1. ESTE CERTIFICADO É DOCUMENTO INDISPENSÁVEL PARA DESMEMBRAR, ARRENDAR, HIPOTECAR, VENDER OU PROMETER EM VENDA O IMÓVEL RURAL E PARA HOMOLOGAÇÃO DE PARTILHA AMIGÁVEL OU JUDICIAL \"SUCESSÃO CAUSA MORTIS\", DE ACORDO COM OS PARÁGRAFOS 1º e 2º DO ARTIGO 22 DA LEI 4.947/66. 2. SEMPRE QUE OCORREREM ALTERAÇÕES NO SEU IMÓVEL, SEJA POR COMPRA, VENDA, PERMUTA, DOAÇÃO, ETC. OU NAS CONDIÇÕES DE UTILIZAÇÃO E EXPLORAÇÃO, REALIZE DECLARAÇÃO DE ATUALIZAÇÃO ATRAVÉS DA DECLARAÇÃO ELETRÔNICA DE PROPRIEDADE (DCR) OU PROCURE O INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA – INCRA OU A UNIDADE MUNICIPAL DE CADASTRAMENTO – UMC, PARA ATUALIZAR O SEU CADASTRO RURAL. 3. AS INFORMAÇÕES DESTE CERTIFICADO SÃO EXCLUSIVAMENTE CADASTRAIS, NÃO LEGITIMANDO DIREITO DE DOMÍNIO OU POSSE, CONFORME PRECEITUA O ARTIGO 3º DA LEI 5.868/72. 4. A TAXA DE SERVIÇOS CADASTRAIS FOI LANÇADA COM BASE NAS SEGUINTES LEGISLAÇÕES: LEI 8.847/94, DECRETO LEI 1.989/82, LEI 4.504/64, DECRETO 55.891/65 E DECRETOS LEI 57/66. 5. O TERMO “IMPRODUTIVO” NO CAMPO “CLASSIFICAÇÃO FUNDIÁRIA” INDICA QUE O IMÓVEL RURAL NÃO ATINGIU OS ÍNDICES QUE O CLASSIFICARIAM COMO PRODUTIVO, DE ACORDO COM O ESTABELECIDO NO ARTIGO 6º DA LEI 8.629/93. 6. FMP – FRAÇÃO MÍNIMA DE PARCELAMENTO DE ACORDO COM O ESTABELECIDO NO PARÁGRAFO 1º DO ARTIGO 8º DA LEI 5.868/72. 7. ÁREA CERTIFICADA CONFORME DISPOSTO NA LEI 10.267/01 E SUAS ALTERAÇÕES.  TAXA DE SERVIÇOS CADASTRAIS  1. O PRESENTE DOCUMENTO SÓ PODERÁ SER PAGO NO BANCO DO BRASIL. 2. O CCIR COM A TAXA DE SERVIÇOS CADASTRAIS NÃO QUITADA ATÉ A DATA DE VENCIMENTO DEVERÁ SER REEMITIDO, PARA ATUALIZAÇÃO DOS CÁLCULOS DE MULTA E JUROS - LEIS 8.022/90, 8.847/94 E 8.383/91.  3. O CCIR SÓ É VÁLIDO COM A QUITAÇÃO DA TAXA.  4. A COBRANÇA DA TAXA DE SERVIÇOS CADASTRAIS OBEDECERÁ OS SEGUINTES CRITÉRIOS: A) PARA OS IMÓVEIS RURAIS CONSTANTES NO SNCR ANTES DO ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA É RELATIVO A TODOS OS EXERCÍCIOS NÃO LANÇADOS; B) PARA OS IMÓVEIS RURAIS INCLUÍDOS NO SNCR APÓS O ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA REFERE-SE AOS EXERCÍCIOS NÃO LANÇADOS, A PARTIR DO EXERCÍCIO DE INCLUSÃO; 5. O VALOR DE DÉBITOS ANTERIORES REFERE-SE ÀS TAXAS DE EXERCÍCIOS ANTERIORES AOS EXERCÍCIOS CORRESPONDENTES AO ÚLTIMO LANÇAMENTO MASSIVO, CUJA COMPROVAÇÃO DE PAGAMENTO NÃO FOI REGISTRADA ATÉ A DATA DE EMISSÃO DESTE CERTIFICADO.  09660.16160.14006.02150 Número de Autenticidade\n","temOnus":false,"onusAtivos":"","onusFile":null,"cibITR":"","nomeImovelITR":"","municipioITR":"","ufITR":"PA","areaTotalITR":"","contribuinteITR":"","cpfContribuinteITR":"","validadeITR":"","itrFile":null,"quantidadeAnimais":"","fichaSanitariaFile":null,"id":1761046216666}],"maquinas":[{"tipo":"Colheitadeira","marca":"JOHN DEERE","modelo":"2025","ano":"2024","placa":"","valorEstimado":"1.500.000,00","id":1761069420154},{"tipo":"Plantadeira","marca":"JOHN DEERE","modelo":"2025","ano":"2024","placa":"","valorEstimado":"2.500.000,00","id":1761069443931},{"tipo":"Trator","marca":"CASE","modelo":"2024","ano":"2025","placa":"","valorEstimado":"380.000,00","quantidade":"1","id":1761071074277}],"veiculos":[{"tipo":"Caminhonete","marca":"TOYOTA","modelo":"HILUX","ano":"2025","placa":"","renavam":"","valorEstimado":"380.000,00","id":1761071000201},{"tipo":"Carro","marca":"CHEVROLET","modelo":"ONIX","ano":"2025","placa":"","renavam":"","valorEstimado":"35.000,00","id":1761071150462}],"imoveis":[{"tipo":"Casa","endereco":"RUA 1 N10","cidade":"PARAGOMINAS","uf":"PA","areaM2":"400,00","valorEstimado":"850.000,00","matricula":"387","id":1761071106480}],"culturas":[{"hectares":"100,00","precoKg":"1,35","sacasHa":"60,00","custoHa":"1.000,00","tipo":"SOJA","id":1761066389742,"producaoKg":"360.000","producaoTon":"360,00","receitaBruta":"486.000,00","custoTotal":"100.000,00","lucroLiquido":"386.000,00","margem":"79,42","lucroPositivo":true},{"hectares":"100,00","precoKg":"1,00","sacasHa":"120,00","custoHa":"1.000,00","tipo":"MILHO","id":1761066326740,"producaoKg":"720.000","producaoTon":"720,00","receitaBruta":"720.000,00","custoTotal":"100.000,00","lucroLiquido":"620.000,00","margem":"86,11","lucroPositivo":true}],"fruticultura":[{"cultura":"BANANA","hectares":"10","kilosHa":"40000,00","vendaKg":"2,45","custoKg":"1,35","id":1761068552171,"receitaBruta":"980000.00","custoTotal":"540000.00","lucroLiquido":"440000.00"}],"producao":[{"bovideoMacho0a12":11,"bovideoFemea0a12":13,"bovideoMacho13a24":13,"bovideoFemea13a24":"25","bovideoMacho25a36":"25","bovideoFemea25a36":36,"bovideoMachoAcima36":36,"bovideoFemeaAcima36":11,"equideoMachoAcima6":"","equideoFemeaAcima6":"","ovinoMachoAte6":"","ovinoFemeaAte6":"","ovinoMachoAcima6":"","ovinoFemeaAcima6":"","caprinoMachoAte12":"","caprinoFemeaAte12":"","caprinoMachoAcima12":"","caprinoFemeaAcima12":"","avesTotal":"","suideoMachoLeitao":"","suideoFemeaLeitao":"","suideoFemeaMatriz":"","fichaSanitariaFile":null,"id":1761078316056,"precoArroba":"310,00","valorRebanho":1511560}],"dataAtualizacao":"2025-10-21T20:26:55.700Z","status":"active","totalHectares":159.14,"totalHectaresAgricola":200,"totalAnimais":170,"totalPropriedades":2,"totalMaquinas":3,"totalVeiculos":2,"totalImoveis":1,"totalFichasSanitarias":1,"alertsCount":0},{"id":1761010053075,"nomeCompleto":"VINICIUS","dataNascimento":"15/06/1981","cpf":"224.256.608-36","cnpj":"","telefone":"19-99469-3380","email":"vini","enderecoCompleto":"","casado":false,"nomeConjuge":"","cpfConjuge":"","nomeEmpresa":"","tipoAtendimento":"Padrão","grupo":{"atuaSozinho":false,"membros":[]},"propriedades":[{"numeroMatricula":"1778","nomePropriedade":"Lote 16   da  Gleba 63","hectares":"104","cidade":"Pacajá","uf":"PA","cartorio":"Pacajá ","dataEmissao":"30/09/2025","matriculaFile":"“CERTIDÃO DE INTEIRO TEOR”  TEREZA   CRISTINA   ARANHA  BATISTA, Oficial e Registradora   do Único  Ofício da Comarca de Pacajá, Estado do Pará,  por nomeação legal, etc__  CERTIFICO   que a presente é reprodução autêntica da   matrícula nº 0001778,  Livro 02, deste Cartório,   que foi extraída por meio reprográfico nos termos do Art. 19, § 1º da Lei 6.015  de 1973 e Art. 41 da Lei 8.935 de 1994, na qual ficou constatado o teor do seguinte IMÓVEL: Lote 16   da  Gleba 63,   integrante do Projeto Integrado de Altamira, localizado neste Município,   com área total de  104ha.,23a.25ca (cento e quatro hectares, vinte e três ares e vinte e cinco centiares),   com os limites e  confrontações seguintes: ao NORTE: com o lote 18 da mesma gleba; ao SUL: com o lote 14 da mesma  gleba; a ESTE: com o lote 19 da gleba 65, separados pela vicinal 63/65; e, a OESTE: com o lote 11 da  mesma gleba, descrição esta de acordo com Mapa e Memorial Descritivo e Título Definitivo de  Propriedade 4.(01)82.(01)1577 expedido pelo Instituto Nacional de Colonização e Reforma Agrária -  INCRA.   PROPRIETÁRIOS:   FRANCISCO DE ASSIS FREITAS , comerciante, portador da Cédula de  Identidade nº 27198-SSP-TO, expedida em 28/07/1989, inscrito no CPF/MF sob nº 095.947.445-53,  casado com MARIA CIDÁLIA DA SILVA FREITAS, comerciante, portadora da Cédula de Identidade nº  6065429-PC-PA, expedida em 20/04/2006, inscrita no CPF/MF sob nº 304.541.666-72, ambos casados  entre si sob regime de comunhão de bens, residentes e domiciliados na Avenida Juscelino Kubistchek n.º  220 neste Município de Pacajá - PA.   FORMA   DE   AQUISIÇÃO:   O imóvel foi adquirido por MANOEL  FERREIRA DA SILVA, lavrador, portador da Cédula de Identidade nº 6589054-PC-PA, inscrito no  CPF/MF sob nº 134.516.505-68 e sua mulher MARLY BRAGA DA SILVA, lavradora, portadora da  Cédula de Identidade nº 6660973-PC-PA, inscrita no CPF/MF sob nº 363.461.792-68, ambos brasileiros,  casados entre si sob o regime de Comunhão de Bens, residentes e domiciliados na Rua Inês Soares n.º 162,  Centro, nesta cidade de Pacajá-PA, através do Título Definitivo de Propriedade n.º 4.01.92.01/1736  expedido pelo Instituto Nacional de Colonização e Reforma Agrária – INCRA, em data de 25.10.1981,  devidamente transcrito sob o n.º-4.216, às fls. 28 do Livro 3-AE, devidamente registrado em 31 de outubro  de 1986 sob a matrícula n.º 161, às fls. 161, do Livro 02 do CRI da Comarca de Portel - PA,  posteriormente foi transferido para o Sr. FRANCISCO DE ASSIS FREITAS, acima qualificado, conforme  Escritura Pública de Compra e Venda, lavrada nas Notas deste Cartório às fls. 86 e 87 do Livro 12-A,  devidamente registrada conforme R-3-M-1626 Livro 2AG fl. 135 deste Cartório.   DOS   DOCUMENTOS  APRESENTADOS:   a) Certidão Negativa de Imóvel Rural, na qual consta as seguintes informações: a)  NIRF 7.393.198-5, Nome do   Imóvel:   Fazenda Boa   Esperança, emitida em 03.10.2011, válida até  31.03.2012, código de controle da Certidão: E8D9.1459.B6D8.7479; b) CCIR 2006/2007/2008/2009 - n.º  06260901090 em que nele consta os seguintes dados/informações a) Denominação do Imóvel: Fazenda  Boa Esperança; b) Indicações para localização do imóvel rural: BR-230 Rod. Transamazônica, Vicinal  Alagoano - TAM Lt 16 Gl 63; c) Classificação Fundiária: Pequena Propriedade; d) Código do Imóvel  Rural: 045.101.004.502-0; e) Município Sede do Imóvel Rural: Pacajá-PA; f) data de emissão: 14.12.2009.  c) Certidões de Inteiro Teor deste Cartório.   Cujos documentos apresentados ficarão arquivados na Pasta  n.º 12/2011.   TÍTULOS   AQUISITIVOS:   Transcrição n.º 4.216, às fls. 28 do Livro 3-AE e Matrícula n.º  161, às fls. 161 do Livro 02 do CRI da Comarca de Portel - PA e Matricula 1626 Livro 2AG fl. 135 deste  Cartório. Pacajá – Pará, 21 de dezembro de 2011. O presente Ato foi selado com selo de Segurança de Ato  Geral n.º 001.224.117 - R$ 88,80 - Protocolo - (item 166 da Tabela) e 001.224.118 - Abertura de Matricula  - R$ 59,20 - (item 123 da Tabela). Eu, Valdeci Paz de Jesus Filho, Escrevente Autorizado, escrevi e  subscrevo do que Dou Fé.  R-1-M-1778-Protocolo:3230-Data:-22 de dezembro de 2011.   COMPRA   E   VENDA:   O imóvel desta  Página 1   Continua na Página 2 (Verso)\nmatrícula foi transmitido pelos seus proprietários FRANCISCO DE ASSIS FREITAS, e sua mulher a Sra.  MARIA CIDÁLIA DA SILVA FREITAS, acima qualificados, a favor de   JANETE FAUSTINA DIAS ,  brasileira,   solteira,   maior   e   capaz,   agricultora,   portadora   da   Cédula   de   Identidade   nº  MG12098698-SSP-MG, inscrita no CPF/MF sob nº 938.852.966-91, residente e domiciliada na Rua Jose  Carlos Pereira, nº 903, Vila de Barra do Cuieté, Conselheiro Pena-MG. Por escritura pública de compra e  venda lavrada às fls. 70/71 do livro nº 14-A, deste Cartório. Valor – R$ 80.000,00 (oitenta mil reais).  Consta da Escritura a apresentações dos seguintes documentos: a) Certidão Negativa de Imóvel Rural, na  qual consta as seguintes informações: a) NIRF 7.393.198-5, Nome do Imóvel: Fazenda Boa Esperança,  emitida em 03.10.2011, válida até 31.03.2012, código de controle da Certidão: E8D9.1459.B6D8.7479; b)  CCIR 2006/2007/2008/2009 - n.º 06260901090 em que nele consta os seguintes dados/informações a)  Denominação do Imóvel: Fazenda Boa Esperança; b) Indicações para localização do imóvel rural: BR-230  Rod. Transamazônica, Vicinal Alagoano - TAM Lt 16 Gl 63; c) Classificação Fundiária: Pequena  Propriedade; d) Código do Imóvel Rural: 045.101.004.502-0; e) Município Sede do Imóvel Rural:  Pacajá-PA; f) data de emissão: 14.12.2009 e foi ainda me apresentado o Comprovante de Pagamento do  Imposto de Transmissão de \"Inter Vivos\", pago o valor de R$ 1.600,00 no dia 20.12.2011 no Setor de  Tributos da Prefeitura Municipal de Pacajá - Pará. Demais Condições e certidões: consta da escritura. O  presente Ato foi selado com selo de Segurança de Ato Geral n.º 001.224.121 - R$ 88,80 - Protocolo - (item  166 da Tabela) e 001.224.122 - Registro - R$ 355,10 - (item 127 da Tabela). Eu, Valdeci Paz de Jesus  Filho, Escrevente Autorizado, escrevi e subscrevo do que Dou Fé.  R-2-M-1778-Protocolo:-0007924-Data:-18 de setembro de 2019.   Por Escritura Pública de Compra e  Venda, lavrada neste Cartório às fls. 155/156 do Livro 23-E em data de 10/09/2019. A proprietária  JANETE FAUSTINA DIAS, acima qualificada, vendeu o imóvel objeto desta matricula ao Sr.   WAGNER  GUIDO DA CRUZ,   brasileiro, solteiro, maior e capaz, pecuarista, portador da Cédula de Identidade nº  103196/SSP/TO, inscrito no CPF/MF sob nº 625.256.701-91, residente e domiciliado à Rua 14 de Abril,  Alameda Pôr do Sol, 70-E, Tozette, Pacajá-PA. Pelo Preço de R$40.000,00 (quarenta mil reais) e avaliado  pela Prefeitura Municipal de Pacajá-Pará.   DOCUMENTOS   APRESENTADOS:   a) CCIR 2019: n.º  06260901090 em que nele consta os seguintes dados/informações a) Indicações para localização do imóvel  rural: BR-230 Rod. Transamazônica, Vicinal Alagoano - TAM Lt 16 Gl 63; b) Classificação Fundiária:  Pequena Propriedade; c) Código do Imóvel Rural: 045.101.004.502-0; d) Município Sede do Imóvel  Rural: Pacajá-PA;b) Certidão Negativa de Débitos relativo ao ITR's, cuja o número NIRF de referência é:  7.393.198-5, c) Declaração emitida pela Prefeitura Municipal que comprova o pagamento do Imposto de  Transmissão de \"Inter Vivos\". Demais Condições e certidões: consta da escritura. As cópias dos  documentos apresentados ficarão arquivados na pasta 09/2019 deste Cartório.   O presente Ato foi selado  com selo de Segurança de Ato Geral n.º 11.744.367 Registro (item 184 da Tabela TJ) Série H.   Eu, Valdeci  Paz de Jesus Filho, Tabelião Oficial Interino, que o digitei, conferi, assino e Dou Fé.  R-3-M-1778-Protocolo:-0008015-Data:-28 de novembro de 2019.   Pela   Cédula Rural Pignoratícia  Hipotecária n.º 130-19/0141-2,   emitida em 27/11/2019, com vencimento para 10/12/2029, a favor do  BANCO   DA   AMAZÔNIA   S/A,   Agência   de   Pacajá   -   Pará,   e   inscrito   no   CNPJ/MF   sob   nº  04.902.979/0065-09.   VALOR   FINANCIADO:   R$5.708.727,00 (cinco milhões, setecentos e oito mil e  setecentos e vinte e sete reais).   FINALIDADE:   INVESTIMENTO MISTO - CONST. CERCAS DE  ARAME, RECUPERAÇÃO DE PASTAGENS, AQUISIÇÃO DE ANIMAIS, CUSTEIO (RECRIA E  ENGORDA) + CUSTEIO ASSOCIADO.   EMITENTE:   WAGNER GUIDO DA CRUZ , brasileiro,  produtor agropecuário em geral, portador da Cédula de Identidade Civil sob nº   103196 SSP/TO,   inscrito o  CPF/MF sob nº   625.256.701-91,   residente e domiciliado à Rua Inês Soares, nº 60, Centro, Pacajá – PA.  F IÉL   DEPOSITÁRIO:   Os bens dados em garantia pignoratícia, bem como os adquiridos com o presente  financiamento, alienados fiduciariamente, ficam em poder e guarda do Sr.   WAGNER GUIDO DA CRUZ  acima qualificado, que na condição de fiel depositário, obrigando-se a zelar pela sua conservação e a não  os remover para outro local, sem prévia e expresso consentimento do Banco. O crédito deferido destina-se  para utilização na forma do ORÇAMENTO DE APLICAÇÃO constante da cédula, acrescida das taxas de  juros e demais encargos.   BENS VINCULADOS :   EM HIPOTECA CEDULAR DE PRIMEIRO GRAU E  SEM CONCORRÊNCIA DE TERCEIROS DE:   imóvel objeto desta matricula. O imóvel hipotecado fica  avaliado em R$884.095,02 (oitocentos e oitenta e quatro mil e noventa e cinco reais e dois centavos).  Página 2   Continua na Página 3\nD EMAIS   CONDIÇÕES   E   OBRIGAÇÕES :   Consta na Cédula, cuja cópia ficará arquivada na Pasta  11/2019 deste Cartório. CERTIFICO, que a cédula (Hipoteca e Penhor) fora registrada ainda no R-2  M-3054, fls. 147, livro 2AQ; R-6 M-505, fls. 09, livro 2AC; Reg-3318, fls. 115, livro 3AO. O Presente  Ato foi selado com selo de segurança de Ato Geral 11.930.357 Registro (item 219 da Tabela TJ) da Série  H. Eu, Valdeci Paz de Jesus Filho, Tabelião Oficial Interino que o digitei, conferi, assino e dou fé.  Av-4-M-1778 . Considerando o disposto no artigo 173, parágrafo único da Lei 6015/73 e artigo 765 do  Código de Normas do Estado do Pará, e a Informatização dos sistemas desta Serventia, procedo esta  averbação de ofício para constar que a presente matrícula foi transportada para o sistema de Ficha de igual  número, do Registro Geral de Imóveis desta Serventia. Pacajá - PA, 23 de novembro de 2020. Eu, Valdeci  Paz de Jesus Filho, Tabelião Oficial Interino, que o digitei, conferi, assino e dou fé.  Encerra-se o Inteiro Teor desta matrícula_____   A presente Certidão fora emitida com base nas  informações e parâmetros contidos no Pedido efetuado através da plataforma digital \"Ofício  Eletrônico\", sob gestão da ONR (Operador Nacional do Sistema de Registro Eletrônico de  Imóveis), tendo a demanda o Protocolo n°   S25090931258D ; observando esta Serventia, a atender  estritamente o disposto na solicitação.   A   presente   Certidão   fora   selada   com   o   Selo   de  segurança digital e assinada digitalmente por Kessia Lorena Mendonça Cordeiro, Escrevente. O  referido é verdade e dou fé.   Pacajá-PA; 30 de setembro de 2025.  Pacajá (PA), 30 de setembro de 2025.  Kessia Lorena Mendonça Cordeiro  Escrevente  Página 3   Última Página  SELO DIGITAL CERTIDÃO Nº:3007598 - SÉRIE:A - SELADO EM:30/09/2025  CÓDIGO DE SEGURANÇA Nº:8957003000008189321398280  1   60,80   9,12   1,52  CÓDIGO DE SEGURANÇA Nº:8957003000008189321398280\n","registroCAR":"PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12","nomeImovelRuralCAR":"FAZENDA BOA VISTA","municipioCAR":"Novo Repartimento","areaTotalCAR":"999,77","nomeProprietarioCAR":"WAGNER GUIDO DA CRUZ","cpfProprietarioCAR":"625.256.701-91","areaConsolidada":"999.7783","areaReservaLegal":"0.0000","numeroMatriculaCAR":"6931","carFile":"1. 2. 3. 4. 5. 6. 7. 8. 9.  RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Nome do Imóvel Rural: FAZENDA BOA VISTA Município: Novo Repartimento   UF: Pará Coordenadas Geográficas do Centroide do Imóvel Rural:   Latitude: 03°58'35,89\" S   Longitude: 50°45'21,65\" O Área Total (ha) do Imóvel Rural: 999,7783   Módulos Fiscais: 14,2825 Código do Protocolo: PA-1505064-6A26.F1E8.9514.8171.BC8B.A8E3.5D21.3A5A  INFORMAÇÕES GERAIS  Este documento garante o cumprimento do disposto nos § 2º do art. 14 e § 3º do art. 29 da Lei nº 12.651, de 2012, e se constitui em instrumento suficiente para atender ao disposto no art. 78-A da referida lei; O presente documento representa a confirmação de que foi realizada a declaração do imóvel rural no Cadastro Ambiental Rural-CAR e que está sujeito à validação pelo órgão competente; As informações prestadas no CAR são de caráter declaratório; Os documentos, especialmente os de caráter pessoal ou dominial, são de responsabilidade do proprietário ou possuidor rural declarante, que ficarão sujeitos às penas previstas no art. 299, do Código Penal (Decreto-Lei nº 2.848, de 7 de setembro de 1940) e no art. 69-A da Lei nº 9.605, de 12 de fevereiro de 1998; O demonstrativo da situação das informações declaradas no CAR, relativas às áreas de Preservação Permanente, de uso restrito e de Reserva Legal poderá ser acompanhado no sítio eletrônico   ; www.car.gov.br Esta inscrição do Imóvel Rural no CAR poderá ser suspensa ou cancelada, a qualquer tempo, em função do não atendimento de notificações de pendência ou inconsistências detectadas pelo órgão competente nos prazos concedidos ou por motivo de irregularidades constatadas; Este documento não substitui qualquer licença ou autorização ambiental para exploração florestal ou supressão de vegetação, como também nãodispensa as autorizações necessárias ao exercício da atividade econômica no imóvel rural; A inscrição do Imóvel Rural no CAR não será considerada título para fins de reconhecimento de direito de propriedade ou posse; e O declarante assume plena responsabilidade ambiental sobre o Imóvel Rural declarado em seu nome, sem prejuízo de responsabilização por danos ambientais em área contígua, posteriormente comprovada como de sua propriedade ou posse. RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 1/3\nImóvel  Área Consolidada   999,7783 Remanescente de Vegetação Nativa   0,0000  Reserva Legal  Área de Reserva Legal   0,0000  Imóvel  Área Total do Imóvel   999,7783 Área de Servidão Administrativa   0,0000 Área Líquida do Imóvel   999,7783  APP / Uso Restrito  Área de Preservação Permanente   0,0000 Área de Uso Restrito   0,0000  INFORMAÇÕES ADICIONAIS  Não foi detectada diferença entre a área do imóvel rural declarada conforme documentação comprobatória de propriedade ou posse e a área do imóvel identificada em representação gráfica.  REPRESENTAÇÃO GRÁFICA  IDENTIFICAÇÃO DO PROPRIETÁRIO/POSSUIDOR  CPF: 625.256.701-91   Nome: WAGNER GUIDO DA CRUZ  ÁREAS DECLARADAS (em hectares) RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 2/3\nMATRÍCULAS DAS PROPRIEDADES DO IMÓVEL  Número da Matrícula   Data do Documento   Livro   Folha   Município do Cartório  6931   13/12/2024   2   1   Novo Repartimento/PA RECIBO DE INSCRIÇÃO DO IMÓVEL RURAL NO CAR  Registro no CAR: PA-1505064-9CED.CF32.AA54.42B7.9786.CED5.30A9.EC12   Data de Cadastro: 23/08/2024 15:12:45 CAR - Cadastro Ambiental Rural  Página 3/3\n","exercicioCCIR":"2025","codigoImovelCCIR":"950.254.203.220-9","denominacaoImovelCCIR":"FAZENDA BOA VISTA","areaTotalCCIR":"999,77","municipioCCIR":"NOVO REPARTIMENTO","ufCCIR":"PA","cpfCnpjTitularCCIR":"625.256.701-91","nomeTitularCCIR":"WAGNER GUIDO DA CRUZ","ccirFile":"MINISTÉRIO DO DESENVOLVIMENTO AGRÁRIO E AGRICULTURA FAMILIAR - MDA INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA - INCRA  CERTIFICADO DE CADASTRO DE IMÓVEL RURAL - CCIR EMISSÃO EXERCÍCIO 2025  DADOS DO IMÓVEL RURAL   PÁG.: 1 / 1  CÓDIGO DO IMÓVEL RURAL   DENOMINAÇÃO DO IMÓVEL RURAL  950.254.203.220-9   FAZENDA BOA VISTA  ÁREA TOTAL (ha)   CLASSIFICAÇÃO FUNDIÁRIA   DATA DO PROCESSAMENTO DA ÚLTIMA DECLARAÇÃO   ÁREA CERTIFICADA 7  999,7700   Média Propriedade Produtiva   10/01/2025   0,0000  INDICAÇÕES PARA LOCALIZAÇÃO DO IMÓVEL RURAL   MUNICÍPIO SEDE DO IMÓVEL RURAL   UF  LOTE 101-D GLEBA ENGENHO   NOVO REPARTIMENTO   PA  MÓDULO RURAL (ha)   Nº MÓDULOS RURAIS   MÓDULO FISCAL (ha)   Nº MÓDULOS FISCAIS   FRAÇÃO MÍNIMA DE PARCELAMENTO (ha)  70,0525   11,42   70,0000   14,2824   4,00  SITUAÇÃO JURÍDICA DO IMÓVEL RURAL (ÁREAS REGISTRADAS)  REGISTRO   ÁREA (ha) UF/MUNICÍPIO DO CARTÓRIO   DATA REGISTRO   CNS OU OFÍCIO   MATRÍCULA OU TRANSCRIÇÃO LIVRO OU FICHA  999,7700 2 PA/NOVO REPARTIMENTO   11/12/2024   67553   6931   R  ÁREA DO IMÓVEL RURAL (ha)  REGISTRADA   POSSE A JUSTO TÍTULO   POSSE POR SIMPLES OCUPAÇÃO   ÁREA MEDIDA  999,7700   0,0000   - 0,0000  DADOS DO DECLARANTE  NOME   CPF/CNPJ  WAGNER GUIDO DA CRUZ   625.256.701-91  NACIONALIDADE   TOTAL DE PESSOAS RELACIONADAS AO IMÓVEL  BRASILEIRA   1  DADOS DOS TITULARES  CPF/CNPJ   NOME   CONDIÇÃO   DETENÇÃO (%)  625.256.701-91   WAGNER GUIDO DA CRUZ   Proprietario Ou Posseiro Individual   100,00  DADOS DE CONTROLE  DATA DE LANÇAMENTO   NÚMERO DO CCIR   DATA DE GERAÇÃO DO CCIR  DATA DE VENCIMENTO: **/**/**** 16/06/2025   71184867257   29/07/2025  TAXA DE SERVIÇOS CADASTRAIS (R$)  DÉBITOS ANTERIORES   TAXA DE SERVIÇOS CADASTRAIS   VALOR COBRADO   MULTA   VALOR TOTAL JUROS  0,00   118,55   118,55   11,85   1,19   *** QUITADO ***  OBSERVAÇÕES  1. ESTE DOCUMENTO SÓ TEM VALIDADE APÓS A QUITAÇÃO DA DEVIDA TAXA. 2. TAXA DE SERVIÇOS CADASTRAIS DO EXERCÍCIO JÁ QUITADAS. 3. IMÓVEL NÃO POSSUI DADOS GEOGRÁFICOS CADASTRADOS NA BASE SIGEF/INCRA PARA APRESENTAR O CROQUI/PLANTA.  ESCLARECIMENTOS GERAIS  1. ESTE CERTIFICADO É DOCUMENTO INDISPENSÁVEL PARA DESMEMBRAR, ARRENDAR, HIPOTECAR, VENDER OU PROMETER EM VENDA O IMÓVEL RURAL E PARA HOMOLOGAÇÃO DE PARTILHA AMIGÁVEL OU JUDICIAL \"SUCESSÃO CAUSA MORTIS\", DE ACORDO COM OS PARÁGRAFOS 1º e 2º DO ARTIGO 22 DA LEI 4.947/66. 2. SEMPRE QUE OCORREREM ALTERAÇÕES NO SEU IMÓVEL, SEJA POR COMPRA, VENDA, PERMUTA, DOAÇÃO, ETC. OU NAS CONDIÇÕES DE UTILIZAÇÃO E EXPLORAÇÃO, REALIZE DECLARAÇÃO DE ATUALIZAÇÃO ATRAVÉS DA DECLARAÇÃO ELETRÔNICA DE PROPRIEDADE (DCR) OU PROCURE O INSTITUTO NACIONAL DE COLONIZAÇÃO E REFORMA AGRÁRIA – INCRA OU A UNIDADE MUNICIPAL DE CADASTRAMENTO – UMC, PARA ATUALIZAR O SEU CADASTRO RURAL. 3. AS INFORMAÇÕES DESTE CERTIFICADO SÃO EXCLUSIVAMENTE CADASTRAIS, NÃO LEGITIMANDO DIREITO DE DOMÍNIO OU POSSE, CONFORME PRECEITUA O ARTIGO 3º DA LEI 5.868/72. 4. A TAXA DE SERVIÇOS CADASTRAIS FOI LANÇADA COM BASE NAS SEGUINTES LEGISLAÇÕES: LEI 8.847/94, DECRETO LEI 1.989/82, LEI 4.504/64, DECRETO 55.891/65 E DECRETOS LEI 57/66. 5. O TERMO “IMPRODUTIVO” NO CAMPO “CLASSIFICAÇÃO FUNDIÁRIA” INDICA QUE O IMÓVEL RURAL NÃO ATINGIU OS ÍNDICES QUE O CLASSIFICARIAM COMO PRODUTIVO, DE ACORDO COM O ESTABELECIDO NO ARTIGO 6º DA LEI 8.629/93. 6. FMP – FRAÇÃO MÍNIMA DE PARCELAMENTO DE ACORDO COM O ESTABELECIDO NO PARÁGRAFO 1º DO ARTIGO 8º DA LEI 5.868/72. 7. ÁREA CERTIFICADA CONFORME DISPOSTO NA LEI 10.267/01 E SUAS ALTERAÇÕES.  TAXA DE SERVIÇOS CADASTRAIS  1. O PRESENTE DOCUMENTO SÓ PODERÁ SER PAGO NO BANCO DO BRASIL. 2. O CCIR COM A TAXA DE SERVIÇOS CADASTRAIS NÃO QUITADA ATÉ A DATA DE VENCIMENTO DEVERÁ SER REEMITIDO, PARA ATUALIZAÇÃO DOS CÁLCULOS DE MULTA E JUROS - LEIS 8.022/90, 8.847/94 E 8.383/91.  3. O CCIR SÓ É VÁLIDO COM A QUITAÇÃO DA TAXA.  4. A COBRANÇA DA TAXA DE SERVIÇOS CADASTRAIS OBEDECERÁ OS SEGUINTES CRITÉRIOS: A) PARA OS IMÓVEIS RURAIS CONSTANTES NO SNCR ANTES DO ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA É RELATIVO A TODOS OS EXERCÍCIOS NÃO LANÇADOS; B) PARA OS IMÓVEIS RURAIS INCLUÍDOS NO SNCR APÓS O ÚLTIMO LANÇAMENTO MASSIVO, O VALOR DA TAXA REFERE-SE AOS EXERCÍCIOS NÃO LANÇADOS, A PARTIR DO EXERCÍCIO DE INCLUSÃO; 5. O VALOR DE DÉBITOS ANTERIORES REFERE-SE ÀS TAXAS DE EXERCÍCIOS ANTERIORES AOS EXERCÍCIOS CORRESPONDENTES AO ÚLTIMO LANÇAMENTO MASSIVO, CUJA COMPROVAÇÃO DE PAGAMENTO NÃO FOI REGISTRADA ATÉ A DATA DE EMISSÃO DESTE CERTIFICADO.  09080.11560.13527.02249 Número de Autenticidade\n","temOnus":"R4","onusAtivos":"Hipoteca cedular de 1º grau (Cédula Rural Pignoratícia Hipotecária nº 130-19/0141-2), em favor do Banco da Amazônia S/A, emitida em 27/11/2019, com vencimento em 10/12/2029. Valor financiado: R$ 5.708.727,00. (Consta no Inteiro Teor da Matrícula 1778). ","onusFile":"\n\n","cibITR":"7.393.198-5","nomeImovelITR":"FAZENDA 2VGA","municipioITR":"PACAJA","ufITR":"PA","areaTotalITR":"104.2","contribuinteITR":"WAGNER GUIDO DA CRUZ","cpfContribuinteITR":"625.256.701-91","validadeITR":"07/04/2026","itrFile":"MINISTÉRIO DA FAZENDA Secretaria da Receita Federal do Brasil Procuradoria-Geral da Fazenda Nacional  CERTIDÃO NEGATIVA DE DÉBITOS RELATIVOS AOS TRIBUTOS FEDERAIS E À DÍVIDA ATIVA DA UNIÃO DE IMÓVEL RURAL  CIB: 7.393.198-5 Nome do Imóvel: FAZENDA 2VGA  Município: PACAJA   UF: PA Área total (em hectares): 104,2  Contribuinte: WAGNER GUIDO DA CRUZ CPF: 625.256.701-91  Ressalvado o direito de a Fazenda Nacional cobrar e inscrever quaisquer dívidas do imóvel rural acima identificado que vierem a ser apuradas, é certificado que não constam pendências para esse imóvel rural, relativas a créditos tributários administrados pela Secretaria da Receita Federal do Brasil (RFB) e a inscrições em Dívida Ativa da União (DAU) junto à Procuradoria-Geral da Fazenda nacional (PGFN). Esta certidão se refere à situação do imóvel rural no âmbito da RFB e da PGFN. A aceitação desta certidão está condicionada à verificação de sua autenticidade na Internet, nos endereços <http://rfb.gov.br> ou <http://www.pgfn.gov.br>. Certidão emitida gratuitamente com base na Portaria Conjunta RFB/PGFN n o   1.751, de 2/10/2014. Emitida às 14:02:25 do dia 09/10/2025 <hora e data de Brasília>. Válida até 07/04/2026. Código de controle da certidão:   F733.E2E6.8C96.D4AA  Qualquer rasura ou emenda invalidará este documento.\n","quantidadeAnimais":"","fichaSanitariaFile":null,"dataEmissaoMatricula":"30/09/2025","id":1761009936139}],"maquinas":[],"veiculos":[],"imoveis":[],"producao":[{"bovideoMacho0a12":11,"bovideoFemea0a12":13,"bovideoMacho13a24":13,"bovideoFemea13a24":25,"bovideoMacho25a36":25,"bovideoFemea25a36":36,"bovideoMachoAcima36":36,"bovideoFemeaAcima36":11,"equideoMachoAcima6":"","equideoFemeaAcima6":"","ovinoMachoAte6":"","ovinoFemeaAte6":"","ovinoMachoAcima6":"","ovinoFemeaAcima6":"","caprinoMachoAte12":"","caprinoFemeaAte12":"","caprinoMachoAcima12":"","caprinoFemeaAcima12":"","avesTotal":"","suideoMachoLeitao":"","suideoFemeaLeitao":"","suideoFemeaMatriz":"","fichaSanitariaFile":null,"id":1761009988393}],"dataCadastro":"2025-10-21T01:27:33.075Z","dataAtualizacao":"2025-10-21T01:27:33.076Z","status":"active","totalHectares":104,"totalAnimais":170,"totalPropriedades":1,"totalMaquinas":0,"totalVeiculos":0,"totalImoveis":0,"totalFichasSanitarias":1,"alertsCount":0}];
    // Salvar imediatamente no localStorage
    localStorage.setItem('agilmaster_clientes', JSON.stringify(backupReal));
    console.log('✅ BACKUP CARREGADO:', backupReal.length, 'clientes');
    return backupReal;
  });


  // ✅ SALVAR AUTOMATICAMENTE quando clients mudar
  React.useEffect(() => {
    if (clients && clients.length > 0) {
      localStorage.setItem('agilmaster_clientes', JSON.stringify(clients));
      console.log('💾 Salvou automaticamente:', clients.length, 'clientes');
    }
  }, [clients]);

  // Calcular percentual completo do cliente (dados + propriedades + documentos)
  const calcularPercentualCliente = (cliente) => {
    let pontos = 0;
    let total = 0;

    // 1. DADOS BÁSICOS (40 pontos)
    total += 40;
    if (cliente.name || cliente.nomeCompleto) pontos += 10;
    if (cliente.cpf) pontos += 10;
    if (cliente.phone || cliente.telefone) pontos += 10;
    if (cliente.email) pontos += 10;

    // 2. PROPRIEDADES (30 pontos)
    total += 30;
    if (cliente.properties && cliente.properties.length > 0) {
      pontos += 30;
    } else if (cliente.propriedades && cliente.propriedades.length > 0) {
      pontos += 30;
    }

    // 3. DOCUMENTOS DAS PROPRIEDADES (30 pontos)
    total += 30;
    const props = cliente.properties || cliente.propriedades || [];
    if (props.length > 0) {
      const prop = props[0]; // Primeira propriedade
      let docsCompletos = 0;
      if (prop.matriculaFile) docsCompletos++;
      if (prop.carFile) docsCompletos++;
      if (prop.ccirFile) docsCompletos++;
      if (prop.itrFile) docsCompletos++;
      pontos += Math.round((docsCompletos / 4) * 30);
    }

    return Math.round((pontos / total) * 100);
  };

  // Determinar cor da barra baseado no percentual
  const getCorBarra = (percentual) => {
    if (percentual === 100) return 'bg-green-500';
    if (percentual >= 50) return 'bg-yellow-500';
    return 'bg-red-500';
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-emerald-50 via-white to-yellow-50">
      <header className="bg-gradient-to-r from-emerald-900 to-emerald-800 border-b-4 border-yellow-600 shadow-lg sticky top-0 z-40">
        <div className="px-6 py-4 flex items-center justify-between">
          <div>
            <h1 className="text-2xl font-bold text-yellow-400">ÁgilMasterPlan</h1>
            <p className="text-sm text-emerald-200">Sistema de Gestão ÁgilAgro</p>
          </div>
          <div className="flex items-center gap-4">
            <Bell className="text-yellow-400" size={22} />
            <div className="w-10 h-10 rounded-full bg-yellow-500 flex items-center justify-center text-emerald-900 font-bold">AG</div>
          </div>
        </div>

        <div className="px-6 pb-3 flex gap-2">
          <button onClick={() => setCurrentView('home')} className={`px-4 py-2 rounded-lg font-medium ${currentView === 'home' ? 'bg-yellow-500 text-emerald-900' : 'text-yellow-200 hover:bg-emerald-800'}`}>Dashboard</button>
          <button onClick={() => setCurrentView('clients')} className={`px-4 py-2 rounded-lg font-medium ${currentView === 'clients' ? 'bg-yellow-500 text-emerald-900' : 'text-yellow-200 hover:bg-emerald-800'}`}>Clientes</button>
          <button onClick={() => setCurrentView('gerenciar')} className={`px-4 py-2 rounded-lg font-medium ${currentView === 'gerenciar' ? 'bg-yellow-500 text-emerald-900' : 'text-yellow-200 hover:bg-emerald-800'}`}>⚙️ Gerenciar</button>
        </div>
      </header>

      {currentView === 'home' && (
        <div className="p-6 max-w-7xl mx-auto">
          <h2 className="text-3xl font-bold text-emerald-900 mb-6">Dashboard Geral</h2>
          <div className="grid grid-cols-4 gap-4">
            <div 
              onClick={() => setCurrentView('clients')}
              className="bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-xl p-6 text-white shadow-lg cursor-pointer hover:shadow-2xl hover:scale-105 transition-all"
            >
              <Users size={32} className="mb-4" />
              <h3 className="text-4xl font-bold">{clients.length}</h3>
              <p className="text-emerald-100 text-sm">clientes ativos</p>
            </div>
            <div className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg">
              <Package size={32} className="mb-4" />
              <h3 className="text-4xl font-bold">4.500</h3>
              <p className="text-blue-100 text-sm">hectares</p>
            </div>
            <div className="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl p-6 text-emerald-900 shadow-lg">
              <DollarSign size={32} className="mb-4" />
              <h3 className="text-4xl font-bold">R$ 35M</h3>
              <p className="text-yellow-800 text-sm">em gestão</p>
            </div>
            <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white shadow-lg">
              <TrendingUp size={32} className="mb-4" />
              <h3 className="text-4xl font-bold">15</h3>
              <p className="text-purple-100 text-sm">propriedades</p>
            </div>
          </div>
        </div>
      )}

      {currentView === 'clients' && (
        <div className="p-6 max-w-7xl mx-auto">
          <div className="flex items-center justify-between mb-6">
            <h2 className="text-3xl font-bold text-emerald-900">Carteira de Clientes</h2>
            <button onClick={() => {
              // Limpar progresso anterior ao abrir para novo cliente
              localStorage.removeItem('agilmaster_wizard_progresso');
              setSelectedClient(null);
              setIsEditMode(false);
              setShowNewClientWizard(true);
            }} className="px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 text-emerald-900 rounded-lg font-bold flex items-center gap-2 shadow-lg">
              <Plus size={20} /> Novo Cliente
            </button>
          </div>

          {/* Busca por CPF */}
          <div className="mb-6">
            <input
              type="text"
              placeholder="🔍 Buscar por CPF (ex: 123.456.789-00)"
              value={searchCPF}
              className="w-full px-4 py-3 border-2 border-emerald-300 rounded-lg text-lg"
              onChange={(e) => setSearchCPF(maskCPFBusca(e.target.value))}
              maxLength="14"
            />
          </div>

          {/* Lista de Clientes */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {clients
              .filter(client => {
                if (!searchCPF) return true;
                const cpfCliente = (client.cpf || '').replace(/\D/g, '');
                const cpfBusca = searchCPF.replace(/\D/g, '');
                return cpfCliente.includes(cpfBusca);
              })
              .map(client => (
              <div 
                key={client.id} 
                onClick={() => {
                  setSelectedClient(client);
                  setIsEditMode(true);
                  setShowNewClientWizard(true);
                }}
                className="bg-white rounded-xl shadow-sm border border-emerald-200 p-5 hover:shadow-lg transition-all cursor-pointer"
              >
                <div className="mb-3">
                  <h3 className="font-bold text-lg text-emerald-900">{client.nomeCompleto || client.name}</h3>
                  <p className="text-sm text-gray-600">CPF: {client.cpf}</p>
                  {client.telefone && <p className="text-sm text-gray-600">Tel: {client.telefone}</p>}
                </div>
                <div className="pt-3 border-t border-gray-100">
                  <p className="text-xs text-gray-500">Propriedades: {client.totalPropriedades || client.properties?.length || 0}</p>
                  <p className="text-xs text-gray-500">Hectares: {client.totalHectares?.toFixed(2) || client.hectares || 0} ha</p>
                </div>
              </div>
            ))}
          </div>

          {clients.length === 0 && (
            <div className="text-center py-12">
              <p className="text-gray-500 text-lg">Nenhum cliente cadastrado ainda.</p>
              <p className="text-gray-400 text-sm mt-2">Clique em "Novo Cliente" para começar.</p>
            </div>
          )}
        </div>
      )}

      {currentView === 'gerenciar' && (
        <div className="p-6 max-w-7xl mx-auto">
          <h2 className="text-3xl font-bold text-emerald-900 mb-6">⚙️ Gerenciar Clientes</h2>
          
          <div className="bg-white rounded-xl shadow-lg border-2 border-emerald-200 overflow-hidden">
            <div className="bg-emerald-700 text-white p-4">
              <h3 className="text-xl font-bold">Lista Completa de Clientes Cadastrados</h3>
              <p className="text-emerald-100 text-sm">Total: {clients.length} cliente{clients.length !== 1 ? 's' : ''}</p>
            </div>
            
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-emerald-100">
                  <tr>
                    <th className="px-4 py-3 text-left text-emerald-900 font-bold">Nome</th>
                    <th className="px-4 py-3 text-left text-emerald-900 font-bold">CPF</th>
                    <th className="px-4 py-3 text-left text-emerald-900 font-bold">Telefone</th>
                    <th className="px-4 py-3 text-left text-emerald-900 font-bold">Propriedades</th>
                    <th className="px-4 py-3 text-left text-emerald-900 font-bold">Data Cadastro</th>
                    <th className="px-4 py-3 text-center text-emerald-900 font-bold">Ações</th>
                  </tr>
                </thead>
                <tbody>
                  {clients.map((client, index) => (
                    <tr key={client.id} className={`border-b border-emerald-100 ${index % 2 === 0 ? 'bg-white' : 'bg-emerald-50'} hover:bg-yellow-50 transition-colors`}>
                      <td className="px-4 py-3 font-semibold text-emerald-900">{client.nomeCompleto || client.name}</td>
                      <td className="px-4 py-3 text-gray-700 font-mono">{client.cpf}</td>
                      <td className="px-4 py-3 text-gray-600">{client.telefone || client.phone || '-'}</td>
                      <td className="px-4 py-3 text-gray-600">{client.totalPropriedades || client.properties?.length || 0}</td>
                      <td className="px-4 py-3 text-gray-600 text-sm">
                        {client.dataCadastro ? new Date(client.dataCadastro).toLocaleDateString('pt-BR') : '-'}
                      </td>
                      <td className="px-4 py-3 text-center">
                        <button 
                          onClick={() => {
                            if (confirm(`⚠️ CONFIRMAR EXCLUSÃO\n\nDeseja realmente excluir o cliente:\n${client.nomeCompleto || client.name}\nCPF: ${client.cpf}\n\nEsta ação NÃO pode ser desfeita!`)) {
                              const clientesAtualizados = clients.filter(c => c.id !== client.id);
                              localStorage.setItem('agilmaster_clientes', JSON.stringify(clientesAtualizados));
                              setClients(clientesAtualizados);
                              alert('✅ Cliente removido com sucesso!');
                            }
                          }}
                          className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-bold flex items-center gap-2 mx-auto"
                        >
                          <Trash2 size={16} /> Remover
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>

            {clients.length === 0 && (
              <div className="text-center py-12">
                <p className="text-gray-500 text-lg">Nenhum cliente cadastrado.</p>
              </div>
            )}
          </div>

          {/* Botão para limpar TODOS os dados */}
          <div className="mt-6 bg-red-50 border-2 border-red-300 rounded-xl p-6">
            <h3 className="text-xl font-bold text-red-900 mb-3">🗑️ Zona de Perigo</h3>
            <p className="text-red-700 mb-4">Atenção: Esta ação remove TODOS os clientes do sistema!</p>
            <button 
              onClick={() => {
                if (confirm('⚠️ ATENÇÃO!\n\nVocê está prestes a REMOVER TODOS OS CLIENTES!\n\nEsta ação NÃO pode ser desfeita!\n\nDeseja continuar?')) {
                  if (confirm('🚨 ÚLTIMA CONFIRMAÇÃO!\n\nTEM CERTEZA ABSOLUTA?\n\nTODOS os ' + clients.length + ' clientes serão PERMANENTEMENTE removidos!')) {
                    localStorage.removeItem('agilmaster_clientes');
                    setClients([]);
                    alert('✅ Todos os clientes foram removidos!');
                  }
                }
              }}
              className="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-bold flex items-center gap-2"
            >
              <Trash2 size={20} /> Remover TODOS os Clientes
            </button>
          </div>
        </div>
      )}

      {showNewClientWizard && (
        <WizardPC 
          onClose={() => {
            setShowNewClientWizard(false);
            setSelectedClient(null);
            setIsEditMode(false);
          }}
          selectedClient={selectedClient}
          isEditMode={isEditMode}
        />
      )}
    </div>
  );
}

function WizardPC({ onClose, selectedClient, isEditMode }) {
  const [activeMenu, setActiveMenu] = useState('cliente');
  
  // Funções de máscara
  const maskData = (value) => {
    value = value.replace(/\D/g, '');
    if (value.length <= 2) return value;
    if (value.length <= 4) return value.slice(0,2) + '/' + value.slice(2);
    return value.slice(0,2) + '/' + value.slice(2,4) + '/' + value.slice(4,8);
  };
  
  const maskCPF = (value) => {
    value = value.replace(/\D/g, '');
    if (value.length <= 3) return value;
    if (value.length <= 6) return value.slice(0,3) + '.' + value.slice(3);
    if (value.length <= 9) return value.slice(0,3) + '.' + value.slice(3,6) + '.' + value.slice(6);
    return value.slice(0,3) + '.' + value.slice(3,6) + '.' + value.slice(6,9) + '-' + value.slice(9,11);
  };
  
  const maskTelefone = (value) => {
    value = value.replace(/\D/g, '');
    if (value.length <= 2) return value;
    if (value.length <= 7) return value.slice(0,2) + '-' + value.slice(2);
    return value.slice(0,2) + '-' + value.slice(2,7) + '-' + value.slice(7,11);
  };

  const maskHectares = (value) => {
    value = value.replace(/\D/g, '');
    if (value.length === 0) return '';
    if (value.length <= 2) {
      return '0,' + value.padStart(2, '0');
    }
    const inteiros = value.slice(0, -2);
    const decimais = value.slice(-2);
    return inteiros + ',' + decimais;
  };

  const maskValor = (value) => {
    // Remove tudo que não é dígito
    value = value.replace(/\D/g, '');
    
    if (value.length === 0) return '';
    
    // Converte para número e divide por 100 (para ter os centavos)
    const numero = parseInt(value) / 100;
    
    // Formata com pontos de milhar e vírgula decimal
    return numero.toLocaleString('pt-BR', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });
  };

  const maskAno = (value) => {
    // Remove tudo que não é dígito e limita a 4 caracteres
    return value.replace(/\D/g, '').slice(0, 4);
  };

  const maskAreaM2 = (value) => {
    // Remove tudo que não é dígito
    value = value.replace(/\D/g, '');
    
    if (value.length === 0) return '';
    
    // Converte para número e divide por 100 (para ter os centavos)
    const numero = parseInt(value) / 100;
    
    // Formata com vírgula decimal
    return numero.toLocaleString('pt-BR', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });
  };

  const maskUF = (value) => {
    // Remove números e caracteres especiais, mantém só letras
    // Converte para maiúsculas e limita a 2 caracteres
    return value.replace(/[^A-Za-z]/g, '').toUpperCase().slice(0, 2);
  };

  const maskPercentual = (value) => {
    // Remove tudo que não é dígito
    value = value.replace(/\D/g, '');
    
    if (value.length === 0) return '';
    
    // Converte para número e divide por 100 (para ter os decimais)
    const numero = parseInt(value) / 100;
    
    // Formata com vírgula decimal
    return numero.toLocaleString('pt-BR', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });
  };

  // Função para verificar CPF duplicado em tempo real
  const handleCpfChange = (value) => {
    const cpfFormatado = maskCPF(value);
    const cpfLimpo = cpfFormatado.replace(/\D/g, '');
    
    setClienteData({...clienteData, cpf: cpfFormatado});
    
    // Se CPF tem 11 dígitos, verifica duplicata
    if (cpfLimpo.length === 11 && !isEditMode) {
      const clientesExistentes = JSON.parse(localStorage.getItem('agilmaster_clientes') || '[]');
      const clienteExistente = clientesExistentes.find(c => c.cpf.replace(/\D/g, '') === cpfLimpo);
      
      if (clienteExistente) {
        setCpfDuplicadoAlert({
          nome: clienteExistente.nomeCompleto,
          cpf: clienteExistente.cpf
        });
      } else {
        setCpfDuplicadoAlert(null);
      }
    } else {
      setCpfDuplicadoAlert(null);
    }
  };
  
  const [clienteData, setClienteData] = useState(
    isEditMode && selectedClient ? {
      nomeCompleto: selectedClient.nomeCompleto || '',
      dataNascimento: selectedClient.dataNascimento || '',
      cpf: selectedClient.cpf || '',
      cnpj: selectedClient.cnpj || '',
      telefone: selectedClient.telefone || '',
      email: selectedClient.email || '',
      enderecoCompleto: selectedClient.enderecoCompleto || '',
      casado: selectedClient.casado || false,
      nomeConjuge: selectedClient.nomeConjuge || '',
      cpfConjuge: selectedClient.cpfConjuge || '',
      nomeEmpresa: selectedClient.nomeEmpresa || '',
      tipoAtendimento: selectedClient.tipoAtendimento || 'Padrão'
    } : {
      nomeCompleto: '', dataNascimento: '', cpf: '', cnpj: '', telefone: '', email: '', 
      enderecoCompleto: '', casado: false, nomeConjuge: '', cpfConjuge: '', 
      nomeEmpresa: '', tipoAtendimento: 'Padrão'
    }
  );

  const [grupoData, setGrupoData] = useState(
    isEditMode && selectedClient?.grupoData ? selectedClient.grupoData : { atuaSozinho: true, membros: [] }
  );
  const [cpfDuplicadoAlert, setCpfDuplicadoAlert] = useState(null);
  const [propriedadesData, setPropriedadesData] = useState(
    isEditMode && selectedClient?.propriedades ? selectedClient.propriedades : []
  );
  const [maquinasData, setMaquinasData] = useState(
    isEditMode && selectedClient?.maquinas ? selectedClient.maquinas : []
  );
  const [veiculosData, setVeiculosData] = useState(
    isEditMode && selectedClient?.veiculos ? selectedClient.veiculos : []
  );
  const [imoveisData, setImoveisData] = useState(
    isEditMode && selectedClient?.imoveis ? selectedClient.imoveis : []
  );
  const [producaoData, setProducaoData] = useState(
    isEditMode && selectedClient?.producao ? selectedClient.producao : []
  );
  
  // Estado para preço da arroba
  const [precoArroba, setPrecoArroba] = useState('310,00');
  
  // useEffect para recarregar dados quando selectedClient mudar
  useEffect(() => {
    console.log('🔄 useEffect - selectedClient mudou:', selectedClient);
    console.log('🔄 isEditMode:', isEditMode);
    
    if (isEditMode && selectedClient) {
      console.log('✅ Carregando dados do cliente:', selectedClient.nomeCompleto);
      console.log('📊 Propriedades do cliente:', selectedClient.propriedades);
      console.log('📊 Máquinas do cliente:', selectedClient.maquinas);
      console.log('📊 Veículos do cliente:', selectedClient.veiculos);
      
      setClienteData({
        nomeCompleto: selectedClient.nomeCompleto || '',
        dataNascimento: selectedClient.dataNascimento || '',
        cpf: selectedClient.cpf || '',
        cnpj: selectedClient.cnpj || '',
        telefone: selectedClient.telefone || '',
        email: selectedClient.email || '',
        enderecoCompleto: selectedClient.enderecoCompleto || '',
        casado: selectedClient.casado || false,
        nomeConjuge: selectedClient.nomeConjuge || '',
        cpfConjuge: selectedClient.cpfConjuge || '',
        nomeEmpresa: selectedClient.nomeEmpresa || '',
        tipoAtendimento: selectedClient.tipoAtendimento || 'Padrão'
      });
      
      setGrupoData(selectedClient.grupo || { atuaSozinho: true, membros: [] });
      setPropriedadesData(selectedClient.propriedades || []);
      setMaquinasData(selectedClient.maquinas || []);
      setVeiculosData(selectedClient.veiculos || []);
      setImoveisData(selectedClient.imoveis || []);
      setCulturasData(selectedClient.culturas || []);
      setFruticultura(selectedClient.fruticultura || []);
      setProducaoData(selectedClient.producao || []);
      
      console.log('✅ Dados carregados no state!');
    }
  }, [selectedClient, isEditMode]);
  
  // Sistema de keys para reset de inputs file
  const [fileInputKeys, setFileInputKeys] = useState({
    matricula: Date.now(),
    car: Date.now() + 1,
    ccir: Date.now() + 2,
    itr: Date.now() + 3,
    onus: Date.now() + 4,
    fichaSanitaria: Date.now() + 5
  });
  
  const [currentPropriedade, setCurrentPropriedade] = useState({
    numeroMatricula: '', nomePropriedade: '', hectares: '', cidade: '', uf: 'PA', cartorio: '', dataEmissao: '', matriculaFile: null,
    registroCAR: '', nomeImovelRuralCAR: '', municipioCAR: '', areaTotalCAR: '', nomeProprietarioCAR: '', cpfProprietarioCAR: '', 
    areaConsolidada: '', areaReservaLegal: '', numeroMatriculaCAR: '', carFile: null,
    exercicioCCIR: '', codigoImovelCCIR: '', denominacaoImovelCCIR: '', areaTotalCCIR: '', municipioCCIR: '', 
    ufCCIR: 'PA', cpfCnpjTitularCCIR: '', nomeTitularCCIR: '', ccirFile: null,
    temOnus: false, onusAtivos: '', onusFile: null,
    cibITR: '', nomeImovelITR: '', municipioITR: '', ufITR: 'PA', areaTotalITR: '', contribuinteITR: '', cpfContribuinteITR: '', 
    validadeITR: '', itrFile: null,
    quantidadeAnimais: '', fichaSanitariaFile: null
  });

  const [isProcessingPDF, setIsProcessingPDF] = useState(false);
  const [pdfProcessingStatus, setPdfProcessingStatus] = useState('');
  const [currentProcessingDoc, setCurrentProcessingDoc] = useState('');

  // ========== SISTEMA DE OCR INTELIGENTE E TREINÁVEL ==========
  const [ocrPatterns, setOcrPatterns] = useState(() => {
    const saved = localStorage.getItem('agilmaster_ocr_patterns');
    return saved ? JSON.parse(saved) : {
      matricula: [],
      car: [],
      ccir: [],
      itr: [],
      fichaSanitaria: []
    };
  });

  const [showConfirmDialog, setShowConfirmDialog] = useState(false);
  const [pendingExtraction, setPendingExtraction] = useState(null);
  const [userCorrections, setUserCorrections] = useState({});

  // Salvar padrões aprendidos no localStorage
  const saveOcrPatterns = (newPatterns) => {
    localStorage.setItem('agilmaster_ocr_patterns', JSON.stringify(newPatterns));
    setOcrPatterns(newPatterns);
  };

  // Aplicar correções do usuário e aprender
  const applyUserCorrections = () => {
    if (!pendingExtraction) return;

    const { documentType, extractedData, originalText } = pendingExtraction;
    const corrections = userCorrections;

    // Aprender novos padrões baseados nas correções
    const newPatterns = { ...ocrPatterns };
    
    Object.keys(corrections).forEach(field => {
      const correctedValue = corrections[field];
      const originalValue = extractedData[field];
      
      if (correctedValue && correctedValue !== originalValue && originalText) {
        // Procurar o padrão no texto original
        const escapedValue = correctedValue.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        const pattern = {
          field: field,
          value: correctedValue,
          context: originalText.substring(Math.max(0, originalText.indexOf(correctedValue) - 50), originalText.indexOf(correctedValue) + correctedValue.length + 50),
          timestamp: Date.now()
        };
        
        if (!newPatterns[documentType]) newPatterns[documentType] = [];
        newPatterns[documentType].push(pattern);
      }
    });

    saveOcrPatterns(newPatterns);
    
    // Aplicar correções aos campos
    setCurrentPropriedade(prev => ({ ...prev, ...corrections }));
    
    setShowConfirmDialog(false);
    setPendingExtraction(null);
    setUserCorrections({});
    
    alert('✅ Correções aplicadas e padrões aprendidos!');
  };

  // Usar padrões aprendidos na extração
  const applyLearnedPatterns = (text, documentType, extractedData) => {
    const patterns = ocrPatterns[documentType] || [];
    const enhanced = { ...extractedData };

    patterns.forEach(pattern => {
      if (text.includes(pattern.value) || similarity(text, pattern.context) > 0.7) {
        enhanced[pattern.field] = pattern.value;
      }
    });

    return enhanced;
  };

  // Função de similaridade simples
  const similarity = (s1, s2) => {
    const longer = s1.length > s2.length ? s1 : s2;
    const shorter = s1.length > s2.length ? s2 : s1;
    if (longer.length === 0) return 1.0;
    return (longer.length - editDistance(longer, shorter)) / longer.length;
  };

  const editDistance = (s1, s2) => {
    s1 = s1.toLowerCase();
    s2 = s2.toLowerCase();
    const costs = [];
    for (let i = 0; i <= s1.length; i++) {
      let lastValue = i;
      for (let j = 0; j <= s2.length; j++) {
        if (i === 0) costs[j] = j;
        else if (j > 0) {
          let newValue = costs[j - 1];
          if (s1.charAt(i - 1) !== s2.charAt(j - 1))
            newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;
          costs[j - 1] = lastValue;
          lastValue = newValue;
        }
      }
      if (i > 0) costs[s2.length] = lastValue;
    }
    return costs[s2.length];
  };
  // ========== FIM DO SISTEMA DE OCR INTELIGENTE ==========

  const [currentMaquina, setCurrentMaquina] = useState({ tipo: '', marca: '', modelo: '', ano: '', placa: '', valorEstimado: '', quantidade: '1' });
  const [currentVeiculo, setCurrentVeiculo] = useState({ tipo: '', marca: '', modelo: '', ano: '', placa: '', renavam: '', valorEstimado: '' });
  const [currentImovel, setCurrentImovel] = useState({ tipo: '', endereco: '', cidade: '', uf: 'PA', areaM2: '', valorEstimado: '', matricula: '' });
  const [currentProducao, setCurrentProducao] = useState({ 
    bovideoMacho0a12: '', bovideoFemea0a12: '', bovideoMacho13a24: '', bovideoFemea13a24: '',
    bovideoMacho25a36: '', bovideoFemea25a36: '', bovideoMachoAcima36: '', bovideoFemeaAcima36: '',
    equideoMachoAcima6: '', equideoFemeaAcima6: '',
    ovinoMachoAte6: '', ovinoFemeaAte6: '', ovinoMachoAcima6: '', ovinoFemeaAcima6: '',
    caprinoMachoAte12: '', caprinoFemeaAte12: '', caprinoMachoAcima12: '', caprinoFemeaAcima12: '',
    avesTotal: '',
    suideoMachoLeitao: '', suideoFemeaLeitao: '', suideoFemeaMatriz: '',
    fichaSanitariaFile: null
  });

  const [currentMembro, setCurrentMembro] = useState({ nome: '', cpf: '', parentesco: '', participacao: '' });

  // Estados para culturas agrícolas
  const [culturasData, setCulturasData] = useState(() => {
    // Verifica se está editando um cliente existente
    if (isEditMode && selectedClient?.culturas) {
      return selectedClient.culturas;
    }
    // Verifica se há progresso salvo
    const progressoSalvo = localStorage.getItem('agilmaster_wizard_progresso');
    if (progressoSalvo) {
      const progresso = JSON.parse(progressoSalvo);
      return progresso.culturasData || [];
    }
    return [];
  });
  const [currentCultura, setCurrentCultura] = useState({ 
    tipo: '', 
    hectares: '', 
    precoKg: '', 
    sacasHa: '', 
    custoHa: '' 
  });
  const [soja, setSoja] = useState({ hectares: '', precoKg: '', sacasHa: '', custoHa: '' });
  const [milho, setMilho] = useState({ hectares: '', precoKg: '', sacasHa: '', custoHa: '' });
  const [currentFruticultura, setCurrentFruticultura] = useState({ 
    cultura: '', 
    hectares: '', 
    kilosHa: '', 
    vendaKg: '', 
    custoKg: '' 
  });
  const [fruticultura, setFruticultura] = useState([]);
  const [editingFrutIndex, setEditingFrutIndex] = useState(null);

  // Função para salvar o progresso de cada etapa
  const handleSalvarEtapa = (etapa) => {
    const progressoAtual = {
      clienteData,
      grupoData,
      propriedadesData,
      maquinasData,
      veiculosData,
      imoveisData,
      producaoData,
      ultimaEtapaSalva: etapa,
      dataUltimaSalvamento: new Date().toLocaleString('pt-BR')
    };
    
    localStorage.setItem('agilmaster_wizard_progresso', JSON.stringify(progressoAtual));
    alert(`✅ Progresso da etapa "${etapa}" salvo com sucesso!\n\nVocê pode fechar e retornar depois.`);
  };

  // Função para salvar rascunho completo
  const handleSalvarRascunho = () => {
    if (!clienteData.nomeCompleto) {
      alert('⚠️ Preencha pelo menos o Nome Completo para salvar o rascunho!');
      return;
    }

    const progressoAtual = {
      clienteData,
      grupoData,
      propriedadesData,
      maquinasData,
      veiculosData,
      imoveisData,
      producaoData,
      culturasData,
      isEditMode,
      selectedClientId: selectedClient?.id || null,
      ultimaEtapaSalva: activeMenu,
      dataUltimaSalvamento: new Date().toLocaleString('pt-BR')
    };
    
    localStorage.setItem('agilmaster_wizard_progresso', JSON.stringify(progressoAtual));
    
    alert(`✅ Rascunho salvo!\n\nCliente: ${clienteData.nomeCompleto}\nÚltima edição: ${activeMenu}\nData: ${progressoAtual.dataUltimaSalvamento}`);
  };

  // Ordem das abas para navegação
  const menuOrder = ['cliente', 'grupo', 'propriedades', 'maquinas', 'veiculos', 'imoveis', 'producao'];
  
  const handleVoltar = () => {
    const currentIndex = menuOrder.indexOf(activeMenu);
    if (currentIndex > 0) {
      setActiveMenu(menuOrder[currentIndex - 1]);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  const handleAvancar = () => {
    // Salvar rascunho antes de avançar
    const progressoAtual = {
      clienteData,
      grupoData,
      propriedadesData,
      maquinasData,
      veiculosData,
      imoveisData,
      producaoData,
      culturasData,
      isEditMode,
      selectedClientId: selectedClient?.id || null,
      ultimaEtapaSalva: activeMenu,
      dataUltimaSalvamento: new Date().toLocaleString('pt-BR')
    };
    localStorage.setItem('agilmaster_wizard_progresso', JSON.stringify(progressoAtual));
    
    // Avançar para próxima aba
    const currentIndex = menuOrder.indexOf(activeMenu);
    if (currentIndex < menuOrder.length - 1) {
      setActiveMenu(menuOrder[currentIndex + 1]);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  const handleAddMembro = () => {
    if (currentMembro.nome) {
      setGrupoData({
        ...grupoData,
        membros: [...grupoData.membros, { ...currentMembro, id: Date.now() }]
      });
      setCurrentMembro({ nome: '', cpf: '', parentesco: '', participacao: '' });
    }
  };

  const handleAddPropriedade = () => {
    console.log('🏡 ADICIONANDO PROPRIEDADE');
    console.log('Nome da propriedade:', currentPropriedade.nomePropriedade);
    console.log('Dados completos:', currentPropriedade);
    console.log('Array atual de propriedades:', propriedadesData);
    
    if (currentPropriedade.nomePropriedade) {
      const novaPropriedade = { ...currentPropriedade, id: Date.now() };
      console.log('✅ Nova propriedade:', novaPropriedade);
      
      setPropriedadesData([...propriedadesData, novaPropriedade]);
      console.log('✅ Propriedade adicionada! Total agora:', propriedadesData.length + 1);
      
      alert(`✅ Propriedade "${currentPropriedade.nomePropriedade}" adicionada!\n\nTotal de propriedades: ${propriedadesData.length + 1}`);
      
      setCurrentPropriedade({
        numeroMatricula: '', nomePropriedade: '', hectares: '', cidade: '', uf: 'PA', cartorio: '', dataEmissao: '', matriculaFile: null,
        registroCAR: '', nomeImovelRuralCAR: '', municipioCAR: '', areaTotalCAR: '', nomeProprietarioCAR: '', cpfProprietarioCAR: '', 
        areaConsolidada: '', areaReservaLegal: '', numeroMatriculaCAR: '', carFile: null,
        exercicioCCIR: '', codigoImovelCCIR: '', denominacaoImovelCCIR: '', areaTotalCCIR: '', municipioCCIR: '', 
        ufCCIR: 'PA', cpfCnpjTitularCCIR: '', nomeTitularCCIR: '', ccirFile: null,
        temOnus: false, onusAtivos: '', onusFile: null,
        cibITR: '', nomeImovelITR: '', municipioITR: '', ufITR: 'PA', areaTotalITR: '', contribuinteITR: '', cpfContribuinteITR: '', 
        validadeITR: '', itrFile: null,
        quantidadeAnimais: '', fichaSanitariaFile: null
      });
    } else {
      console.log('❌ Nome da propriedade vazio!');
      alert('⚠️ Preencha o nome da propriedade!');
    }
  };

  const handleEditPropriedade = (index) => {
    const prop = propriedadesData[index];
    setCurrentPropriedade(prop);
    setPropriedadesData(propriedadesData.filter((_, idx) => idx !== index));
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleAddMaquina = () => {
    console.log('🚜 ADICIONANDO MÁQUINA');
    console.log('Tipo:', currentMaquina.tipo);
    console.log('Dados completos:', currentMaquina);
    console.log('Array atual de máquinas:', maquinasData);
    
    if (currentMaquina.tipo) {
      const novaMaquina = { ...currentMaquina, id: Date.now(), quantidade: currentMaquina.quantidade || '1' };
      console.log('✅ Nova máquina:', novaMaquina);
      
      setMaquinasData([...maquinasData, novaMaquina]);
      console.log('✅ Máquina adicionada! Total agora:', maquinasData.length + 1);
      
      alert(`✅ Máquina "${currentMaquina.tipo} ${currentMaquina.marca}" adicionada!\n\nTotal de máquinas: ${maquinasData.length + 1}`);
      
      setCurrentMaquina({ tipo: '', marca: '', modelo: '', ano: '', placa: '', valorEstimado: '', quantidade: '1' });
    } else {
      console.log('❌ Tipo de máquina vazio!');
      alert('⚠️ Selecione o tipo de máquina!');
    }
  };

  const handleEditMaquina = (index) => {
    const maq = maquinasData[index];
    setCurrentMaquina(maq);
    setMaquinasData(maquinasData.filter((_, idx) => idx !== index));
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleAddVeiculo = () => {
    console.log('🚗 ADICIONANDO VEÍCULO');
    console.log('Tipo:', currentVeiculo.tipo);
    console.log('Dados completos:', currentVeiculo);
    console.log('Array atual de veículos:', veiculosData);
    
    if (currentVeiculo.tipo) {
      const novoVeiculo = { ...currentVeiculo, id: Date.now() };
      console.log('✅ Novo veículo:', novoVeiculo);
      
      setVeiculosData([...veiculosData, novoVeiculo]);
      console.log('✅ Veículo adicionado! Total agora:', veiculosData.length + 1);
      
      alert(`✅ Veículo "${currentVeiculo.tipo} ${currentVeiculo.marca}" adicionado!\n\nTotal de veículos: ${veiculosData.length + 1}`);
      
      setCurrentVeiculo({ tipo: '', marca: '', modelo: '', ano: '', placa: '', renavam: '', valorEstimado: '' });
    } else {
      console.log('❌ Tipo de veículo vazio!');
      alert('⚠️ Selecione o tipo de veículo!');
    }
  };

  const handleEditVeiculo = (index) => {
    const veic = veiculosData[index];
    setCurrentVeiculo(veic);
    setVeiculosData(veiculosData.filter((_, idx) => idx !== index));
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleAddImovel = () => {
    if (currentImovel.tipo) {
      setImoveisData([...imoveisData, { ...currentImovel, id: Date.now() }]);
      setCurrentImovel({ tipo: '', endereco: '', cidade: '', uf: 'PA', areaM2: '', valorEstimado: '', matricula: '' });
    }
  };

  const handleEditImovel = (index) => {
    const im = imoveisData[index];
    setCurrentImovel(im);
    setImoveisData(imoveisData.filter((_, idx) => idx !== index));
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  // Função para calcular valorização do rebanho
  const calcularValorRebanho = (ficha, precoArrobaAtual) => {
    const preco = parseFloat(precoArrobaAtual.replace(',', '.'));
    
    // Animais de 0-12 meses = 14@
    const qtd0a12 = (parseInt(ficha.bovideoMacho0a12 || 0) + parseInt(ficha.bovideoFemea0a12 || 0));
    const arrobas0a12 = qtd0a12 * 14;
    const valor0a12 = arrobas0a12 * preco;
    
    // Animais de 13-24 meses = 20@
    const qtd13a24 = (parseInt(ficha.bovideoMacho13a24 || 0) + parseInt(ficha.bovideoFemea13a24 || 0));
    const arrobas13a24 = qtd13a24 * 20;
    const valor13a24 = arrobas13a24 * preco;
    
    // Animais de 25-36 meses = 35@
    const qtd25a36 = (parseInt(ficha.bovideoMacho25a36 || 0) + parseInt(ficha.bovideoFemea25a36 || 0));
    const arrobas25a36 = qtd25a36 * 35;
    const valor25a36 = arrobas25a36 * preco;
    
    // Animais acima de 36 meses = 35@ (mantém o mesmo peso)
    const qtdAcima36 = (parseInt(ficha.bovideoMachoAcima36 || 0) + parseInt(ficha.bovideoFemeaAcima36 || 0));
    const arrobasAcima36 = qtdAcima36 * 35;
    const valorAcima36 = arrobasAcima36 * preco;
    
    const totalArrobas = arrobas0a12 + arrobas13a24 + arrobas25a36 + arrobasAcima36;
    const totalValor = valor0a12 + valor13a24 + valor25a36 + valorAcima36;
    const totalAnimais = qtd0a12 + qtd13a24 + qtd25a36 + qtdAcima36;
    
    return {
      qtd0a12,
      arrobas0a12,
      valor0a12: valor0a12.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      qtd13a24,
      arrobas13a24,
      valor13a24: valor13a24.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      qtd25a36,
      arrobas25a36,
      valor25a36: valor25a36.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      qtdAcima36,
      arrobasAcima36,
      valorAcima36: valorAcima36.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      totalAnimais,
      totalArrobas,
      totalValor: totalValor.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      totalValorNumerico: totalValor
    };
  };

  const handleAddProducao = () => {
    const totalAnimais = (
      parseInt(currentProducao.bovideoMacho0a12 || 0) +
      parseInt(currentProducao.bovideoFemea0a12 || 0) +
      parseInt(currentProducao.bovideoMacho13a24 || 0) +
      parseInt(currentProducao.bovideoFemea13a24 || 0) +
      parseInt(currentProducao.bovideoMacho25a36 || 0) +
      parseInt(currentProducao.bovideoFemea25a36 || 0) +
      parseInt(currentProducao.bovideoMachoAcima36 || 0) +
      parseInt(currentProducao.bovideoFemeaAcima36 || 0)
    );
    
    if (totalAnimais > 0) {
      const valorCalc = calcularValorRebanho(currentProducao, precoArroba);
      setProducaoData([...producaoData, { ...currentProducao, id: Date.now(), precoArroba: precoArroba, valorRebanho: valorCalc.totalValorNumerico }]);
      setCurrentProducao({ 
        bovideoMacho0a12: '', bovideoFemea0a12: '', bovideoMacho13a24: '', bovideoFemea13a24: '',
        bovideoMacho25a36: '', bovideoFemea25a36: '', bovideoMachoAcima36: '', bovideoFemeaAcima36: '',
        equideoMachoAcima6: '', equideoFemeaAcima6: '',
        ovinoMachoAte6: '', ovinoFemeaAte6: '', ovinoMachoAcima6: '', ovinoFemeaAcima6: '',
        caprinoMachoAte12: '', caprinoFemeaAte12: '', caprinoMachoAcima12: '', caprinoFemeaAcima12: '',
        avesTotal: '',
        suideoMachoLeitao: '', suideoFemeaLeitao: '', suideoFemeaMatriz: '',
        fichaSanitariaFile: null
      });
      // Limpar input file
      const fileInput = document.getElementById('fichaSanitariaUpload');
      if (fileInput) fileInput.value = '';
      
      alert('✅ Ficha Sanitária adicionada com sucesso!');
    } else {
      alert('⚠️ Preencha pelo menos uma quantidade de animais antes de adicionar a ficha!');
    }
  };

  // Funções para gerenciar culturas
  const maskHectaresCultura = (value) => {
    // Remove tudo que não é número
    const numbers = value.replace(/\D/g, '');
    if (numbers === '') return '';
    // Converte para número e formata
    const num = parseFloat(numbers);
    return num.toFixed(2).replace('.', ',');
  };

  const maskPreco = (value) => {
    // Permite apenas números e vírgula
    value = value.replace(/[^\d,]/g, '');
    
    // Se vazio, retorna vazio
    if (value === '') return '';
    
    // Se tem vírgula, garante apenas uma e no máximo 2 decimais
    if (value.includes(',')) {
      const parts = value.split(',');
      // Garante apenas uma vírgula
      if (parts.length > 2) {
        value = parts[0] + ',' + parts.slice(1).join('');
      }
      // Limita a 2 casas decimais
      if (parts[1] && parts[1].length > 2) {
        value = parts[0] + ',' + parts[1].slice(0, 2);
      }
    }
    
    return value;
  };

  const maskSacas = (value) => {
    // Permite apenas números e vírgula
    value = value.replace(/[^\d,]/g, '');
    
    // Se vazio, retorna vazio
    if (value === '') return '';
    
    // Se tem vírgula, garante apenas uma e no máximo 2 decimais
    if (value.includes(',')) {
      const parts = value.split(',');
      // Garante apenas uma vírgula
      if (parts.length > 2) {
        value = parts[0] + ',' + parts.slice(1).join('');
      }
      // Limita a 2 casas decimais
      if (parts[1] && parts[1].length > 2) {
        value = parts[0] + ',' + parts[1].slice(0, 2);
      }
    }
    
    return value;
  };

  const maskCusto = (value) => {
    // Permite apenas números, vírgula e ponto
    value = value.replace(/[^\d,]/g, '');
    
    // Se vazio, retorna vazio
    if (value === '') return '';
    
    // Se tem vírgula, garante apenas uma e no máximo 2 decimais
    if (value.includes(',')) {
      const parts = value.split(',');
      // Garante apenas uma vírgula
      if (parts.length > 2) {
        value = parts[0] + ',' + parts.slice(1).join('');
      }
      // Limita a 2 casas decimais
      if (parts[1] && parts[1].length > 2) {
        value = parts[0] + ',' + parts[1].slice(0, 2);
      }
      
      // Adiciona separador de milhares na parte inteira
      const partes = value.split(',');
      partes[0] = partes[0].replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      value = partes.join(',');
    } else {
      // Se não tem vírgula, apenas adiciona separador de milhares
      value = value.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
    }
    
    return value;
  };

  const calcularProducao = (hectares, sacasHa, precoKg, custoHa) => {
    const ha = parseFloat(hectares.replace(',', '.')) || 0;
    const sacas = parseFloat(sacasHa.replace(',', '.')) || 0;
    const preco = parseFloat(precoKg.replace(',', '.')) || 0;
    const custo = parseFloat(custoHa.replace(/\./g, '').replace(',', '.')) || 0;

    const producaoKg = ha * sacas * 60; // cada saca = 60kg
    const producaoTon = producaoKg / 1000;
    const receitaBruta = producaoKg * preco;
    const custoTotal = ha * custo;
    const lucroLiquido = receitaBruta - custoTotal;
    const margem = receitaBruta > 0 ? (lucroLiquido / receitaBruta * 100) : 0;

    return {
      producaoKg: producaoKg.toLocaleString('pt-BR'),
      producaoTon: producaoTon.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      receitaBruta: receitaBruta.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      custoTotal: custoTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      lucroLiquido: lucroLiquido.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }),
      margem: margem.toFixed(2).replace('.', ','),
      lucroPositivo: lucroLiquido >= 0
    };
  };

  const handleAddSoja = () => {
    console.log('🌱 ADICIONANDO SOJA');
    console.log('📊 Dados da soja:', soja);
    console.log('📊 culturasData atual:', culturasData);
    
    if (!soja.hectares || soja.hectares === '0,00') {
      alert('⚠️ Digite os hectares de Soja!');
      return;
    }
    if (!soja.precoKg || !soja.sacasHa || !soja.custoHa) {
      alert('⚠️ Preencha todos os campos de Soja!');
      return;
    }

    const resultado = calcularProducao(soja.hectares, soja.sacasHa, soja.precoKg, soja.custoHa);
    const sojaCompleta = { 
      ...soja, 
      tipo: 'SOJA', 
      id: Date.now(),
      ...resultado
    };
    
    console.log('✅ Soja completa preparada:', sojaCompleta);

    const sojaExistente = culturasData.find(c => c.tipo === 'SOJA');
    if (sojaExistente) {
      const novasCulturas = culturasData.map(c => c.tipo === 'SOJA' ? sojaCompleta : c);
      setCulturasData(novasCulturas);
      console.log('♻️ Soja ATUALIZADA. culturasData agora:', novasCulturas);
      alert('✅ Soja atualizada!');
    } else {
      const novasCulturas = [...culturasData, sojaCompleta];
      setCulturasData(novasCulturas);
      console.log('➕ Soja ADICIONADA. culturasData agora:', novasCulturas);
      alert('✅ Soja adicionada com sucesso!');
    }
    setSoja({ hectares: '', precoKg: '', sacasHa: '', custoHa: '' });
  };

  const handleAddMilho = () => {
    console.log('🌽 ADICIONANDO MILHO');
    console.log('📊 Dados do milho:', milho);
    console.log('📊 culturasData atual:', culturasData);
    
    if (!milho.hectares || milho.hectares === '0,00') {
      alert('⚠️ Digite os hectares de Milho!');
      return;
    }
    if (!milho.precoKg || !milho.sacasHa || !milho.custoHa) {
      alert('⚠️ Preencha todos os campos de Milho!');
      return;
    }

    const resultado = calcularProducao(milho.hectares, milho.sacasHa, milho.precoKg, milho.custoHa);
    const milhoCompleto = { 
      ...milho, 
      tipo: 'MILHO', 
      id: Date.now(),
      ...resultado
    };
    
    console.log('✅ Milho completo preparado:', milhoCompleto);

    const milhoExistente = culturasData.find(c => c.tipo === 'MILHO');
    if (milhoExistente) {
      const novasCulturas = culturasData.map(c => c.tipo === 'MILHO' ? milhoCompleto : c);
      setCulturasData(novasCulturas);
      console.log('♻️ Milho ATUALIZADO. culturasData agora:', novasCulturas);
      alert('✅ Milho atualizado!');
    } else {
      const novasCulturas = [...culturasData, milhoCompleto];
      setCulturasData(novasCulturas);
      console.log('➕ Milho ADICIONADO. culturasData agora:', novasCulturas);
      alert('✅ Milho adicionado com sucesso!');
    }
    setMilho({ hectares: '', precoKg: '', sacasHa: '', custoHa: '' });
  };

  const handleAddFruticultura = () => {
    console.log('🍌 ADICIONANDO FRUTICULTURA');
    console.log('📊 Dados da fruticultura:', currentFruticultura);
    
    if (!currentFruticultura.cultura || !currentFruticultura.hectares || 
        !currentFruticultura.kilosHa || !currentFruticultura.vendaKg || 
        !currentFruticultura.custoKg) {
      alert('⚠️ Preencha todos os campos para adicionar a cultura!');
      return;
    }

    const unmask = (valor) => {
      if (!valor) return 0;
      return parseFloat(valor.replace(',', '.'));
    };

    const ha = unmask(currentFruticultura.hectares);
    const kilosHa = unmask(currentFruticultura.kilosHa);
    const vendaKg = unmask(currentFruticultura.vendaKg);
    const custoKg = unmask(currentFruticultura.custoKg);
    
    const receitaBruta = ha * kilosHa * vendaKg;
    const custoTotal = ha * kilosHa * custoKg;
    const lucroLiquido = receitaBruta - custoTotal;

    const frutCompleta = {
      ...currentFruticultura,
      id: Date.now(),
      receitaBruta: receitaBruta.toFixed(2),
      custoTotal: custoTotal.toFixed(2),
      lucroLiquido: lucroLiquido.toFixed(2)
    };

    if (editingFrutIndex !== null) {
      const updated = [...fruticultura];
      updated[editingFrutIndex] = frutCompleta;
      setFruticultura(updated);
      setEditingFrutIndex(null);
      alert('✅ Cultura atualizada!');
    } else {
      setFruticultura([...fruticultura, frutCompleta]);
      alert('✅ Cultura adicionada com sucesso!');
    }

    setCurrentFruticultura({ 
      cultura: '', 
      hectares: '', 
      kilosHa: '', 
      vendaKg: '', 
      custoKg: '' 
    });
  };

  const handleRemoveFruticultura = (id) => {
    if (confirm('Deseja realmente remover esta cultura?')) {
      setFruticultura(fruticultura.filter(c => c.id !== id));
    }
  };

  const handleAddOutraCultura = () => {
    console.log('🌾 ADICIONANDO OUTRA CULTURA');
    console.log('📊 Dados da cultura:', currentCultura);
    console.log('📊 culturasData atual:', culturasData);
    
    if (!currentCultura.tipo || !currentCultura.hectares || currentCultura.hectares === '0,00') {
      alert('⚠️ Preencha o nome da cultura e os hectares!');
      return;
    }
    if (!currentCultura.precoKg || !currentCultura.sacasHa || !currentCultura.custoHa) {
      alert('⚠️ Preencha todos os campos da cultura!');
      return;
    }

    const resultado = calcularProducao(currentCultura.hectares, currentCultura.sacasHa, currentCultura.precoKg, currentCultura.custoHa);
    const culturaCompleta = { 
      ...currentCultura, 
      id: Date.now(),
      ...resultado
    };
    
    console.log('✅ Cultura completa preparada:', culturaCompleta);

    const novasCulturas = [...culturasData, culturaCompleta];
    setCulturasData(novasCulturas);
    console.log('➕ Cultura ADICIONADA. culturasData agora:', novasCulturas);
    
    setCurrentCultura({ tipo: '', hectares: '', precoKg: '', sacasHa: '', custoHa: '' });
    alert('✅ Cultura adicionada com sucesso!');
  };

  const handleRemoveCultura = (id) => {
    if (confirm('Deseja realmente remover esta cultura?')) {
      setCulturasData(culturasData.filter(c => c.id !== id));
    }
  };

  const handleFinalizar = () => {
    console.log('========================================');
    console.log('🚀 INICIANDO FINALIZAR');
    console.log('========================================');
    console.log('🔍 isEditMode:', isEditMode);
    console.log('🔍 selectedClient:', selectedClient);
    console.log('📝 clienteData:', clienteData);
    console.log('📝 Nome:', clienteData.nomeCompleto);
    console.log('📝 CPF:', clienteData.cpf);
    console.log('📝 Propriedades:', propriedadesData);
    console.log('📝 Total Propriedades:', propriedadesData.length);
    console.log('📝 Máquinas:', maquinasData.length);
    console.log('📝 Veículos:', veiculosData.length);
    console.log('📝 Imóveis:', imoveisData.length);
    console.log('📝 Culturas:', culturasData.length);
    console.log('📝 Culturas Array:', culturasData);
    console.log('📝 Produção:', producaoData.length);
    console.log('========================================');
    
    // Validações básicas
    if (!clienteData.nomeCompleto || !clienteData.cpf) {
      console.log('❌ ERRO: Faltam dados básicos');
      console.log('Nome vazio?', !clienteData.nomeCompleto);
      console.log('CPF vazio?', !clienteData.cpf);
      alert('❌ Preencha pelo menos o Nome Completo e CPF do cliente!');
      return;
    }

    if (propriedadesData.length === 0) {
      console.log('❌ ERRO: Sem propriedades');
      console.log('propriedadesData:', propriedadesData);
      alert('⚠️ Cadastre pelo menos uma propriedade!');
      return;
    }

    console.log('✅ Validações básicas OK');
    console.log('========================================');

    // Carregar clientes existentes
    const clientesExistentes = JSON.parse(localStorage.getItem('agilmaster_clientes') || '[]');
    console.log('📦 Clientes existentes no localStorage:', clientesExistentes.length);
    console.log('📦 Lista completa:', clientesExistentes);
    
    // Verificar duplicata por CPF (remover formatação para comparar)
    const cpfLimpo = clienteData.cpf.replace(/\D/g, '');
    console.log('🔍 CPF Limpo:', cpfLimpo);
    const clienteExistente = clientesExistentes.find(c => c.cpf.replace(/\D/g, '') === cpfLimpo);
    console.log('🔍 Cliente Existente encontrado:', clienteExistente ? 'SIM' : 'NÃO');
    console.log('🔍 Dados do cliente existente:', clienteExistente);
    
    if (clienteExistente && !isEditMode) {
      console.log('⚠️ DUPLICATA DETECTADA - não está em modo edição');
      const desejaEditar = confirm(`⚠️ CLIENTE JÁ CADASTRADO!\n\nO CPF ${clienteData.cpf} já está cadastrado para:\n${clienteExistente.nomeCompleto}\n\nDeseja editar os dados deste cliente?`);
      
      if (desejaEditar) {
        // Modo edição
        setIsEditMode(true);
        setSelectedClient(clienteExistente);
        // Carregar dados do cliente existente
        setClienteData(clienteExistente);
        setGrupoData(clienteExistente.grupo || []);
        setPropriedadesData(clienteExistente.propriedades || []);
        setMaquinasData(clienteExistente.maquinas || []);
        setVeiculosData(clienteExistente.veiculos || []);
        setImoveisData(clienteExistente.imoveis || []);
        setCulturasData(clienteExistente.culturas || []);
        setFruticultura(clienteExistente.fruticultura || []);
        setProducaoData(clienteExistente.producao || []);
        alert('✅ Dados do cliente carregados! Faça as alterações e clique em Finalizar novamente.');
      } else {
        alert('❌ Cadastro cancelado! O cliente não foi duplicado.');
      }
      return; // SEMPRE RETORNA - seja para editar ou cancelar
    }

    // Calcular total de animais
    const totalAnimais = producaoData.reduce((acc, ficha) => {
      return acc + (
        parseInt(ficha.bovideoMacho0a12 || 0) +
        parseInt(ficha.bovideoFemea0a12 || 0) +
        parseInt(ficha.bovideoMacho13a24 || 0) +
        parseInt(ficha.bovideoFemea13a24 || 0) +
        parseInt(ficha.bovideoMacho25a36 || 0) +
        parseInt(ficha.bovideoFemea25a36 || 0) +
        parseInt(ficha.bovideoMachoAcima36 || 0) +
        parseInt(ficha.bovideoFemeaAcima36 || 0)
      );
    }, 0);

    console.log('🐄 Total de animais:', totalAnimais);
    console.log('========================================');
    console.log('📦 PREPARANDO DADOS DO CLIENTE...');

    // Preparar dados completos do cliente
    const novoCliente = {
      id: (isEditMode && selectedClient) ? selectedClient.id : Date.now(),
      ...clienteData,
      grupo: grupoData,
      propriedades: propriedadesData,
      maquinas: maquinasData,
      veiculos: veiculosData,
      imoveis: imoveisData,
      culturas: culturasData,
      fruticultura: fruticultura,
      producao: producaoData,
      dataCadastro: (isEditMode && selectedClient) ? selectedClient.dataCadastro : new Date().toISOString(),
      dataAtualizacao: new Date().toISOString(),
      status: 'active',
      // Calcular totais
      totalHectares: propriedadesData.reduce((sum, p) => {
        const hectares = p.hectares ? parseFloat(p.hectares.toString().replace(',', '.')) : 0;
        return sum + hectares;
      }, 0),
      totalHectaresAgricola: culturasData.reduce((sum, c) => {
        const hectares = c.hectares ? parseFloat(c.hectares.toString().replace(',', '.')) : 0;
        return sum + hectares;
      }, 0),
      totalAnimais: totalAnimais,
      totalPropriedades: propriedadesData.length,
      totalMaquinas: maquinasData.length,
      totalVeiculos: veiculosData.length,
      totalImoveis: imoveisData.length,
      totalFichasSanitarias: producaoData.length,
      alertsCount: 0
    };

    console.log('✅ Cliente preparado:', novoCliente);
    console.log('========================================');

    let clientesAtualizados;
    
    if (isEditMode && selectedClient) {
      // Atualizar cliente existente
      console.log('📝 MODO EDIÇÃO - Atualizando cliente ID:', selectedClient.id);
      clientesAtualizados = clientesExistentes.map(c => {
        if (c.id === selectedClient.id) {
          console.log('✏️ Encontrado cliente para atualizar:', c.nomeCompleto);
          console.log('➡️ Substituindo por:', novoCliente.nomeCompleto);
          return novoCliente;
        }
        return c;
      });
      console.log('📊 Total após atualizar:', clientesAtualizados.length);
    } else {
      // Adicionar novo cliente
      console.log('➕ MODO NOVO - Adicionando cliente');
      clientesAtualizados = [...clientesExistentes, novoCliente];
      console.log('📊 Total após adicionar:', clientesAtualizados.length);
    }
    
    console.log('========================================');
    console.log('💾 SALVANDO NO LOCALSTORAGE...');
    console.log('Total de clientes a salvar:', clientesAtualizados.length);
    
    // Salvar no localStorage
    console.log('💾 SALVANDO:', clientesAtualizados.length, 'clientes');
    try {
      localStorage.setItem('agilmaster_clientes', JSON.stringify(clientesAtualizados));
      console.log('✅ SALVO COM SUCESSO NO LOCALSTORAGE!');
    } catch (error) {
      console.error('❌ ERRO AO SALVAR:', error);
      alert('❌ ERRO ao salvar: ' + error.message);
      return;
    }
    
    // Verificar se realmente salvou
    const teste = localStorage.getItem('agilmaster_clientes');
    console.log('🔍 Verificação - dados salvos:', teste ? 'SIM' : 'NÃO');
    if (teste) {
      const testeParsed = JSON.parse(teste);
      console.log('🔍 Total após salvar:', testeParsed.length);
      console.log('🔍 Clientes salvos:', testeParsed.map(c => c.nomeCompleto));
    }
    console.log('========================================');
    
    // Limpar progresso salvo após finalizar com sucesso
    localStorage.removeItem('agilmaster_wizard_progresso');
    console.log('🧹 Progresso limpo do localStorage');
    
    // Mensagem de sucesso
    const modoTexto = (isEditMode && selectedClient) ? 'atualizado' : 'cadastrado';
    alert(`✅ Cliente "${clienteData.nomeCompleto}" ${modoTexto} com sucesso!\n\n` +
          `📊 Resumo:\n` +
          `• ${propriedadesData.length} propriedade(s)\n` +
          `• ${novoCliente.totalHectares.toFixed(2)} hectares\n` +
          `• ${maquinasData.length} máquina(s)\n` +
          `• ${veiculosData.length} veículo(s)\n` +
          `• ${imoveisData.length} imóvel(is)\n` +
          `• ${culturasData.length} cultura(s)\n` +
          `• ${producaoData.length} ficha(s) sanitária(s)\n` +
          `• ${totalAnimais} animais`);
    
    console.log('🔄 RECARREGANDO PÁGINA...');
    console.log('========================================');
    // Recarregar página para atualizar lista
    window.location.reload();
  };

  const handleFileUpload = async (file, documentType) => {
    if (!file) return;
    
    // Limpar extração anterior para forçar releitura
    setPendingExtraction(null);

    setIsProcessingPDF(true);
    setCurrentProcessingDoc(documentType);
    setPdfProcessingStatus('Iniciando processamento...');

    try {
      const reader = new FileReader();
      
      reader.onload = async (e) => {
        const typedArray = new Uint8Array(e.target.result);
        
        setPdfProcessingStatus('Carregando PDF...');
        
        if (typeof window.pdfjsLib === 'undefined') {
          setPdfProcessingStatus('❌ Biblioteca PDF.js não encontrada. Adicione o script no HTML.');
          setIsProcessingPDF(false);
          return;
        }

        const pdf = await window.pdfjsLib.getDocument(typedArray).promise;
        let fullText = '';

        for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
          setPdfProcessingStatus(`Extraindo página ${pageNum} de ${pdf.numPages}...`);
          const page = await pdf.getPage(pageNum);
          const textContent = await page.getTextContent();
          const pageText = textContent.items.map(item => item.str).join(' ');
          fullText += pageText + '\n';
        }

        setPdfProcessingStatus('Processando informações...');
        processExtractedText(fullText, documentType);
      };

      reader.readAsArrayBuffer(file);
    } catch (error) {
      console.error('Erro ao processar PDF:', error);
      setPdfProcessingStatus(`❌ Erro: ${error.message}`);
      setIsProcessingPDF(false);
    }
  };

  const processExtractedText = (text, documentType) => {
    try {
      let extractedData = {};

      if (documentType === 'matricula') {
        const matriculaMatch = text.match(/(?:MATRÍCULA|MATRICULA)[\s:]*(\d+)/i);
        const nomeMatch = text.match(/(?:PROPRIETÁRIO|PROPRIETARIO|IMÓVEL|DENOMINAÇÃO|DENOMINACAO|LOTE|GLEBA|FAZENDA|SITIO|SÍTIO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ0-9\s\-]+)/i);
        
        // Melhorar extração de área: aceita formatos 104,23 ou 104.23 ou 104,2 ou 104
        const areaMatch = text.match(/(\d+[.,]?\d*)\s*(?:HECTARES|HECTARE|HA|HÁ|HAS)/i) || 
                          text.match(/(?:ÁREA|AREA)[:\s]*(\d+[.,]?\d*)/i);
        
        const cidadeMatch = text.match(/(?:MUNICÍPIO|MUNICIPIO|CIDADE)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const cartorioMatch = text.match(/(?:CARTÓRIO|CARTORIO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ0-9\s]+)/i);

        // Extrair data de emissão (manter formato DD/MM/AAAA)
        const dataMatch = text.match(/(?:DATA|EMISSÃO|EMISSAO|EXPEDIDA)[\s:]*(\d{2}[\/\-\.]\d{2}[\/\-\.]\d{4})/i);
        let dataEmissaoMatricula = '';
        if (dataMatch) {
          // Normalizar para DD/MM/AAAA
          const parts = dataMatch[1].match(/(\d{2})[\/\-\.](\d{2})[\/\-\.](\d{4})/);
          if (parts) dataEmissaoMatricula = `${parts[1]}/${parts[2]}/${parts[3]}`;
        }

        extractedData = {
          numeroMatricula: matriculaMatch ? matriculaMatch[1] : '',
          nomePropriedade: nomeMatch ? nomeMatch[1].trim() : '',
          hectares: areaMatch ? areaMatch[1] : '',
          cidade: cidadeMatch ? cidadeMatch[1].trim() : '',
          cartorio: cartorioMatch ? cartorioMatch[1].trim() : '',
          dataEmissao: dataEmissaoMatricula,
          matriculaFile: text
        };

      } else if (documentType === 'car') {
        const carMatch = text.match(/(?:CAR|CÓDIGO|CODIGO)[\s:]*([A-Z]{2}[-\s]?\d{7}[-\s]?[A-F0-9]{32})/i);
        const nomeMatch = text.match(/(?:NOME DO IMÓVEL|DENOMINAÇÃO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const areaMatch = text.match(/(?:ÁREA TOTAL|AREA TOTAL)[\s:]*(\d+[.,]?\d*)/i);
        const proprietarioMatch = text.match(/(?:PROPRIETÁRIO|DETENTOR)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const cpfMatch = text.match(/(?:CPF|CNPJ)[\s:]*(\d{3}\.?\d{3}\.?\d{3}[-/]?\d{2})/i);

        // Extrair campos adicionais do CAR
        const municipioMatch = text.match(/(?:MUNICÍPIO|MUNICIPIO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const consolidadaMatch = text.match(/(?:ÁREA CONSOLIDADA|AREA CONSOLIDADA)[\s:]*(\d+[.,]?\d*)/i);
        const reservaMatch = text.match(/(?:RESERVA LEGAL|ÁREA DE RESERVA)[\s:]*(\d+[.,]?\d*)/i);
        const matriculaCarMatch = text.match(/(?:MATRÍCULA|MATRICULA)[\s:]*(\d+)/i);

        extractedData = {
          registroCAR: carMatch ? carMatch[1] : '',
          nomeImovelRuralCAR: nomeMatch ? nomeMatch[1].trim() : '',
          municipioCAR: municipioMatch ? municipioMatch[1].trim() : '',
          areaTotalCAR: areaMatch ? areaMatch[1].replace(',', '.') : '',
          nomeProprietarioCAR: proprietarioMatch ? proprietarioMatch[1].trim() : '',
          cpfProprietarioCAR: cpfMatch ? cpfMatch[1] : '',
          areaConsolidada: consolidadaMatch ? consolidadaMatch[1].replace(',', '.') : '',
          areaReservaLegal: reservaMatch ? reservaMatch[1].replace(',', '.') : '',
          numeroMatriculaCAR: matriculaCarMatch ? matriculaCarMatch[1] : '',
          carFile: text
        };

      } else if (documentType === 'ccir') {
        const ccirMatch = text.match(/(?:CÓDIGO DO IMÓVEL|CODIGO)[\s:]*(\d+\.\d+\.\d+\.\d+[-\s]?\d)/i);
        const denominacaoMatch = text.match(/(?:DENOMINAÇÃO|NOME)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const areaMatch = text.match(/(?:ÁREA TOTAL|AREA)[\s:]*(\d+[.,]?\d*)/i);
        const titularMatch = text.match(/(?:TITULAR|PROPRIETÁRIO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);

        // Extrair campos adicionais do CCIR
        const exercicioMatch = text.match(/(?:EXERCÍCIO|EXERCICIO)[\s:]*(\d{4})/i);
        const municipioCCIRMatch = text.match(/(?:MUNICÍPIO SEDE|MUNICIPIO)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i);
        const cpfCnpjMatch = text.match(/(?:CPF|CNPJ)[\s:]*([\d\.\-\/]+)/i);

        extractedData = {
          exercicioCCIR: exercicioMatch ? exercicioMatch[1] : '',
          codigoImovelCCIR: ccirMatch ? ccirMatch[1] : '',
          denominacaoImovelCCIR: denominacaoMatch ? denominacaoMatch[1].trim() : '',
          areaTotalCCIR: areaMatch ? areaMatch[1].replace(',', '.') : '',
          municipioCCIR: municipioCCIRMatch ? municipioCCIRMatch[1].trim() : '',
          cpfCnpjTitularCCIR: cpfCnpjMatch ? cpfCnpjMatch[1] : '',
          nomeTitularCCIR: titularMatch ? titularMatch[1].trim() : '',
          ccirFile: text
        };

      } else if (documentType === 'onus') {
        // Ônus é descritivo, mas extrair se há menção de penhoras/hipotecas
        const penhoraMatch = text.match(/(?:PENHORA|HIPOTECA|GRAVAME)[\s:]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s,\.\-]+)/gi);
        
        extractedData = {
          temOnus: penhoraMatch && penhoraMatch.length > 0,
          onusAtivos: penhoraMatch ? penhoraMatch.join('; ') : '',
          onusFile: text
        };

      } else if (documentType === 'itr') {
        // ========== ITR - IMPOSTO TERRITORIAL RURAL (100% EFETIVO) ==========
        const get = (regex) => { const m = text.match(regex); return m ? m[1] : null; };
        const clean = (s) => s ? s.trim().replace(/\s+/g, ' ') : '';
        const upper = (s) => s ? s.toUpperCase() : '';
        const num = (s) => s ? s.replace(/\./g, '').replace(',', '.') : '';
        const dmy2iso = (s) => {
          if (!s) return '';
          const parts = s.match(/(\d{2})\/(\d{2})\/(\d{4})/);
          return parts ? `${parts[3]}-${parts[2]}-${parts[1]}` : '';
        };

        const cib        = get(/\bCIB\b[:\s]*([0-9\.\-]+)/i) || get(/\bNIRF\b[:\s]*([0-9\.\-]+)/i);
        const nomeImovel = clean(get(/NOME DO IM[ÓO]VEL[:\s]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ0-9\s\-\.,]+)/i));
        const municipio  = clean(upper(get(/MUNIC[ÍI]PIO[:\s]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s]+)/i)));
        const uf         = upper(get(/\bUF\b[:\s]*([A-Z]{2})/i)) || "PA";
        const areaTotal  = num(get(/ÁREA TOTAL\s*\(EM HECTARES\)[:\s]*([0-9\.\,]+)/i) || get(/ÁREA TOTAL[:\s]*([0-9\.\,]+)/i));
        const contribuinte = clean(get(/CONTRIBUINTE[:\s]*([A-ZÁÀÂÃÉÊÍÓÔÕÚÇ\s\.]+)/i));
        const cpf        = get(/\bCPF\b[:\s]*([\d\.\-]{11,14})/i);
        const validade   = dmy2iso(get(/V[ÁA]LIDA AT[ÉE][:\s]*(\d{2}\/\d{2}\/\d{4})/i));

        extractedData = {
          cibITR: cib || '',
          nomeImovelITR: nomeImovel || '',
          municipioITR: municipio || '',
          ufITR: uf || 'PA',
          areaTotalITR: areaTotal || '',
          contribuinteITR: contribuinte || '',
          cpfContribuinteITR: cpf || '',
          validadeITR: validade || '',
          itrFile: text
        };
      } else if (documentType === 'fichaSanitaria') {
        // ========== FICHA SANITÁRIA - BOVÍDEOS ==========
        const getNum = (regex) => { const m = text.match(regex); return m ? parseInt(m[1]) || 0 : 0; };
        
        // Extrair dados de bovídeos
        const bovideos = text.match(/Bov[íi]deos[\s\S]*?(\d+)[\s\S]*?EXPLORA[ÇC][ÕO]ES PEC[ÚU][ÁA]RIAS/i);
        
        // Procurar padrões de idade na tabela
        const macho0a12 = getNum(/Macho[,\s]+0\s*a\s*12\s*meses[\s\S]*?Saldo[\s]*(\d+)/i);
        const femea0a12 = getNum(/F[êe]mea[,\s]+0\s*a\s*12\s*meses[\s\S]*?(\d+)/i);
        const macho13a24 = getNum(/Macho[,\s]+13\s*a\s*24\s*meses[\s\S]*?(\d+)/i);
        const femea13a24 = getNum(/F[êe]mea[,\s]+13\s*a\s*24\s*meses[\s\S]*?(\d+)/i);
        const macho25a36 = getNum(/Macho[,\s]+25\s*a\s*36\s*meses[\s\S]*?(\d+)/i);
        const femea25a36 = getNum(/F[êe]mea[,\s]+25\s*a\s*36\s*meses[\s\S]*?(\d+)/i);
        const machoAcima36 = getNum(/Macho[,\s]+Acima\s*de\s*36\s*meses[\s\S]*?(\d+)/i);
        const femeaAcima36 = getNum(/F[êe]mea[,\s]+Acima\s*de\s*36\s*meses[\s\S]*?(\d+)/i);

        extractedData = {
          bovideoMacho0a12: macho0a12 || '',
          bovideoFemea0a12: femea0a12 || '',
          bovideoMacho13a24: macho13a24 || '',
          bovideoFemea13a24: femea13a24 || '',
          bovideoMacho25a36: macho25a36 || '',
          bovideoFemea25a36: femea25a36 || '',
          bovideoMachoAcima36: machoAcima36 || '',
          bovideoFemeaAcima36: femeaAcima36 || '',
          fichaSanitariaFile: text
        };
      }

      // ========== APLICAR PADRÕES APRENDIDOS ==========
      const enhancedData = applyLearnedPatterns(text, documentType, extractedData);

      // ========== MOSTRAR DIÁLOGO DE CONFIRMAÇÃO ==========
      setPendingExtraction({
        documentType,
        extractedData: enhancedData,
        originalText: text
      });

      // Preencher campos automaticamente
      if (documentType === 'fichaSanitaria') {
        setCurrentProducao(prev => {
          const updated = { ...prev };
          Object.keys(enhancedData).forEach(key => {
            if (enhancedData[key] && key !== 'fichaSanitariaFile') updated[key] = enhancedData[key];
          });
          return updated;
        });
      } else {
        setCurrentPropriedade(prev => {
          const updated = { ...prev };
          Object.keys(enhancedData).forEach(key => {
            if (enhancedData[key]) updated[key] = enhancedData[key];
          });
          return updated;
        });
      }

      setPdfProcessingStatus(`✅ ${Object.keys(enhancedData).filter(k => enhancedData[k]).length} campos extraídos!`);
      setShowConfirmDialog(true);

      setTimeout(() => {
        setIsProcessingPDF(false);
        setPdfProcessingStatus('');
        setCurrentProcessingDoc('');
      }, 2000);

    } catch (error) {
      console.error('Erro ao processar texto:', error);
      setPdfProcessingStatus(`❌ Erro ao processar: ${error.message}`);
      setIsProcessingPDF(false);
    }
  };

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 z-50 overflow-auto">
      <div className="min-h-screen py-8 px-4">
        <div className="max-w-full mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
          
          {isProcessingPDF && (
            <div className="fixed top-4 right-4 bg-blue-600 text-white px-6 py-4 rounded-lg shadow-xl z-50 animate-pulse">
              <p className="font-bold">🔄 Processando {currentProcessingDoc}...</p>
              <p className="text-sm">{pdfProcessingStatus}</p>
            </div>
          )}

          <div className="bg-gradient-to-r from-emerald-900 to-emerald-800 p-6 flex items-center justify-between">
            <div className="flex items-center gap-4">
              <button onClick={onClose} className="text-yellow-400 hover:text-yellow-300">
                <ArrowLeft size={28} />
              </button>
              <div>
                <h2 className="text-3xl font-bold text-yellow-400">✨ Novo Cliente - Wizard Completo</h2>
                <p className="text-emerald-200">Preencha todas as informações do cliente</p>
              </div>
            </div>
            <button onClick={onClose} className="text-yellow-400 cursor-pointer hover:text-yellow-300">
              <X size={32} />
            </button>
          </div>

          <div className="flex">
            <div className="w-72 bg-emerald-50 border-r-2 border-emerald-200 p-4 space-y-2">
              <button onClick={() => setActiveMenu('dashboard')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'dashboard' ? 'bg-yellow-600 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <BarChart3 size={20} /> 📊 Dashboard
              </button>
              <button onClick={() => setActiveMenu('cliente')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'cliente' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <User size={20} /> 1. Cliente
              </button>
              <button onClick={() => setActiveMenu('grupo')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'grupo' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Users size={20} /> 2. Grupo Familiar
              </button>
              <button onClick={() => setActiveMenu('propriedades')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'propriedades' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Building2 size={20} /> 3. Propriedades
              </button>
              <button onClick={() => setActiveMenu('maquinas')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'maquinas' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Tractor size={20} /> 4. Máquinas
              </button>
              <button onClick={() => setActiveMenu('veiculos')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'veiculos' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Truck size={20} /> 5. Veículos
              </button>
              <button onClick={() => setActiveMenu('imoveis')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'imoveis' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Building size={20} /> 6. Imóveis Urbanos
              </button>
              <button onClick={() => setActiveMenu('producao')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'producao' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <Package size={20} /> 7. Produção
              </button>
              <button onClick={() => setActiveMenu('endividamento')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'endividamento' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <DollarSign size={20} /> 8. Endividamento
              </button>
              <button onClick={() => setActiveMenu('contratos')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'contratos' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <FileText size={20} /> 9. Contratos
              </button>
              <button onClick={() => setActiveMenu('relatorios')} className={`w-full text-left px-4 py-3 rounded-lg font-semibold flex items-center gap-3 ${activeMenu === 'relatorios' ? 'bg-emerald-700 text-white' : 'text-emerald-900 hover:bg-emerald-100'}`}>
                <BarChart3 size={20} /> 10. Relatórios
              </button>
            </div>

            <div className="flex-1 p-8 overflow-y-auto" style={{maxHeight: '70vh'}}>

              {activeMenu === 'cliente' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">👤 Dados do Cliente</h3>
                  
                  <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                    <div className="grid grid-cols-3 gap-4">
                      <input type="text" placeholder="Nome Completo" value={clienteData.nomeCompleto} onChange={(e) => setClienteData({...clienteData, nomeCompleto: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-emerald-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Data Nascimento (DD/MM/AAAA)" value={clienteData.dataNascimento} onChange={(e) => setClienteData({...clienteData, dataNascimento: maskData(e.target.value)})} className="px-3 py-2 border-2 border-emerald-300 rounded-lg" maxLength="10" />
                      <div className="relative">
                        <input 
                          type="text" 
                          placeholder="CPF" 
                          value={clienteData.cpf} 
                          onChange={(e) => handleCpfChange(e.target.value)} 
                          className={`w-full px-3 py-2 border-2 rounded-lg ${cpfDuplicadoAlert ? 'border-red-500 bg-red-50' : 'border-emerald-300'}`}
                          maxLength="14" 
                        />
                        {cpfDuplicadoAlert && (
                          <div className="absolute top-full left-0 right-0 mt-1 bg-red-500 text-white p-3 rounded-lg shadow-lg z-10 text-sm font-bold">
                            ⚠️ CPF JÁ CADASTRADO!<br/>
                            Cliente: {cpfDuplicadoAlert.nome}
                          </div>
                        )}
                      </div>
                      <input type="text" placeholder="CNPJ (opcional)" value={clienteData.cnpj} onChange={(e) => setClienteData({...clienteData, cnpj: e.target.value})} className="px-3 py-2 border-2 border-emerald-300 rounded-lg" />
                      <input type="text" placeholder="Telefone" value={clienteData.telefone} onChange={(e) => setClienteData({...clienteData, telefone: maskTelefone(e.target.value)})} className="px-3 py-2 border-2 border-emerald-300 rounded-lg" maxLength="13" />
                      <input type="email" placeholder="Email" value={clienteData.email} onChange={(e) => setClienteData({...clienteData, email: e.target.value.toLowerCase()})} className="col-span-3 px-3 py-2 border-2 border-emerald-300 rounded-lg" />
                      <input type="text" placeholder="Endereço Completo" value={clienteData.enderecoCompleto} onChange={(e) => setClienteData({...clienteData, enderecoCompleto: e.target.value})} className="col-span-3 px-3 py-2 border-2 border-emerald-300 rounded-lg" />
                    </div>
                  </div>

                  <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                    <h4 className="font-bold text-blue-900 mb-3">💍 Estado Civil</h4>
                    <div className="flex items-center gap-3 mb-3">
                      <input type="checkbox" checked={clienteData.casado} onChange={(e) => setClienteData({...clienteData, casado: e.target.checked})} className="w-5 h-5" />
                      <label className="font-semibold">Cliente é casado(a)?</label>
                    </div>
                    {clienteData.casado && (
                      <div className="grid grid-cols-2 gap-3">
                        <input type="text" placeholder="Nome do Cônjuge" value={clienteData.nomeConjuge} onChange={(e) => setClienteData({...clienteData, nomeConjuge: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                        <input type="text" placeholder="CPF do Cônjuge" value={clienteData.cpfConjuge} onChange={(e) => setClienteData({...clienteData, cpfConjuge: maskCPF(e.target.value)})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" maxLength="14" />
                      </div>
                    )}
                  </div>

                  <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                    <div className="grid grid-cols-2 gap-3">
                      <input type="text" placeholder="Nome da Empresa (se houver)" value={clienteData.nomeEmpresa} onChange={(e) => setClienteData({...clienteData, nomeEmpresa: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <select value={clienteData.tipoAtendimento} onChange={(e) => setClienteData({...clienteData, tipoAtendimento: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg font-bold">
                        <option>Padrão</option>
                        <option>VIP</option>
                        <option>Premium</option>
                      </select>
                    </div>
                  </div>
                  
                  {/* Botão Salvar da Etapa Cliente */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Cliente')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Dados do Cliente
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'grupo' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">👨‍👩‍👧‍👦 Grupo Familiar / Sócios</h3>
                  
                  <div className="flex items-center gap-3 bg-blue-50 p-4 rounded-lg">
                    <input type="checkbox" checked={grupoData.atuaSozinho} onChange={(e) => setGrupoData({...grupoData, atuaSozinho: e.target.checked})} className="w-5 h-5" />
                    <label className="font-semibold">Cliente atua sozinho (sem grupo)</label>
                  </div>

                  {!grupoData.atuaSozinho && (
                    <>
                      <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                        <h4 className="font-bold text-emerald-900 mb-3">Adicionar Membro do Grupo</h4>
                        <div className="grid grid-cols-4 gap-3">
                          <input type="text" placeholder="Nome" value={currentMembro.nome} onChange={(e) => setCurrentMembro({...currentMembro, nome: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-emerald-300 rounded-lg" />
                          <input type="text" placeholder="CPF" value={currentMembro.cpf} onChange={(e) => setCurrentMembro({...currentMembro, cpf: maskCPF(e.target.value)})} className="px-3 py-2 border-2 border-emerald-300 rounded-lg" maxLength="14" />
                          <select value={currentMembro.parentesco} onChange={(e) => setCurrentMembro({...currentMembro, parentesco: e.target.value})} className="px-3 py-2 border-2 border-emerald-300 rounded-lg font-semibold">
                            <option value="">Parentesco</option>
                            <option value="CÔNJUGE">CÔNJUGE</option>
                            <option value="FILHO(A)">FILHO(A)</option>
                            <option value="IRMÃO(Ã)">IRMÃO(Ã)</option>
                            <option value="PARCEIRO(A)">PARCEIRO(A)</option>
                            <option value="OUTROS">OUTROS</option>
                          </select>
                          <input type="text" placeholder="% Participação" value={currentMembro.participacao} onChange={(e) => setCurrentMembro({...currentMembro, participacao: maskPercentual(e.target.value)})} className="col-span-4 px-3 py-2 border-2 border-emerald-300 rounded-lg font-bold" />
                        </div>
                        <button onClick={handleAddMembro} className="mt-3 w-full py-2 bg-emerald-600 text-white rounded-lg font-semibold flex items-center justify-center gap-2">
                          <Plus size={18} /> Adicionar Membro
                        </button>
                      </div>

                      {grupoData.membros.length > 0 && (
                        <div className="bg-emerald-50 p-4 rounded-lg">
                          <h4 className="font-bold mb-2">✅ Membros Cadastrados ({grupoData.membros.length})</h4>
                          {grupoData.membros.map((m, i) => (
                            <div key={m.id} className="flex justify-between items-center p-3 bg-white rounded-lg mb-2 shadow">
                              <div>
                                <p className="font-bold">{i+1}. {m.nome}</p>
                                <p className="text-sm text-gray-600">{m.cpf} | {m.parentesco} | {m.participacao}%</p>
                              </div>
                              <div className="flex gap-2">
                                <button 
                                  onClick={() => {
                                    setCurrentMembro(m);
                                    setGrupoData({...grupoData, membros: grupoData.membros.filter((_, idx) => idx !== i)});
                                  }} 
                                  className="text-blue-600 hover:bg-blue-50 p-2 rounded"
                                >
                                  <Edit size={18} />
                                </button>
                                <button 
                                  onClick={() => setGrupoData({...grupoData, membros: grupoData.membros.filter((_, idx) => idx !== i)})} 
                                  className="text-red-600 hover:bg-red-50 p-2 rounded"
                                >
                                  <Trash2 size={18} />
                                </button>
                              </div>
                            </div>
                          ))}
                        </div>
                      )}
                    </>
                  )}
                  
                  {/* Botão Salvar da Etapa Grupo */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Grupo Familiar')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Grupo Familiar
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'propriedades' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">🏞️ Propriedades Rurais</h3>
                  
                  {/* CARDS DE RESUMO */}
                  {propriedadesData.length > 0 && (
                    <div className="grid grid-cols-3 gap-4 mb-6">
                      {/* Card Total de Propriedades */}
                      <div className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg">
                        <Building2 size={32} className="mb-3" />
                        <h4 className="text-4xl font-bold">{propriedadesData.length}</h4>
                        <p className="text-blue-100 text-sm">Propriedade{propriedadesData.length !== 1 ? 's' : ''} Cadastrada{propriedadesData.length !== 1 ? 's' : ''}</p>
                      </div>

                      {/* Card Área Total */}
                      <div className="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg">
                        <Package size={32} className="mb-3" />
                        <h4 className="text-4xl font-bold">
                          {propriedadesData.reduce((acc, p) => {
                            const ha = p.areaTotalCAR ? parseFloat(p.areaTotalCAR.replace(',', '.') || 0) : 
                                       parseFloat(p.hectares?.replace(',', '.') || 0);
                            return acc + ha;
                          }, 0).toFixed(2).replace('.', ',')}
                        </h4>
                        <p className="text-green-100 text-sm">Hectares - Área Total</p>
                      </div>

                      {/* Card Área Consolidada */}
                      <div className="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl p-6 text-white shadow-lg">
                        <CheckCircle size={32} className="mb-3" />
                        <h4 className="text-4xl font-bold">
                          {propriedadesData.reduce((acc, p) => {
                            const ha = p.areaConsolidada ? parseFloat(p.areaConsolidada.replace(',', '.') || 0) : 0;
                            return acc + ha;
                          }, 0).toFixed(2).replace('.', ',')}
                        </h4>
                        <p className="text-emerald-100 text-sm">Hectares - Área Consolidada</p>
                      </div>
                    </div>
                  )}
                  
                  <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                    <h4 className="font-bold text-blue-900 mb-3 text-lg">📄 Matrícula do Imóvel</h4>
                    <div className="grid grid-cols-4 gap-3">
                      <input type="text" placeholder="Nº Matrícula" value={currentPropriedade.numeroMatricula} onChange={(e) => setCurrentPropriedade({...currentPropriedade, numeroMatricula: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Nome da Propriedade" value={currentPropriedade.nomePropriedade} onChange={(e) => setCurrentPropriedade({...currentPropriedade, nomePropriedade: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-blue-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Hectares" value={currentPropriedade.hectares} onChange={(e) => setCurrentPropriedade({...currentPropriedade, hectares: maskHectares(e.target.value)})} className="px-3 py-2 border-2 border-blue-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Cidade" value={currentPropriedade.cidade} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cidade: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="UF" value={currentPropriedade.uf} onChange={(e) => setCurrentPropriedade({...currentPropriedade, uf: maskUF(e.target.value)})} className="px-3 py-2 border-2 border-blue-300 rounded-lg font-bold text-center" maxLength="2" />
                      <input type="text" placeholder="Cartório" value={currentPropriedade.cartorio} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cartorio: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="Data Emissão (ex: 15/03/2023)" value={currentPropriedade.dataEmissao} onChange={(e) => setCurrentPropriedade({...currentPropriedade, dataEmissao: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <div className="col-span-4 bg-blue-100 border-2 border-blue-400 rounded-lg p-3">
                        <label className="flex items-center gap-2 cursor-pointer">
                          <Upload size={20} className="text-blue-700" />
                          <span className="font-semibold text-blue-900">📎 Upload Matrícula (PDF)</span>
                          <input type="file" accept=".pdf" id="matriculaUpload" key={fileInputKeys.matricula} onChange={(e) => handleFileUpload(e.target.files[0], 'matricula')} className="hidden" />
                        </label>
                        {currentPropriedade.matriculaFile && (
                          <button 
                            onClick={() => {
                              setCurrentPropriedade({...currentPropriedade, matriculaFile: null});
                              document.getElementById('matriculaUpload').value = '';
                            }}
                            className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                          >
                            <X size={16} /> Remover PDF
                          </button>
                        )}
                      </div>
                    </div>
                  </div>

                  <div className="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                    <h4 className="font-bold text-green-900 mb-3 text-lg">🌳 CAR (Cadastro Ambiental Rural)</h4>
                    <div className="grid grid-cols-4 gap-3">
                      <input type="text" placeholder="Registro CAR" value={currentPropriedade.registroCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, registroCAR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-green-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Nome Imóvel Rural" value={currentPropriedade.nomeImovelRuralCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, nomeImovelRuralCAR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Município" value={currentPropriedade.municipioCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, municipioCAR: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Área Total (ha)" value={currentPropriedade.areaTotalCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, areaTotalCAR: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Nome Proprietário" value={currentPropriedade.nomeProprietarioCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, nomeProprietarioCAR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="CPF Proprietário" value={currentPropriedade.cpfProprietarioCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cpfProprietarioCAR: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Área Consolidada (ha)" value={currentPropriedade.areaConsolidada} onChange={(e) => setCurrentPropriedade({...currentPropriedade, areaConsolidada: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Área Reserva Legal (ha)" value={currentPropriedade.areaReservaLegal} onChange={(e) => setCurrentPropriedade({...currentPropriedade, areaReservaLegal: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <input type="text" placeholder="Nº Matrícula CAR" value={currentPropriedade.numeroMatriculaCAR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, numeroMatriculaCAR: e.target.value})} className="px-3 py-2 border-2 border-green-300 rounded-lg" />
                      <div className="col-span-4 bg-green-100 border-2 border-green-400 rounded-lg p-3">
                        <label className="flex items-center gap-2 cursor-pointer">
                          <Upload size={20} className="text-green-700" />
                          <span className="font-semibold text-green-900">📎 Upload CAR (PDF)</span>
                          <input type="file" accept=".pdf" id="carUpload" key={fileInputKeys.car} onChange={(e) => handleFileUpload(e.target.files[0], 'car')} className="hidden" />
                        </label>
                        {currentPropriedade.carFile && (
                          <button 
                            onClick={() => {
                              setCurrentPropriedade({...currentPropriedade, carFile: null});
                              document.getElementById('carUpload').value = '';
                            }}
                            className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                          >
                            <X size={16} /> Remover PDF
                          </button>
                        )}
                      </div>
                    </div>
                  </div>

                  <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                    <h4 className="font-bold text-yellow-900 mb-3 text-lg">📋 CCIR (Certificado de Cadastro)</h4>
                    <div className="grid grid-cols-4 gap-3">
                      <input type="text" placeholder="Exercício" value={currentPropriedade.exercicioCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, exercicioCCIR: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Código Imóvel" value={currentPropriedade.codigoImovelCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, codigoImovelCCIR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Denominação Imóvel" value={currentPropriedade.denominacaoImovelCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, denominacaoImovelCCIR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Área Total (ha)" value={currentPropriedade.areaTotalCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, areaTotalCCIR: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Município" value={currentPropriedade.municipioCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, municipioCCIR: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="UF" value={currentPropriedade.ufCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, ufCCIR: maskUF(e.target.value)})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg font-bold text-center" maxLength="2" />
                      <input type="text" placeholder="CPF/CNPJ Titular" value={currentPropriedade.cpfCnpjTitularCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cpfCnpjTitularCCIR: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Nome Titular" value={currentPropriedade.nomeTitularCCIR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, nomeTitularCCIR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <div className="col-span-4 bg-yellow-100 border-2 border-yellow-400 rounded-lg p-3">
                        <label className="flex items-center gap-2 cursor-pointer">
                          <Upload size={20} className="text-yellow-700" />
                          <span className="font-semibold text-yellow-900">📎 Upload CCIR (PDF)</span>
                          <input type="file" accept=".pdf" id="ccirUpload" key={fileInputKeys.ccir} onChange={(e) => handleFileUpload(e.target.files[0], 'ccir')} className="hidden" />
                        </label>
                        {currentPropriedade.ccirFile && (
                          <button 
                            onClick={() => {
                              setCurrentPropriedade({...currentPropriedade, ccirFile: null});
                              document.getElementById('ccirUpload').value = '';
                            }}
                            className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                          >
                            <X size={16} /> Remover PDF
                          </button>
                        )}
                      </div>
                    </div>
                  </div>

                  <div className="bg-red-50 border-2 border-red-300 rounded-lg p-4">
                    <h4 className="font-bold text-red-900 mb-3 text-lg">⚠️ Ônus / Gravames</h4>
                    <div className="flex items-center gap-3 mb-3">
                      <input type="checkbox" checked={currentPropriedade.temOnus} onChange={(e) => setCurrentPropriedade({...currentPropriedade, temOnus: e.target.checked})} className="w-5 h-5" />
                      <label className="font-semibold">Propriedade possui ônus ativos?</label>
                    </div>
                    {currentPropriedade.temOnus && (
                      <div className="grid grid-cols-1 gap-3">
                        <textarea placeholder="Descreva os ônus ativos (penhoras, hipotecas, etc)" value={currentPropriedade.onusAtivos} onChange={(e) => setCurrentPropriedade({...currentPropriedade, onusAtivos: e.target.value})} className="px-3 py-2 border-2 border-red-300 rounded-lg h-24" />
                        <div className="bg-red-100 border-2 border-red-400 rounded-lg p-3">
                          <label className="flex items-center gap-2 cursor-pointer">
                            <Upload size={20} className="text-red-700" />
                            <span className="font-semibold text-red-900">📎 Upload Certidão de Ônus (PDF)</span>
                            <input type="file" accept=".pdf" id="onusUpload" key={fileInputKeys.onus} onChange={(e) => handleFileUpload(e.target.files[0], 'onus')} className="hidden" />
                          </label>
                          {currentPropriedade.onusFile && (
                            <button 
                              onClick={() => {
                                setCurrentPropriedade({...currentPropriedade, onusFile: null});
                                document.getElementById('onusUpload').value = '';
                              }}
                              className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                            >
                              <X size={16} /> Remover PDF
                            </button>
                          )}
                        </div>
                      </div>
                    )}
                  </div>

                  <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                    <h4 className="font-bold text-purple-900 mb-3 text-lg">💰 ITR (Imposto Territorial Rural)</h4>
                    <div className="grid grid-cols-4 gap-3">
                      <input type="text" placeholder="CIB/NIRF" value={currentPropriedade.cibITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cibITR: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg font-bold" />
                      <input type="text" placeholder="Nome do Imóvel" value={currentPropriedade.nomeImovelITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, nomeImovelITR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Município" value={currentPropriedade.municipioITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, municipioITR: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="UF" value={currentPropriedade.ufITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, ufITR: maskUF(e.target.value)})} className="px-3 py-2 border-2 border-purple-300 rounded-lg font-bold text-center" maxLength="2" />
                      <input type="text" placeholder="Área Total (ha)" value={currentPropriedade.areaTotalITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, areaTotalITR: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Contribuinte" value={currentPropriedade.contribuinteITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, contribuinteITR: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="CPF Contribuinte" value={currentPropriedade.cpfContribuinteITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, cpfContribuinteITR: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Validade (ex: 31/12/2025)" value={currentPropriedade.validadeITR} onChange={(e) => setCurrentPropriedade({...currentPropriedade, validadeITR: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <div className="col-span-4 bg-purple-100 border-2 border-purple-400 rounded-lg p-3">
                        <label className="flex items-center gap-2 cursor-pointer">
                          <Upload size={20} className="text-purple-700" />
                          <span className="font-semibold text-purple-900">📎 Upload ITR (PDF)</span>
                          <input type="file" accept=".pdf" onChange={(e) => handleFileUpload(e.target.files[0], 'itr')} className="hidden" />
                        </label>
                        {currentPropriedade.itrFile && (
                          <button 
                            onClick={() => {
                              setCurrentPropriedade({...currentPropriedade, itrFile: null});
                            }}
                            className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                          >
                            <X size={16} /> Remover PDF
                          </button>
                        )}
                      </div>
                    </div>
                  </div>

                  <button onClick={handleAddPropriedade} className="w-full py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-lg font-bold text-lg flex items-center justify-center gap-2 shadow-lg">
                    <Plus size={22} /> Adicionar Propriedade
                  </button>

                  {propriedadesData.length > 0 && (
                    <div className="bg-emerald-50 p-4 rounded-lg">
                      <h4 className="font-bold mb-3 text-lg">✅ Propriedades Cadastradas ({propriedadesData.length})</h4>
                      {propriedadesData.map((prop, i) => (
                        <div key={prop.id} className="bg-white rounded-lg p-4 mb-2 shadow">
                          <div className="flex justify-between items-start">
                            <div className="flex-1">
                              <p className="font-bold text-lg text-emerald-900">{i+1}. {prop.nomePropriedade}</p>
                              <p className="text-sm text-gray-600">{prop.hectares} ha | {prop.cidade}/{prop.uf}</p>
                              {prop.numeroMatricula && <p className="text-sm"><strong>Matrícula:</strong> {prop.numeroMatricula}</p>}
                              {prop.registroCAR && <p className="text-sm"><strong>CAR:</strong> {prop.registroCAR}</p>}
                            </div>
                            <div className="flex gap-2">
                              <button onClick={() => handleEditPropriedade(i)} className="text-blue-600 hover:bg-blue-50 p-2 rounded" title="Editar">
                                <Edit size={18} />
                              </button>
                              <button onClick={() => setPropriedadesData(propriedadesData.filter((_, idx) => idx !== i))} className="text-red-600 hover:bg-red-50 p-2 rounded" title="Excluir">
                                <Trash2 size={18} />
                              </button>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {/* Botão Salvar da Etapa Propriedades */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Propriedades')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Propriedades
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'maquinas' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">🚜 Máquinas Agrícolas</h3>
                  
                  {/* Card Resumo no Topo */}
                  {maquinasData.length > 0 && (
                    <div className="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl p-6 text-white">
                      <div className="flex items-center justify-between">
                        <div>
                          <p className="text-yellow-100 text-sm mb-1">Total de Máquinas</p>
                          <h4 className="text-4xl font-bold">
                            {maquinasData.reduce((acc, m) => acc + parseInt(m.quantidade || 1), 0)}
                          </h4>
                          <p className="text-yellow-100 text-xs mt-1">
                            {maquinasData.length} tipo{maquinasData.length > 1 ? 's' : ''} de máquina{maquinasData.length > 1 ? 's' : ''}
                          </p>
                        </div>
                        <div className="text-right">
                          <p className="text-yellow-100 text-sm mb-1">Valor Total</p>
                          <h4 className="text-3xl font-bold">
                            R$ {maquinasData.reduce((acc, m) => {
                              const valor = m.valorEstimado ? parseFloat(m.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                              const qtd = parseInt(m.quantidade || 1);
                              return acc + (valor * qtd);
                            }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                          </h4>
                        </div>
                      </div>
                    </div>
                  )}

                  <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                    <div className="grid grid-cols-4 gap-3">
                      <select value={currentMaquina.tipo} onChange={(e) => setCurrentMaquina({...currentMaquina, tipo: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg font-bold">
                        <option value="">Tipo de Máquina</option>
                        <option>Trator</option>
                        <option>Colheitadeira</option>
                        <option>Plantadeira</option>
                        <option>Pulverizador</option>
                        <option>Grade</option>
                        <option>Outros</option>
                      </select>
                      <input type="text" placeholder="Marca" value={currentMaquina.marca} onChange={(e) => setCurrentMaquina({...currentMaquina, marca: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Modelo" value={currentMaquina.modelo} onChange={(e) => setCurrentMaquina({...currentMaquina, modelo: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input type="text" placeholder="Ano" value={currentMaquina.ano} onChange={(e) => setCurrentMaquina({...currentMaquina, ano: maskAno(e.target.value)})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" maxLength="4" />
                      <input type="text" placeholder="Placa (se houver)" value={currentMaquina.placa} onChange={(e) => setCurrentMaquina({...currentMaquina, placa: e.target.value})} className="px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                      <input 
                        type="number" 
                        placeholder="Quantidade" 
                        value={currentMaquina.quantidade} 
                        onChange={(e) => setCurrentMaquina({...currentMaquina, quantidade: e.target.value})} 
                        className="px-3 py-2 border-2 border-yellow-300 rounded-lg font-bold text-center"
                        min="1"
                      />
                      <input type="text" placeholder="Valor Unit. (R$)" value={currentMaquina.valorEstimado} onChange={(e) => setCurrentMaquina({...currentMaquina, valorEstimado: maskValor(e.target.value)})} className="col-span-2 px-3 py-2 border-2 border-yellow-300 rounded-lg" />
                    </div>
                    <button onClick={handleAddMaquina} className="mt-3 w-full py-2 bg-yellow-600 text-white rounded-lg font-semibold flex items-center justify-center gap-2">
                      <Plus size={18} /> Adicionar Máquina
                    </button>
                  </div>
                  {maquinasData.length > 0 && (
                    <div className="bg-yellow-50 p-4 rounded-lg">
                      <h4 className="font-bold mb-2">✅ Máquinas ({maquinasData.length})</h4>
                      {maquinasData.map((maq, i) => {
                        const valorUnit = maq.valorEstimado ? parseFloat(maq.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                        const qtd = parseInt(maq.quantidade || 1);
                        const valorTotal = valorUnit * qtd;

                        return (
                          <div key={maq.id} className="flex justify-between items-center p-3 bg-white rounded mb-2 border border-yellow-200">
                            <div className="flex-1">
                              <div className="flex items-center gap-3">
                                <span className="font-bold text-yellow-900">
                                  {i+1}. {maq.tipo} {maq.marca} {maq.modelo} ({maq.ano})
                                </span>
                                {maq.placa && (
                                  <span className="bg-yellow-200 text-yellow-900 px-2 py-0.5 rounded text-xs font-semibold">
                                    {maq.placa}
                                  </span>
                                )}
                              </div>
                              <div className="flex gap-4 text-sm text-yellow-700 mt-1">
                                <span className="font-semibold">Qtd: {qtd}</span>
                                <span>Valor Unit: R$ {maq.valorEstimado}</span>
                                <span className="font-bold text-yellow-900">Total: R$ {valorTotal.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                              </div>
                            </div>
                            <div className="flex gap-2">
                              <button 
                                onClick={() => handleEditMaquina(i)} 
                                className="text-blue-600 hover:bg-blue-50 p-2 rounded" 
                                title="Editar"
                              >
                                <Edit size={16} />
                              </button>
                              <button 
                                onClick={() => setMaquinasData(maquinasData.filter((_, idx) => idx !== i))} 
                                className="text-red-600 hover:bg-red-50 p-2 rounded"
                                title="Excluir"
                              >
                                <Trash2 size={16} />
                              </button>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  )}
                  
                  {/* Botão Salvar da Etapa Máquinas */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Máquinas')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Máquinas
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'veiculos' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">🚗 Veículos</h3>
                  
                  {/* Card Resumo no Topo */}
                  {veiculosData.length > 0 && (
                    <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white">
                      <div className="flex items-center justify-between">
                        <div>
                          <p className="text-purple-100 text-sm mb-1">Total de Veículos</p>
                          <h4 className="text-4xl font-bold">{veiculosData.length}</h4>
                          <p className="text-purple-100 text-xs mt-1">veículo{veiculosData.length > 1 ? 's' : ''} cadastrado{veiculosData.length > 1 ? 's' : ''}</p>
                        </div>
                        <div className="text-right">
                          <p className="text-purple-100 text-sm mb-1">Valor Total</p>
                          <h4 className="text-3xl font-bold">
                            R$ {veiculosData.reduce((acc, v) => {
                              const valor = v.valorEstimado ? parseFloat(v.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                              return acc + valor;
                            }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                          </h4>
                        </div>
                      </div>
                    </div>
                  )}

                  <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                    <div className="grid grid-cols-3 gap-3">
                      <select value={currentVeiculo.tipo} onChange={(e) => setCurrentVeiculo({...currentVeiculo, tipo: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg font-bold">
                        <option value="">Tipo de Veículo</option>
                        <option>Carro</option>
                        <option>Caminhonete</option>
                        <option>Caminhão</option>
                        <option>Moto</option>
                        <option>Outros</option>
                      </select>
                      <input type="text" placeholder="Marca" value={currentVeiculo.marca} onChange={(e) => setCurrentVeiculo({...currentVeiculo, marca: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="Modelo" value={currentVeiculo.modelo} onChange={(e) => setCurrentVeiculo({...currentVeiculo, modelo: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="Ano" value={currentVeiculo.ano} onChange={(e) => setCurrentVeiculo({...currentVeiculo, ano: maskAno(e.target.value)})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" maxLength="4" />
                      <input type="text" placeholder="Placa" value={currentVeiculo.placa} onChange={(e) => setCurrentVeiculo({...currentVeiculo, placa: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="RENAVAM" value={currentVeiculo.renavam} onChange={(e) => setCurrentVeiculo({...currentVeiculo, renavam: e.target.value})} className="px-3 py-2 border-2 border-blue-300 rounded-lg" />
                      <input type="text" placeholder="Valor Estimado (R$)" value={currentVeiculo.valorEstimado} onChange={(e) => setCurrentVeiculo({...currentVeiculo, valorEstimado: maskValor(e.target.value)})} className="col-span-3 px-3 py-2 border-2 border-blue-300 rounded-lg" />
                    </div>
                    <button onClick={handleAddVeiculo} className="mt-3 w-full py-2 bg-blue-600 text-white rounded-lg font-semibold flex items-center justify-center gap-2">
                      <Plus size={18} /> Adicionar Veículo
                    </button>
                  </div>
                  {veiculosData.length > 0 && (
                    <div className="bg-blue-50 p-4 rounded-lg">
                      <h4 className="font-bold mb-2">✅ Veículos ({veiculosData.length})</h4>
                      {veiculosData.map((veic, i) => (
                        <div key={veic.id} className="flex justify-between items-center p-3 bg-white rounded mb-2 border border-blue-200">
                          <div className="flex-1">
                            <div className="flex items-center gap-3">
                              <span className="font-bold text-blue-900">
                                {i+1}. {veic.tipo} {veic.marca} {veic.modelo} ({veic.ano})
                              </span>
                              <span className="bg-blue-200 text-blue-900 px-2 py-0.5 rounded text-xs font-semibold">
                                {veic.placa}
                              </span>
                            </div>
                            <div className="flex gap-4 text-sm text-blue-700 mt-1">
                              {veic.renavam && <span>RENAVAM: {veic.renavam}</span>}
                              <span className="font-bold text-blue-900">Valor: R$ {veic.valorEstimado}</span>
                            </div>
                          </div>
                          <div className="flex gap-2">
                            <button 
                              onClick={() => handleEditVeiculo(i)} 
                              className="text-blue-600 hover:bg-blue-50 p-2 rounded" 
                              title="Editar"
                            >
                              <Edit size={16} />
                            </button>
                            <button 
                              onClick={() => setVeiculosData(veiculosData.filter((_, idx) => idx !== i))} 
                              className="text-red-600 hover:bg-red-50 p-2 rounded"
                              title="Excluir"
                            >
                              <Trash2 size={16} />
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {/* Botão Salvar da Etapa Veículos */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Veículos')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Veículos
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'imoveis' && (
                <div className="space-y-4 max-w-6xl">
                  <h3 className="text-2xl font-bold text-emerald-900">🏘️ Imóveis Urbanos</h3>
                  
                  {/* Card Resumo no Topo */}
                  {imoveisData.length > 0 && (
                    <div className="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white">
                      <div className="flex items-center justify-between">
                        <div>
                          <p className="text-orange-100 text-sm mb-1">Total de Imóveis</p>
                          <h4 className="text-4xl font-bold">{imoveisData.length}</h4>
                          <p className="text-orange-100 text-xs mt-1">imóve{imoveisData.length > 1 ? 'is' : 'l'} cadastrado{imoveisData.length > 1 ? 's' : ''}</p>
                        </div>
                        <div className="text-right">
                          <p className="text-orange-100 text-sm mb-1">Valor Total</p>
                          <h4 className="text-3xl font-bold">
                            R$ {imoveisData.reduce((acc, im) => {
                              const valor = im.valorEstimado ? parseFloat(im.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                              return acc + valor;
                            }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                          </h4>
                        </div>
                      </div>
                    </div>
                  )}

                  <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                    <div className="grid grid-cols-3 gap-3">
                      <select value={currentImovel.tipo} onChange={(e) => setCurrentImovel({...currentImovel, tipo: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg font-bold">
                        <option value="">Tipo de Imóvel</option>
                        <option>Casa</option>
                        <option>Apartamento</option>
                        <option>Loja</option>
                        <option>Galpão</option>
                        <option>Terreno</option>
                        <option>Outros</option>
                      </select>
                      <input type="text" placeholder="Endereço" value={currentImovel.endereco} onChange={(e) => setCurrentImovel({...currentImovel, endereco: e.target.value})} className="col-span-2 px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Cidade" value={currentImovel.cidade} onChange={(e) => setCurrentImovel({...currentImovel, cidade: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="UF" value={currentImovel.uf} onChange={(e) => setCurrentImovel({...currentImovel, uf: maskUF(e.target.value)})} className="px-3 py-2 border-2 border-purple-300 rounded-lg font-bold text-center" maxLength="2" />
                      <input type="text" placeholder="Área (m²)" value={currentImovel.areaM2} onChange={(e) => setCurrentImovel({...currentImovel, areaM2: maskAreaM2(e.target.value)})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Matrícula" value={currentImovel.matricula} onChange={(e) => setCurrentImovel({...currentImovel, matricula: e.target.value})} className="px-3 py-2 border-2 border-purple-300 rounded-lg" />
                      <input type="text" placeholder="Valor Estimado (R$)" value={currentImovel.valorEstimado} onChange={(e) => setCurrentImovel({...currentImovel, valorEstimado: maskValor(e.target.value)})} className="col-span-2 px-3 py-2 border-2 border-purple-300 rounded-lg" />
                    </div>
                    <button onClick={handleAddImovel} className="mt-3 w-full py-2 bg-purple-600 text-white rounded-lg font-semibold flex items-center justify-center gap-2">
                      <Plus size={18} /> Adicionar Imóvel
                    </button>
                  </div>
                  {imoveisData.length > 0 && (
                    <div className="bg-purple-50 p-4 rounded-lg">
                      <h4 className="font-bold mb-2">✅ Imóveis ({imoveisData.length})</h4>
                      {imoveisData.map((im, i) => (
                        <div key={im.id} className="flex justify-between items-center p-3 bg-white rounded mb-2 border border-purple-200">
                          <div className="flex-1">
                            <div className="flex items-center gap-3">
                              <span className="font-bold text-purple-900">
                                {i+1}. {im.tipo} - {im.endereco}
                              </span>
                              <span className="bg-purple-200 text-purple-900 px-2 py-0.5 rounded text-xs font-semibold">
                                {im.cidade}/{im.uf}
                              </span>
                            </div>
                            <div className="flex gap-4 text-sm text-purple-700 mt-1">
                              {im.areaM2 && <span>Área: {im.areaM2} m²</span>}
                              {im.matricula && <span>Matrícula: {im.matricula}</span>}
                              <span className="font-bold text-purple-900">Valor: R$ {im.valorEstimado}</span>
                            </div>
                          </div>
                          <div className="flex gap-2">
                            <button 
                              onClick={() => handleEditImovel(i)} 
                              className="text-blue-600 hover:bg-blue-50 p-2 rounded" 
                              title="Editar"
                            >
                              <Edit size={16} />
                            </button>
                            <button 
                              onClick={() => setImoveisData(imoveisData.filter((_, idx) => idx !== i))} 
                              className="text-red-600 hover:bg-red-50 p-2 rounded"
                              title="Excluir"
                            >
                              <Trash2 size={16} />
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {/* Botão Salvar da Etapa Imóveis */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Imóveis Urbanos')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Imóveis
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'producao' && (
                <div className="space-y-4 max-w-6xl">
                  <div className="flex items-center justify-between">
                    <h3 className="text-2xl font-bold text-emerald-900">🌾 Produção Agrícola e Pecuária</h3>
                  </div>
                    
                  {/* RESUMO CONSOLIDADO - CARDS POR CULTURA */}
                  <div className="grid grid-cols-4 gap-4 mb-6">
                    {/* CARD SOJA */}
                    {culturasData.filter(c => c.tipo === 'SOJA').length > 0 && (() => {
                      const sojaCadastrada = culturasData.find(c => c.tipo === 'SOJA');
                      return (
                        <div 
                          id="cultura-soja" 
                          onClick={() => {
                            setTimeout(() => {
                              const elemento = document.getElementById('secao-soja-cadastrada');
                              if (elemento) {
                                elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                              }
                            }, 100);
                          }}
                          className="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-400 rounded-lg p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                        >
                          <h4 className="font-bold text-green-900 mb-2 text-lg">🌱 SOJA</h4>
                          <p className="text-sm text-green-700 mb-1">{sojaCadastrada.hectares} hectares</p>
                          <div className="space-y-1 text-xs">
                            <div className="flex justify-between">
                              <span className="text-green-700">Bruto:</span>
                              <span className="font-semibold text-green-900">R$ {sojaCadastrada.receitaBruta}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-green-700">Líquido:</span>
                              <span className={`font-semibold ${sojaCadastrada.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {sojaCadastrada.lucroLiquido}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-green-700">Custo:</span>
                              <span className="font-semibold text-green-900">R$ {sojaCadastrada.custoTotal}</span>
                            </div>
                            <div className="bg-green-200 rounded px-2 py-1 mt-2">
                              <div className="flex justify-between items-center">
                                <span className="font-bold text-green-800">Margem:</span>
                                <span className="font-bold text-green-900 text-lg">{sojaCadastrada.margem}%</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      );
                    })()}

                    {/* CARD MILHO */}
                    {culturasData.filter(c => c.tipo === 'MILHO').length > 0 && (() => {
                      const milhoCadastrado = culturasData.find(c => c.tipo === 'MILHO');
                      return (
                        <div 
                          id="cultura-milho" 
                          onClick={() => {
                            setTimeout(() => {
                              const elemento = document.getElementById('secao-milho-cadastrado');
                              if (elemento) {
                                elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                              }
                            }, 100);
                          }}
                          className="bg-gradient-to-br from-yellow-50 to-yellow-100 border-2 border-yellow-400 rounded-lg p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                        >
                          <h4 className="font-bold text-yellow-900 mb-2 text-lg">🌽 MILHO</h4>
                          <p className="text-sm text-yellow-700 mb-1">{milhoCadastrado.hectares} hectares</p>
                          <div className="space-y-1 text-xs">
                            <div className="flex justify-between">
                              <span className="text-yellow-700">Bruto:</span>
                              <span className="font-semibold text-yellow-900">R$ {milhoCadastrado.receitaBruta}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-yellow-700">Líquido:</span>
                              <span className={`font-semibold ${milhoCadastrado.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {milhoCadastrado.lucroLiquido}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-yellow-700">Custo:</span>
                              <span className="font-semibold text-yellow-900">R$ {milhoCadastrado.custoTotal}</span>
                            </div>
                            <div className="bg-yellow-200 rounded px-2 py-1 mt-2">
                              <div className="flex justify-between items-center">
                                <span className="font-bold text-yellow-800">Margem:</span>
                                <span className="font-bold text-yellow-900 text-lg">{milhoCadastrado.margem}%</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      );
                    })()}

                    {/* CARDS OUTRAS CULTURAS */}
                    {culturasData.filter(c => c.tipo !== 'SOJA' && c.tipo !== 'MILHO').map(cultura => (
                      <div 
                        key={cultura.id} 
                        onClick={() => {
                          setTimeout(() => {
                            const secaoId = `cultura-${cultura.tipo.toLowerCase()}`;
                            const elemento = document.getElementById(secaoId);
                            if (elemento) {
                              elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                          }, 100);
                        }}
                        className="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-400 rounded-lg p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                      >
                        <h4 className="font-bold text-blue-900 mb-2 text-lg">🌾 {cultura.tipo}</h4>
                        <p className="text-sm text-blue-700 mb-1">{cultura.hectares} hectares</p>
                        <div className="space-y-1 text-xs">
                          <div className="flex justify-between">
                            <span className="text-blue-700">Bruto:</span>
                            <span className="font-semibold text-blue-900">R$ {cultura.receitaBruta}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-blue-700">Líquido:</span>
                            <span className={`font-semibold ${cultura.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {cultura.lucroLiquido}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-blue-700">Custo:</span>
                            <span className="font-semibold text-blue-900">R$ {cultura.custoTotal}</span>
                          </div>
                          <div className="bg-blue-200 rounded px-2 py-1 mt-2">
                            <div className="flex justify-between items-center">
                              <span className="font-bold text-blue-800">Margem:</span>
                              <span className="font-bold text-blue-900 text-lg">{cultura.margem}%</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}

                    {/* CARD FRUTICULTURA */}
                    {fruticultura.length > 0 && (
                      <div 
                        onClick={() => {
                          setTimeout(() => {
                            const elemento = document.getElementById('secao-fruticultura-cadastrada');
                            if (elemento) {
                              elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                          }, 100);
                        }}
                        className="bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-400 rounded-lg p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                      >
                        <h4 className="font-bold text-orange-900 mb-2 text-lg">🍌 FRUTICULTURA</h4>
                        <p className="text-sm text-orange-700 mb-1">{fruticultura.length} cultura{fruticultura.length > 1 ? 's' : ''}</p>
                        <div className="space-y-1 text-xs">
                          <div className="flex justify-between">
                            <span className="text-orange-700">Bruto:</span>
                            <span className="font-semibold text-orange-900">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                return acc + (unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.vendaKg));
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-orange-700">Líquido:</span>
                            <span className="font-semibold text-emerald-900">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                const receita = unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.vendaKg);
                                const custo = unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.custoKg);
                                return acc + (receita - custo);
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-orange-700">Custo:</span>
                            <span className="font-semibold text-orange-900">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                return acc + (unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.custoKg));
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </span>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* CARD PECUÁRIA */}
                    {producaoData.length > 0 && (
                      <div 
                        onClick={() => {
                          setTimeout(() => {
                            const elemento = document.getElementById('secao-fichas-sanitarias');
                            if (elemento) {
                              elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                          }, 100);
                        }}
                        className="bg-gradient-to-br from-emerald-50 to-emerald-100 border-2 border-emerald-400 rounded-lg p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                      >
                        <h4 className="font-bold text-emerald-900 mb-2 text-lg">🐄 PECUÁRIA</h4>
                        <p className="text-sm text-emerald-700 mb-1">
                          {producaoData.reduce((acc, ficha) => {
                            return acc + (
                              parseInt(ficha.bovideoMacho0a12 || 0) +
                              parseInt(ficha.bovideoFemea0a12 || 0) +
                              parseInt(ficha.bovideoMacho13a24 || 0) +
                              parseInt(ficha.bovideoFemea13a24 || 0) +
                              parseInt(ficha.bovideoMacho25a36 || 0) +
                              parseInt(ficha.bovideoFemea25a36 || 0) +
                              parseInt(ficha.bovideoMachoAcima36 || 0) +
                              parseInt(ficha.bovideoFemeaAcima36 || 0)
                            );
                          }, 0)} cabeças
                        </p>
                        <div className="space-y-1 text-xs">
                          <div className="flex justify-between">
                            <span className="text-emerald-700">Valor Rebanho:</span>
                            <span className="font-semibold text-emerald-900">
                              R$ {(() => {
                                const valorTotal = producaoData.reduce((acc, ficha) => {
                                  const calc = calcularValorRebanho(ficha, precoArroba);
                                  return acc + calc.totalValorNumerico;
                                }, 0);
                                return valorTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                              })()}
                            </span>
                          </div>
                          <div className="text-xs text-emerald-600 mt-1">
                            @ R$ {precoArroba}
                          </div>
                        </div>
                      </div>
                    )}
                  </div>

                  {/* ========== CULTURAS AGRÍCOLAS ========== */}
                  
                  {/* SOJA */}
                  <div className="bg-gradient-to-r from-green-50 to-green-100 border-2 border-green-400 rounded-lg p-4 mb-4">
                    <h4 className="font-bold text-green-900 mb-3 text-lg flex items-center gap-2">
                      🌱 SOJA
                    </h4>
                    
                    <div className="grid grid-cols-4 gap-3 mb-3">
                      <div>
                        <label className="block text-sm font-semibold text-green-900 mb-1">
                          Hectares
                        </label>
                        <input
                          type="text"
                          value={soja.hectares}
                          onChange={(e) => setSoja({...soja, hectares: e.target.value.replace(/[^\d]/g, '')})}
                          onBlur={(e) => setSoja({...soja, hectares: maskHectaresCultura(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-green-300 rounded-lg text-center font-bold text-lg text-green-700 focus:border-green-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-green-900 mb-1">
                          Preço/kg
                        </label>
                        <input
                          type="text"
                          value={soja.precoKg}
                          onChange={(e) => setSoja({...soja, precoKg: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-green-300 rounded-lg text-center font-bold text-lg text-green-700 focus:border-green-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-green-900 mb-1">
                          Sacas/ha
                        </label>
                        <input
                          type="text"
                          value={soja.sacasHa}
                          onChange={(e) => setSoja({...soja, sacasHa: maskSacas(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-green-300 rounded-lg text-center font-bold text-lg text-green-700 focus:border-green-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-green-900 mb-1">
                          Custo/ha
                        </label>
                        <input
                          type="text"
                          value={soja.custoHa}
                          onChange={(e) => setSoja({...soja, custoHa: maskCusto(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-green-300 rounded-lg text-center font-bold text-lg text-green-700 focus:border-green-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    {/* Cálculo em tempo real */}
                    {soja.hectares && soja.precoKg && soja.sacasHa && soja.custoHa && (
                      <div className="bg-white border-2 border-green-400 rounded-lg p-4 mb-3">
                        <p className="font-bold text-green-900 mb-3 text-center text-lg">📊 RESULTADO DO CÁLCULO</p>
                        
                        {/* Valores Digitados */}
                        <div className="bg-green-50 border border-green-300 rounded-lg p-3 mb-3">
                          <div className="grid grid-cols-4 gap-4 text-center">
                            <div>
                              <p className="text-xs text-green-700 mb-1">Hectares</p>
                              <p className="font-bold text-green-900">{soja.hectares}</p>
                            </div>
                            <div>
                              <p className="text-xs text-green-700 mb-1">Preço/kg</p>
                              <p className="font-bold text-green-900">R$ {soja.precoKg}</p>
                            </div>
                            <div>
                              <p className="text-xs text-green-700 mb-1">Sacas/ha</p>
                              <p className="font-bold text-green-900">{soja.sacasHa}</p>
                            </div>
                            <div>
                              <p className="text-xs text-green-700 mb-1">Custo/ha</p>
                              <p className="font-bold text-green-900">R$ {soja.custoHa}</p>
                            </div>
                          </div>
                        </div>

                        {(() => {
                          const calc = calcularProducao(soja.hectares, soja.sacasHa, soja.precoKg, soja.custoHa);
                          return (
                            <div className="space-y-2">
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Produção Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">{calc.producaoTon} ton</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Receita Bruta:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.receitaBruta}</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Custo Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.custoTotal}</span>
                                </div>
                              </div>
                              <div className={`p-3 rounded-lg ${calc.lucroPositivo ? 'bg-emerald-100 border-2 border-emerald-400' : 'bg-red-100 border-2 border-red-400'}`}>
                                <div className="flex justify-between items-center">
                                  <span className={`font-semibold ${calc.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>💰 Lucro Líquido:</span>
                                  <span className={`font-bold text-2xl ${calc.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {calc.lucroLiquido}</span>
                                </div>
                              </div>
                              <div className="bg-blue-100 border-2 border-blue-400 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="font-semibold text-blue-700">📈 Margem de Lucro:</span>
                                  <span className="font-bold text-blue-900 text-2xl">{calc.margem}%</span>
                                </div>
                              </div>
                            </div>
                          );
                        })()}
                      </div>
                    )}

                    <button 
                      onClick={handleAddSoja}
                      className="w-full py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg font-bold flex items-center justify-center gap-2 shadow-lg hover:from-green-700 hover:to-green-800"
                    >
                      <Plus size={20} /> Adicionar Soja
                    </button>

                    {/* Lista de Soja Cadastrada */}
                    {culturasData.filter(c => c.tipo === 'SOJA').length > 0 && (
                      <div id="secao-soja-cadastrada" className="mt-3 bg-white border-2 border-green-300 rounded-lg p-3">
                        <p className="font-bold text-green-900 mb-2">✅ Soja Cadastrada:</p>
                        {culturasData.filter(c => c.tipo === 'SOJA').map(cultura => (
                          <div key={cultura.id} className="bg-green-50 border border-green-300 px-4 py-3 rounded-lg mb-3">
                            <div className="flex justify-between items-center mb-3">
                              <span className="font-bold text-green-900 text-xl">🌱 Soja</span>
                              <div className="flex gap-2">
                                <button 
                                  onClick={() => {
                                    setSoja({
                                      hectares: cultura.hectares,
                                      precoKg: cultura.precoKg,
                                      sacasHa: cultura.sacasHa,
                                      custoHa: cultura.custoHa
                                    });
                                    handleRemoveCultura(cultura.id);
                                    alert('✏️ Cultura carregada para edição!');
                                  }}
                                  className="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-1"
                                >
                                  <Edit2 size={16} /> Editar
                                </button>
                                <button 
                                  onClick={() => handleRemoveCultura(cultura.id)}
                                  className="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-1"
                                >
                                  <Trash2 size={16} /> Excluir
                                </button>
                              </div>
                            </div>

                            {/* Valores Cadastrados */}
                            <div className="bg-white border border-green-300 rounded-lg p-3 mb-3">
                              <p className="text-xs font-semibold text-green-800 mb-2">📋 DADOS CADASTRADOS:</p>
                              <div className="grid grid-cols-4 gap-3 text-sm">
                                <div className="text-center">
                                  <p className="text-xs text-green-700">Hectares</p>
                                  <p className="font-bold text-green-900">{cultura.hectares}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-green-700">Preço/kg</p>
                                  <p className="font-bold text-green-900">R$ {cultura.precoKg}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-green-700">Sacas/ha</p>
                                  <p className="font-bold text-green-900">{cultura.sacasHa}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-green-700">Custo/ha</p>
                                  <p className="font-bold text-green-900">R$ {cultura.custoHa}</p>
                                </div>
                              </div>
                            </div>

                            {/* Resultados */}
                            <div className="grid grid-cols-3 gap-2 text-sm">
                              <div className="bg-white p-2 rounded border border-green-200">
                                <span className="text-green-700 text-xs">Produção:</span>
                                <p className="font-bold text-green-900">{cultura.producaoTon} ton</p>
                              </div>
                              <div className="bg-white p-2 rounded border border-green-200">
                                <span className="text-green-700 text-xs">Receita:</span>
                                <p className="font-bold text-green-900">R$ {cultura.receitaBruta}</p>
                              </div>
                              <div className={`p-2 rounded border-2 ${cultura.lucroPositivo ? 'bg-emerald-50 border-emerald-400' : 'bg-red-50 border-red-400'}`}>
                                <span className={`text-xs ${cultura.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>Lucro:</span>
                                <p className={`font-bold text-lg ${cultura.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {cultura.lucroLiquido}</p>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>

                  {/* MILHO */}
                  <div className="bg-gradient-to-r from-yellow-50 to-yellow-100 border-2 border-yellow-400 rounded-lg p-4 mb-4">
                    <h4 className="font-bold text-yellow-900 mb-3 text-lg flex items-center gap-2">
                      🌽 MILHO
                    </h4>
                    
                    <div className="grid grid-cols-4 gap-3 mb-3">
                      <div>
                        <label className="block text-sm font-semibold text-yellow-900 mb-1">
                          Hectares
                        </label>
                        <input
                          type="text"
                          value={milho.hectares}
                          onChange={(e) => setMilho({...milho, hectares: e.target.value.replace(/[^\d]/g, '')})}
                          onBlur={(e) => setMilho({...milho, hectares: maskHectaresCultura(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-yellow-300 rounded-lg text-center font-bold text-lg text-yellow-700 focus:border-yellow-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-yellow-900 mb-1">
                          Preço/kg
                        </label>
                        <input
                          type="text"
                          value={milho.precoKg}
                          onChange={(e) => setMilho({...milho, precoKg: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-yellow-300 rounded-lg text-center font-bold text-lg text-yellow-700 focus:border-yellow-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-yellow-900 mb-1">
                          Sacas/ha
                        </label>
                        <input
                          type="text"
                          value={milho.sacasHa}
                          onChange={(e) => setMilho({...milho, sacasHa: maskSacas(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-yellow-300 rounded-lg text-center font-bold text-lg text-yellow-700 focus:border-yellow-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-yellow-900 mb-1">
                          Custo/ha
                        </label>
                        <input
                          type="text"
                          value={milho.custoHa}
                          onChange={(e) => setMilho({...milho, custoHa: maskCusto(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-yellow-300 rounded-lg text-center font-bold text-lg text-yellow-700 focus:border-yellow-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    {/* Cálculo em tempo real */}
                    {milho.hectares && milho.precoKg && milho.sacasHa && milho.custoHa && (
                      <div className="bg-white border-2 border-yellow-400 rounded-lg p-4 mb-3">
                        <p className="font-bold text-yellow-900 mb-3 text-center text-lg">📊 RESULTADO DO CÁLCULO</p>
                        
                        {/* Valores Digitados */}
                        <div className="bg-yellow-50 border border-yellow-300 rounded-lg p-3 mb-3">
                          <div className="grid grid-cols-4 gap-4 text-center">
                            <div>
                              <p className="text-xs text-yellow-700 mb-1">Hectares</p>
                              <p className="font-bold text-yellow-900">{milho.hectares}</p>
                            </div>
                            <div>
                              <p className="text-xs text-yellow-700 mb-1">Preço/kg</p>
                              <p className="font-bold text-yellow-900">R$ {milho.precoKg}</p>
                            </div>
                            <div>
                              <p className="text-xs text-yellow-700 mb-1">Sacas/ha</p>
                              <p className="font-bold text-yellow-900">{milho.sacasHa}</p>
                            </div>
                            <div>
                              <p className="text-xs text-yellow-700 mb-1">Custo/ha</p>
                              <p className="font-bold text-yellow-900">R$ {milho.custoHa}</p>
                            </div>
                          </div>
                        </div>

                        {(() => {
                          const calc = calcularProducao(milho.hectares, milho.sacasHa, milho.precoKg, milho.custoHa);
                          return (
                            <div className="space-y-2">
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Produção Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">{calc.producaoTon} ton</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Receita Bruta:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.receitaBruta}</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Custo Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.custoTotal}</span>
                                </div>
                              </div>
                              <div className={`p-3 rounded-lg ${calc.lucroPositivo ? 'bg-emerald-100 border-2 border-emerald-400' : 'bg-red-100 border-2 border-red-400'}`}>
                                <div className="flex justify-between items-center">
                                  <span className={`font-semibold ${calc.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>💰 Lucro Líquido:</span>
                                  <span className={`font-bold text-2xl ${calc.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {calc.lucroLiquido}</span>
                                </div>
                              </div>
                              <div className="bg-blue-100 border-2 border-blue-400 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="font-semibold text-blue-700">📈 Margem de Lucro:</span>
                                  <span className="font-bold text-blue-900 text-2xl">{calc.margem}%</span>
                                </div>
                              </div>
                            </div>
                          );
                        })()}
                      </div>
                    )}

                    <button 
                      onClick={handleAddMilho}
                      className="w-full py-3 bg-gradient-to-r from-yellow-600 to-yellow-700 text-white rounded-lg font-bold flex items-center justify-center gap-2 shadow-lg hover:from-yellow-700 hover:to-yellow-800"
                    >
                      <Plus size={20} /> Adicionar Milho
                    </button>

                    {/* Lista de Milho Cadastrado */}
                    {culturasData.filter(c => c.tipo === 'MILHO').length > 0 && (
                      <div id="secao-milho-cadastrado" className="mt-3 bg-white border-2 border-yellow-300 rounded-lg p-3">
                        <p className="font-bold text-yellow-900 mb-2">✅ Milho Cadastrado:</p>
                        {culturasData.filter(c => c.tipo === 'MILHO').map(cultura => (
                          <div key={cultura.id} className="bg-yellow-50 border border-yellow-300 px-4 py-3 rounded-lg mb-3">
                            <div className="flex justify-between items-center mb-3">
                              <span className="font-bold text-yellow-900 text-xl">🌽 Milho</span>
                              <div className="flex gap-2">
                                <button 
                                  onClick={() => {
                                    setMilho({
                                      hectares: cultura.hectares,
                                      precoKg: cultura.precoKg,
                                      sacasHa: cultura.sacasHa,
                                      custoHa: cultura.custoHa
                                    });
                                    handleRemoveCultura(cultura.id);
                                    alert('✏️ Cultura carregada para edição!');
                                  }}
                                  className="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-1"
                                >
                                  <Edit2 size={16} /> Editar
                                </button>
                                <button 
                                  onClick={() => handleRemoveCultura(cultura.id)}
                                  className="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-1"
                                >
                                  <Trash2 size={16} /> Excluir
                                </button>
                              </div>
                            </div>

                            {/* Valores Cadastrados */}
                            <div className="bg-white border border-yellow-300 rounded-lg p-3 mb-3">
                              <p className="text-xs font-semibold text-yellow-800 mb-2">📋 DADOS CADASTRADOS:</p>
                              <div className="grid grid-cols-4 gap-3 text-sm">
                                <div className="text-center">
                                  <p className="text-xs text-yellow-700">Hectares</p>
                                  <p className="font-bold text-yellow-900">{cultura.hectares}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-yellow-700">Preço/kg</p>
                                  <p className="font-bold text-yellow-900">R$ {cultura.precoKg}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-yellow-700">Sacas/ha</p>
                                  <p className="font-bold text-yellow-900">{cultura.sacasHa}</p>
                                </div>
                                <div className="text-center">
                                  <p className="text-xs text-yellow-700">Custo/ha</p>
                                  <p className="font-bold text-yellow-900">R$ {cultura.custoHa}</p>
                                </div>
                              </div>
                            </div>

                            {/* Resultados */}
                            <div className="grid grid-cols-3 gap-2 text-sm">
                              <div className="bg-white p-2 rounded border border-yellow-200">
                                <span className="text-yellow-700 text-xs">Produção:</span>
                                <p className="font-bold text-yellow-900">{cultura.producaoTon} ton</p>
                              </div>
                              <div className="bg-white p-2 rounded border border-yellow-200">
                                <span className="text-yellow-700 text-xs">Receita:</span>
                                <p className="font-bold text-yellow-900">R$ {cultura.receitaBruta}</p>
                              </div>
                              <div className={`p-2 rounded border-2 ${cultura.lucroPositivo ? 'bg-emerald-50 border-emerald-400' : 'bg-red-50 border-red-400'}`}>
                                <span className={`text-xs ${cultura.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>Lucro:</span>
                                <p className={`font-bold text-lg ${cultura.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {cultura.lucroLiquido}</p>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>

                  {/* OUTRAS CULTURAS */}
                  <div className="bg-gradient-to-r from-blue-50 to-blue-100 border-2 border-blue-400 rounded-lg p-4 mb-6">
                    <h4 className="font-bold text-blue-900 mb-3 text-lg flex items-center gap-2">
                      ➕ OUTRAS CULTURAS
                    </h4>
                    
                    <div className="grid grid-cols-5 gap-3 mb-3">
                      <div>
                        <label className="block text-sm font-semibold text-blue-900 mb-1">
                          Nome da Cultura
                        </label>
                        <input
                          type="text"
                          value={currentCultura.tipo}
                          onChange={(e) => setCurrentCultura({...currentCultura, tipo: e.target.value.toUpperCase()})}
                          placeholder="Ex: ALGODÃO"
                          className="w-full px-3 py-2 border-2 border-blue-300 rounded-lg font-semibold text-blue-700 focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-blue-900 mb-1">
                          Hectares
                        </label>
                        <input
                          type="text"
                          value={currentCultura.hectares}
                          onChange={(e) => setCurrentCultura({...currentCultura, hectares: e.target.value.replace(/[^\d]/g, '')})}
                          onBlur={(e) => setCurrentCultura({...currentCultura, hectares: maskHectaresCultura(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-blue-300 rounded-lg text-center font-bold text-lg text-blue-700 focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-blue-900 mb-1">
                          Preço/kg
                        </label>
                        <input
                          type="text"
                          value={currentCultura.precoKg}
                          onChange={(e) => setCurrentCultura({...currentCultura, precoKg: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-blue-300 rounded-lg text-center font-bold text-lg text-blue-700 focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-blue-900 mb-1">
                          Sacas/ha
                        </label>
                        <input
                          type="text"
                          value={currentCultura.sacasHa}
                          onChange={(e) => setCurrentCultura({...currentCultura, sacasHa: maskSacas(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-blue-300 rounded-lg text-center font-bold text-lg text-blue-700 focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-blue-900 mb-1">
                          Custo/ha
                        </label>
                        <input
                          type="text"
                          value={currentCultura.custoHa}
                          onChange={(e) => setCurrentCultura({...currentCultura, custoHa: maskCusto(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-blue-300 rounded-lg text-center font-bold text-lg text-blue-700 focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    {/* Cálculo em tempo real */}
                    {currentCultura.hectares && currentCultura.precoKg && currentCultura.sacasHa && currentCultura.custoHa && (
                      <div className="bg-white border-2 border-blue-400 rounded-lg p-4 mb-3">
                        <p className="font-bold text-blue-900 mb-3 text-center text-lg">📊 RESULTADO DO CÁLCULO</p>
                        
                        {/* Valores Digitados */}
                        <div className="bg-blue-50 border border-blue-300 rounded-lg p-3 mb-3">
                          <div className="grid grid-cols-4 gap-4 text-center">
                            <div>
                              <p className="text-xs text-blue-700 mb-1">Hectares</p>
                              <p className="font-bold text-blue-900">{currentCultura.hectares}</p>
                            </div>
                            <div>
                              <p className="text-xs text-blue-700 mb-1">Preço/kg</p>
                              <p className="font-bold text-blue-900">R$ {currentCultura.precoKg}</p>
                            </div>
                            <div>
                              <p className="text-xs text-blue-700 mb-1">Sacas/ha</p>
                              <p className="font-bold text-blue-900">{currentCultura.sacasHa}</p>
                            </div>
                            <div>
                              <p className="text-xs text-blue-700 mb-1">Custo/ha</p>
                              <p className="font-bold text-blue-900">R$ {currentCultura.custoHa}</p>
                            </div>
                          </div>
                        </div>

                        {(() => {
                          const calc = calcularProducao(currentCultura.hectares, currentCultura.sacasHa, currentCultura.precoKg, currentCultura.custoHa);
                          return (
                            <div className="space-y-2">
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Produção Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">{calc.producaoTon} ton</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Receita Bruta:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.receitaBruta}</span>
                                </div>
                              </div>
                              <div className="bg-slate-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-slate-700">Custo Total:</span>
                                  <span className="font-bold text-slate-900 text-lg">R$ {calc.custoTotal}</span>
                                </div>
                              </div>
                              <div className={`p-3 rounded-lg ${calc.lucroPositivo ? 'bg-emerald-100 border-2 border-emerald-400' : 'bg-red-100 border-2 border-red-400'}`}>
                                <div className="flex justify-between items-center">
                                  <span className={`font-semibold ${calc.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>💰 Lucro Líquido:</span>
                                  <span className={`font-bold text-2xl ${calc.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {calc.lucroLiquido}</span>
                                </div>
                              </div>
                              <div className="bg-blue-100 border-2 border-blue-400 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="font-semibold text-blue-700">📈 Margem de Lucro:</span>
                                  <span className="font-bold text-blue-900 text-2xl">{calc.margem}%</span>
                                </div>
                              </div>
                            </div>
                          );
                        })()}
                      </div>
                    )}

                    <button 
                      onClick={handleAddOutraCultura}
                      className="w-full py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-bold flex items-center justify-center gap-2 shadow-lg hover:from-blue-700 hover:to-blue-800"
                    >
                      <Plus size={20} /> Adicionar Cultura
                    </button>

                    {/* Lista de Outras Culturas Cadastradas */}
                    {culturasData.filter(c => c.tipo !== 'SOJA' && c.tipo !== 'MILHO').length > 0 && (
                      <div className="mt-4 bg-white border-2 border-blue-300 rounded-lg p-3">
                        <p className="font-bold text-blue-900 mb-3">✅ Outras Culturas Cadastradas:</p>
                        <div className="space-y-3">
                          {culturasData.filter(c => c.tipo !== 'SOJA' && c.tipo !== 'MILHO').map(cultura => (
                            <div key={cultura.id} className="bg-blue-50 border border-blue-300 px-4 py-3 rounded-lg">
                              <div className="flex justify-between items-center mb-3">
                                <span className="font-bold text-blue-900 text-xl">{cultura.tipo}</span>
                                <div className="flex gap-2">
                                  <button 
                                    onClick={() => {
                                      setCurrentCultura({
                                        tipo: cultura.tipo,
                                        hectares: cultura.hectares,
                                        precoKg: cultura.precoKg,
                                        sacasHa: cultura.sacasHa,
                                        custoHa: cultura.custoHa
                                      });
                                      handleRemoveCultura(cultura.id);
                                      alert('✏️ Cultura carregada para edição!');
                                    }}
                                    className="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-1"
                                  >
                                    <Edit2 size={16} /> Editar
                                  </button>
                                  <button 
                                    onClick={() => handleRemoveCultura(cultura.id)}
                                    className="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-1"
                                  >
                                    <Trash2 size={16} /> Excluir
                                  </button>
                                </div>
                              </div>

                              {/* Valores Cadastrados */}
                              <div className="bg-white border border-blue-300 rounded-lg p-3 mb-3">
                                <p className="text-xs font-semibold text-blue-800 mb-2">📋 DADOS CADASTRADOS:</p>
                                <div className="grid grid-cols-4 gap-3 text-sm">
                                  <div className="text-center">
                                    <p className="text-xs text-blue-700">Hectares</p>
                                    <p className="font-bold text-blue-900">{cultura.hectares}</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-xs text-blue-700">Preço/kg</p>
                                    <p className="font-bold text-blue-900">R$ {cultura.precoKg}</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-xs text-blue-700">Sacas/ha</p>
                                    <p className="font-bold text-blue-900">{cultura.sacasHa}</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-xs text-blue-700">Custo/ha</p>
                                    <p className="font-bold text-blue-900">R$ {cultura.custoHa}</p>
                                  </div>
                                </div>
                              </div>

                              {/* Resultados */}
                              <div className="grid grid-cols-3 gap-2 text-sm">
                                <div className="bg-white p-2 rounded border border-blue-200">
                                  <span className="text-blue-700 text-xs">Produção:</span>
                                  <p className="font-bold text-blue-900">{cultura.producaoTon} ton</p>
                                </div>
                                <div className="bg-white p-2 rounded border border-blue-200">
                                  <span className="text-blue-700 text-xs">Receita:</span>
                                  <p className="font-bold text-blue-900">R$ {cultura.receitaBruta}</p>
                                </div>
                                <div className={`p-2 rounded border-2 ${cultura.lucroPositivo ? 'bg-emerald-50 border-emerald-400' : 'bg-red-50 border-red-400'}`}>
                                  <span className={`text-xs ${cultura.lucroPositivo ? 'text-emerald-700' : 'text-red-700'}`}>Lucro:</span>
                                  <p className={`font-bold text-lg ${cultura.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>R$ {cultura.lucroLiquido}</p>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>

                  {/* FRUTICULTURA */}
                  <div className="bg-gradient-to-r from-orange-50 to-orange-100 border-2 border-orange-400 rounded-lg p-4 mb-6">
                    <h4 className="font-bold text-orange-900 mb-3 text-lg flex items-center gap-2">
                      🍌 FRUTICULTURA
                    </h4>
                    
                    <div className="grid grid-cols-5 gap-3 mb-3">
                      <div>
                        <label className="block text-sm font-semibold text-orange-900 mb-1">
                          Cultura
                        </label>
                        <input
                          type="text"
                          value={currentFruticultura.cultura}
                          onChange={(e) => setCurrentFruticultura({...currentFruticultura, cultura: e.target.value.toUpperCase()})}
                          placeholder="Ex: BANANA"
                          className="w-full px-3 py-2 border-2 border-orange-300 rounded-lg font-semibold text-orange-700 focus:border-orange-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-orange-900 mb-1">
                          Hectares
                        </label>
                        <input
                          type="text"
                          value={currentFruticultura.hectares}
                          onChange={(e) => setCurrentFruticultura({...currentFruticultura, hectares: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-orange-300 rounded-lg text-center font-bold text-lg text-orange-700 focus:border-orange-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-orange-900 mb-1">
                          Kilos/ha
                        </label>
                        <input
                          type="text"
                          value={currentFruticultura.kilosHa}
                          onChange={(e) => setCurrentFruticultura({...currentFruticultura, kilosHa: e.target.value.replace(/[^\d,]/g, '')})}
                          onBlur={(e) => {
                            let valor = e.target.value;
                            if (valor && !valor.includes(',')) {
                              valor = valor + ',00';
                            } else if (valor && valor.includes(',')) {
                              const parts = valor.split(',');
                              if (parts[1].length === 1) valor = parts[0] + ',' + parts[1] + '0';
                              if (parts[1].length === 0) valor = parts[0] + ',00';
                            }
                            setCurrentFruticultura({...currentFruticultura, kilosHa: valor});
                          }}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-orange-300 rounded-lg text-center font-bold text-lg text-orange-700 focus:border-orange-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-orange-900 mb-1">
                          Venda/kg (R$)
                        </label>
                        <input
                          type="text"
                          value={currentFruticultura.vendaKg}
                          onChange={(e) => setCurrentFruticultura({...currentFruticultura, vendaKg: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-orange-300 rounded-lg text-center font-bold text-lg text-orange-700 focus:border-orange-500 focus:outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-orange-900 mb-1">
                          Custo/kg (R$)
                        </label>
                        <input
                          type="text"
                          value={currentFruticultura.custoKg}
                          onChange={(e) => setCurrentFruticultura({...currentFruticultura, custoKg: maskPreco(e.target.value)})}
                          placeholder="0,00"
                          className="w-full px-3 py-2 border-2 border-orange-300 rounded-lg text-center font-bold text-lg text-orange-700 focus:border-orange-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    <button
                      onClick={handleAddFruticultura}
                      className="w-full px-4 py-3 bg-orange-500 text-white rounded-lg font-bold hover:bg-orange-600 transition-colors flex items-center justify-center gap-2"
                    >
                      <Plus size={20} />
                      {editingFrutIndex !== null ? 'Atualizar Cultura' : 'Adicionar Cultura'}
                    </button>
                  </div>

                  {/* Lista de Fruticultura Cadastrada NO TOPO */}
                  {fruticultura.length > 0 && (
                    <div id="secao-fruticultura-cadastrada" className="bg-white rounded-lg border-2 border-orange-300 p-4 mb-6">
                      <div className="flex items-center justify-between mb-4">
                        <h4 className="font-bold text-orange-900 text-lg">📊 Fruticultura Cadastrada</h4>
                      </div>

                      <div className="space-y-3 mb-4">
                        {fruticultura.map((cultura) => {
                          const unmask = (valor) => {
                            if (!valor) return 0;
                            return parseFloat(valor.replace(',', '.'));
                          };

                          const ha = unmask(cultura.hectares);
                          const kilosHa = unmask(cultura.kilosHa);
                          const vendaKg = unmask(cultura.vendaKg);
                          const custoKg = unmask(cultura.custoKg);
                          
                          const receitaBruta = ha * kilosHa * vendaKg;
                          const custoTotal = ha * kilosHa * custoKg;
                          const lucroLiquido = receitaBruta - custoTotal;

                          return (
                            <div key={cultura.id} className="bg-orange-50 border border-orange-200 rounded-lg p-4">
                              <div className="flex items-start justify-between mb-3">
                                <div>
                                  <h5 className="font-bold text-orange-900 text-lg">{cultura.cultura}</h5>
                                  <p className="text-sm text-orange-700">
                                    {cultura.hectares} ha × {cultura.kilosHa} kg/ha
                                  </p>
                                </div>
                                <div className="flex gap-2">
                                  <button
                                    onClick={() => {
                                      setCurrentFruticultura(cultura);
                                      setEditingFrutIndex(fruticultura.indexOf(cultura));
                                    }}
                                    className="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-1"
                                  >
                                    <Edit2 size={16} /> Editar
                                  </button>
                                  <button
                                    onClick={() => handleRemoveFruticultura(cultura.id)}
                                    className="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-1"
                                  >
                                    <Trash2 size={16} /> Excluir
                                  </button>
                                </div>
                              </div>

                              <div className="grid grid-cols-4 gap-3">
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <p className="text-xs text-orange-700 mb-1">Preço Venda</p>
                                  <p className="font-bold text-orange-900">R$ {cultura.vendaKg}/kg</p>
                                </div>
                                <div className="bg-emerald-100 rounded-lg p-3 border border-emerald-300">
                                  <p className="text-xs text-emerald-700 mb-1">Receita Bruta</p>
                                  <p className="font-bold text-emerald-900">R$ {receitaBruta.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</p>
                                </div>
                                <div className="bg-red-100 rounded-lg p-3 border border-red-300">
                                  <p className="text-xs text-red-700 mb-1">Custo Total</p>
                                  <p className="font-bold text-red-900">R$ {custoTotal.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</p>
                                </div>
                                <div className={`rounded-lg p-3 border ${lucroLiquido >= 0 ? 'bg-green-100 border-green-300' : 'bg-red-100 border-red-300'}`}>
                                  <p className={`text-xs mb-1 ${lucroLiquido >= 0 ? 'text-green-700' : 'text-red-700'}`}>Lucro Líquido</p>
                                  <p className={`font-bold ${lucroLiquido >= 0 ? 'text-green-900' : 'text-red-900'}`}>
                                    R$ {lucroLiquido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                                  </p>
                                </div>
                              </div>
                            </div>
                          );
                        })}
                      </div>

                      <div className="bg-gradient-to-r from-orange-600 to-orange-700 rounded-lg p-4 text-white">
                        <h5 className="font-bold text-lg mb-3">💰 TOTAIS GERAIS</h5>
                        <div className="grid grid-cols-3 gap-4">
                          <div>
                            <p className="text-orange-200 text-sm mb-1">Receita Bruta Total</p>
                            <p className="text-2xl font-bold">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                return acc + (unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.vendaKg));
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </p>
                          </div>
                          <div>
                            <p className="text-orange-200 text-sm mb-1">Custo Total</p>
                            <p className="text-2xl font-bold">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                return acc + (unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.custoKg));
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </p>
                          </div>
                          <div>
                            <p className="text-orange-200 text-sm mb-1">Lucro Líquido Total</p>
                            <p className="text-2xl font-bold">
                              R$ {fruticultura.reduce((acc, c) => {
                                const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                                const receita = unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.vendaKg);
                                const custo = unmask(c.hectares) * unmask(c.kilosHa) * unmask(c.custoKg);
                                return acc + (receita - custo);
                              }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* ========== PECUÁRIA - FICHA SANITÁRIA ========== */}
                  <div className="bg-gradient-to-r from-amber-50 to-amber-100 border-2 border-amber-400 rounded-lg p-4 mb-4">
                    <h4 className="font-bold text-amber-900 mb-3 text-xl flex items-center gap-2">
                      🐄 PECUÁRIA - FICHA SANITÁRIA
                    </h4>
                    {producaoData.length > 0 && (
                      <div className="bg-emerald-100 border-2 border-emerald-300 rounded-lg px-4 py-2 mb-4">
                        <p className="text-sm text-emerald-700">Total Geral:</p>
                        <p className="text-2xl font-bold text-emerald-900">
                          {producaoData.reduce((acc, ficha) => {
                            return acc + (
                              parseInt(ficha.bovideoMacho0a12 || 0) +
                              parseInt(ficha.bovideoFemea0a12 || 0) +
                              parseInt(ficha.bovideoMacho13a24 || 0) +
                              parseInt(ficha.bovideoFemea13a24 || 0) +
                              parseInt(ficha.bovideoMacho25a36 || 0) +
                              parseInt(ficha.bovideoFemea25a36 || 0) +
                              parseInt(ficha.bovideoMachoAcima36 || 0) +
                              parseInt(ficha.bovideoFemeaAcima36 || 0)
                            );
                          }, 0)} <span className="text-sm font-normal">animais</span>
                        </p>
                        <p className="text-xs text-emerald-600">{producaoData.length} ficha{producaoData.length > 1 ? 's' : ''}</p>
                        <div className="mt-2 pt-2 border-t-2 border-emerald-400">
                          <p className="text-sm text-emerald-700">Valor Total do Rebanho:</p>
                          <p className="text-2xl font-bold text-emerald-900">
                            R$ {producaoData.reduce((acc, pr) => acc + (pr.valorRebanho || 0), 0).toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                          </p>
                        </div>
                      </div>
                    )}
                  </div>
                  
                  {/* Formulário para adicionar nova ficha */}
                  <div className="bg-amber-50 border-2 border-amber-400 rounded-lg p-4">
                    <h4 className="font-bold text-amber-900 mb-4 text-lg">🐂 Bovídeos - Nova Ficha</h4>
                    
                    {/* Labels das colunas */}
                    <div className="grid grid-cols-8 gap-2 mb-2">
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Macho</p>
                        <p>0-12 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Fêmea</p>
                        <p>0-12 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Macho</p>
                        <p>13-24 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Fêmea</p>
                        <p>13-24 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Macho</p>
                        <p>25-36 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Fêmea</p>
                        <p>25-36 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Macho</p>
                        <p>>36 meses</p>
                      </div>
                      <div className="text-center text-xs font-bold text-amber-900">
                        <p>Fêmea</p>
                        <p>>36 meses</p>
                      </div>
                    </div>

                    {/* Inputs */}
                    <div className="grid grid-cols-8 gap-2 mb-3">
                      <input type="number" value={currentProducao.bovideoMacho0a12} onChange={(e) => setCurrentProducao({...currentProducao, bovideoMacho0a12: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoFemea0a12} onChange={(e) => setCurrentProducao({...currentProducao, bovideoFemea0a12: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoMacho13a24} onChange={(e) => setCurrentProducao({...currentProducao, bovideoMacho13a24: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoFemea13a24} onChange={(e) => setCurrentProducao({...currentProducao, bovideoFemea13a24: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoMacho25a36} onChange={(e) => setCurrentProducao({...currentProducao, bovideoMacho25a36: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoFemea25a36} onChange={(e) => setCurrentProducao({...currentProducao, bovideoFemea25a36: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoMachoAcima36} onChange={(e) => setCurrentProducao({...currentProducao, bovideoMachoAcima36: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                      <input type="number" value={currentProducao.bovideoFemeaAcima36} onChange={(e) => setCurrentProducao({...currentProducao, bovideoFemeaAcima36: e.target.value})} className="px-2 py-3 border-2 border-amber-300 rounded text-center font-bold text-lg" placeholder="0" />
                    </div>

                    {/* Total desta ficha */}
                    <div className="bg-amber-200 border-2 border-amber-500 rounded-lg p-3 mb-3">
                      <p className="text-center text-xl font-bold text-amber-900">
                        Total desta ficha: {
                          (parseInt(currentProducao.bovideoMacho0a12 || 0) +
                          parseInt(currentProducao.bovideoFemea0a12 || 0) +
                          parseInt(currentProducao.bovideoMacho13a24 || 0) +
                          parseInt(currentProducao.bovideoFemea13a24 || 0) +
                          parseInt(currentProducao.bovideoMacho25a36 || 0) +
                          parseInt(currentProducao.bovideoFemea25a36 || 0) +
                          parseInt(currentProducao.bovideoMachoAcima36 || 0) +
                          parseInt(currentProducao.bovideoFemeaAcima36 || 0))
                        } animais
                      </p>
                    </div>

                    {/* VALORIZAÇÃO DO REBANHO */}
                    {((parseInt(currentProducao.bovideoMacho0a12 || 0) +
                       parseInt(currentProducao.bovideoFemea0a12 || 0) +
                       parseInt(currentProducao.bovideoMacho13a24 || 0) +
                       parseInt(currentProducao.bovideoFemea13a24 || 0) +
                       parseInt(currentProducao.bovideoMacho25a36 || 0) +
                       parseInt(currentProducao.bovideoFemea25a36 || 0) +
                       parseInt(currentProducao.bovideoMachoAcima36 || 0) +
                       parseInt(currentProducao.bovideoFemeaAcima36 || 0)) > 0) && (
                      <div className="bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-emerald-400 rounded-lg p-4 mb-3">
                        <div className="flex items-center justify-between mb-3">
                          <h5 className="font-bold text-emerald-900 text-lg">💰 VALORIZAÇÃO DO REBANHO</h5>
                          <div className="flex items-center gap-2">
                            <label className="text-sm font-semibold text-emerald-900">Preço @:</label>
                            <input
                              type="text"
                              value={precoArroba}
                              onChange={(e) => setPrecoArroba(e.target.value.replace(/[^\d,]/g, ''))}
                              className="w-28 px-3 py-2 border-2 border-emerald-400 rounded-lg text-center font-bold text-emerald-900"
                              placeholder="310,00"
                            />
                          </div>
                        </div>

                        {(() => {
                          const calc = calcularValorRebanho(currentProducao, precoArroba);
                          return (
                            <div className="space-y-2">
                              {calc.qtd0a12 > 0 && (
                                <div className="bg-white p-3 rounded-lg">
                                  <div className="flex justify-between items-center">
                                    <div>
                                      <span className="font-semibold text-slate-700">0-12 meses</span>
                                      <span className="text-slate-600 text-sm ml-2">({calc.qtd0a12} animais × 14@)</span>
                                    </div>
                                    <div className="text-right">
                                      <p className="text-slate-600 text-sm">{calc.arrobas0a12}@</p>
                                      <p className="font-bold text-emerald-900">R$ {calc.valor0a12}</p>
                                    </div>
                                  </div>
                                </div>
                              )}
                              {calc.qtd13a24 > 0 && (
                                <div className="bg-white p-3 rounded-lg">
                                  <div className="flex justify-between items-center">
                                    <div>
                                      <span className="font-semibold text-slate-700">13-24 meses</span>
                                      <span className="text-slate-600 text-sm ml-2">({calc.qtd13a24} animais × 20@)</span>
                                    </div>
                                    <div className="text-right">
                                      <p className="text-slate-600 text-sm">{calc.arrobas13a24}@</p>
                                      <p className="font-bold text-emerald-900">R$ {calc.valor13a24}</p>
                                    </div>
                                  </div>
                                </div>
                              )}
                              {calc.qtd25a36 > 0 && (
                                <div className="bg-white p-3 rounded-lg">
                                  <div className="flex justify-between items-center">
                                    <div>
                                      <span className="font-semibold text-slate-700">25-36 meses</span>
                                      <span className="text-slate-600 text-sm ml-2">({calc.qtd25a36} animais × 35@)</span>
                                    </div>
                                    <div className="text-right">
                                      <p className="text-slate-600 text-sm">{calc.arrobas25a36}@</p>
                                      <p className="font-bold text-emerald-900">R$ {calc.valor25a36}</p>
                                    </div>
                                  </div>
                                </div>
                              )}
                              {calc.qtdAcima36 > 0 && (
                                <div className="bg-white p-3 rounded-lg">
                                  <div className="flex justify-between items-center">
                                    <div>
                                      <span className="font-semibold text-slate-700">>36 meses</span>
                                      <span className="text-slate-600 text-sm ml-2">({calc.qtdAcima36} animais × 35@)</span>
                                    </div>
                                    <div className="text-right">
                                      <p className="text-slate-600 text-sm">{calc.arrobasAcima36}@</p>
                                      <p className="font-bold text-emerald-900">R$ {calc.valorAcima36}</p>
                                    </div>
                                  </div>
                                </div>
                              )}
                              <div className="bg-emerald-100 border-2 border-emerald-500 p-4 rounded-lg mt-3">
                                <div className="flex justify-between items-center">
                                  <div>
                                    <p className="font-bold text-emerald-900 text-lg">VALOR TOTAL DO REBANHO</p>
                                    <p className="text-emerald-700 text-sm">{calc.totalAnimais} animais • {calc.totalArrobas}@</p>
                                  </div>
                                  <p className="font-bold text-emerald-900 text-3xl">R$ {calc.totalValor}</p>
                                </div>
                              </div>
                            </div>
                          );
                        })()}
                      </div>
                    )}

                    {/* Upload PDF */}
                    <div className="bg-emerald-100 border-2 border-emerald-400 rounded-lg p-3 mb-3">
                      <label className="flex items-center gap-2 cursor-pointer">
                        <Upload size={20} className="text-emerald-700" />
                        <span className="font-semibold text-emerald-900">📎 Upload Ficha Sanitária (PDF)</span>
                        <input 
                          type="file" 
                          accept=".pdf" 
                          id="fichaSanitariaUpload" 
                          onChange={(e) => handleFileUpload(e.target.files[0], 'fichaSanitaria')} 
                          className="hidden" 
                        />
                      </label>
                      {currentProducao.fichaSanitariaFile && (
                        <button 
                          onClick={() => {
                            setCurrentProducao({...currentProducao, fichaSanitariaFile: null});
                            document.getElementById('fichaSanitariaUpload').value = '';
                          }}
                          className="mt-2 px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 flex items-center gap-1"
                        >
                          <X size={16} /> Remover PDF
                        </button>
                      )}
                    </div>

                    <button onClick={handleAddProducao} className="w-full py-3 bg-gradient-to-r from-amber-600 to-amber-700 text-white rounded-lg font-bold text-lg flex items-center justify-center gap-2 shadow-lg">
                      <Plus size={22} /> Adicionar Ficha Sanitária
                    </button>
                  </div>

                  {/* Lista de fichas cadastradas */}
                  {producaoData.length > 0 && (
                    <div id="secao-fichas-sanitarias" className="bg-white border-2 border-emerald-300 rounded-lg p-4">
                      <h4 className="font-bold text-emerald-900 mb-4 text-xl">✅ Fichas Sanitárias Cadastradas ({producaoData.length})</h4>
                      
                      {producaoData.map((ficha, i) => {
                        const totalFicha = (
                          parseInt(ficha.bovideoMacho0a12 || 0) +
                          parseInt(ficha.bovideoFemea0a12 || 0) +
                          parseInt(ficha.bovideoMacho13a24 || 0) +
                          parseInt(ficha.bovideoFemea13a24 || 0) +
                          parseInt(ficha.bovideoMacho25a36 || 0) +
                          parseInt(ficha.bovideoFemea25a36 || 0) +
                          parseInt(ficha.bovideoMachoAcima36 || 0) +
                          parseInt(ficha.bovideoFemeaAcima36 || 0)
                        );
                        
                        return (
                          <div key={ficha.id} className="bg-amber-50 border-2 border-amber-300 rounded-lg p-4 mb-3">
                            <div className="flex justify-between items-center mb-3">
                              <h5 className="font-bold text-amber-900 text-lg">Ficha {i + 1}</h5>
                              <div className="flex gap-2">
                                <button 
                                  onClick={() => {
                                    setCurrentProducao(ficha);
                                    setProducaoData(producaoData.filter((_, idx) => idx !== i));
                                    window.scrollTo({ top: 0, behavior: 'smooth' });
                                  }}
                                  className="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center gap-2"
                                >
                                  <Edit size={18} /> Editar
                                </button>
                                <button 
                                  onClick={() => setProducaoData(producaoData.filter((_, idx) => idx !== i))} 
                                  className="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center gap-2"
                                >
                                  <Trash2 size={18} /> Remover
                                </button>
                              </div>
                            </div>
                            
                            <div className="grid grid-cols-8 gap-2">
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">M 0-12m</p>
                                <p className="font-bold text-lg">{ficha.bovideoMacho0a12 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">F 0-12m</p>
                                <p className="font-bold text-lg">{ficha.bovideoFemea0a12 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">M 13-24m</p>
                                <p className="font-bold text-lg">{ficha.bovideoMacho13a24 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">F 13-24m</p>
                                <p className="font-bold text-lg">{ficha.bovideoFemea13a24 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">M 25-36m</p>
                                <p className="font-bold text-lg">{ficha.bovideoMacho25a36 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">F 25-36m</p>
                                <p className="font-bold text-lg">{ficha.bovideoFemea25a36 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">M >36m</p>
                                <p className="font-bold text-lg">{ficha.bovideoMachoAcima36 || 0}</p>
                              </div>
                              <div className="text-center">
                                <p className="text-xs text-amber-800 mb-1">F >36m</p>
                                <p className="font-bold text-lg">{ficha.bovideoFemeaAcima36 || 0}</p>
                              </div>
                            </div>
                            
                            <div className="mt-3 bg-amber-200 rounded-lg p-2 text-center">
                              <p className="font-bold text-amber-900">Total: {totalFicha} animais</p>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  )}
                  
                  {/* Botão Salvar da Etapa Produção */}
                  <div className="mt-6 flex justify-end">
                    <button 
                      onClick={() => handleSalvarEtapa('Produção')} 
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all flex items-center gap-2 shadow-md"
                    >
                      <Save size={20} /> Salvar Produção / Ficha Sanitária
                    </button>
                  </div>
                </div>
              )}

              {activeMenu === 'dashboard' && (
                <div className="space-y-6 max-w-6xl">
                  <h3 className="text-3xl font-bold text-emerald-900">📊 Dashboard do Cliente</h3>
                  
                  {/* Grid de Cards Principais */}
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div 
                      onClick={() => setActiveMenu('propriedades')}
                      className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white cursor-pointer hover:shadow-2xl hover:scale-105 transition-all"
                    >
                      <Building2 size={32} className="mb-3" />
                      <h3 className="text-4xl font-bold">{propriedadesData.length}</h3>
                      <p className="text-blue-100 text-sm">Propriedades</p>
                      <p className="text-xs mt-2 font-semibold">
                        {propriedadesData.reduce((acc, p) => acc + parseFloat(p.hectares.replace(',', '.') || 0), 0).toFixed(2)} ha
                      </p>
                    </div>

                    <div 
                      onClick={() => setActiveMenu('maquinas')}
                      className="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl p-6 text-white cursor-pointer hover:shadow-2xl hover:scale-105 transition-all"
                    >
                      <Tractor size={32} className="mb-3" />
                      <h3 className="text-4xl font-bold">
                        {maquinasData.reduce((acc, m) => acc + parseInt(m.quantidade || 1), 0)}
                      </h3>
                      <p className="text-yellow-100 text-sm">Máquinas</p>
                      <p className="text-xs mt-2 font-semibold">
                        R$ {maquinasData.reduce((acc, m) => {
                          const valor = m.valorEstimado ? parseFloat(m.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                          const qtd = parseInt(m.quantidade || 1);
                          return acc + (valor * qtd);
                        }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                      </p>
                    </div>

                    <div 
                      onClick={() => setActiveMenu('veiculos')}
                      className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white cursor-pointer hover:shadow-2xl hover:scale-105 transition-all"
                    >
                      <Truck size={32} className="mb-3" />
                      <h3 className="text-4xl font-bold">{veiculosData.length}</h3>
                      <p className="text-purple-100 text-sm">Veículos</p>
                      <p className="text-xs mt-2 font-semibold">
                        R$ {veiculosData.reduce((acc, v) => {
                          const valor = v.valorEstimado ? parseFloat(v.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                          return acc + valor;
                        }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                      </p>
                    </div>

                    <div 
                      onClick={() => setActiveMenu('imoveis')}
                      className="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white cursor-pointer hover:shadow-2xl hover:scale-105 transition-all"
                    >
                      <Building size={32} className="mb-3" />
                      <h3 className="text-4xl font-bold">{imoveisData.length}</h3>
                      <p className="text-orange-100 text-sm">Imóveis Urbanos</p>
                      <p className="text-xs mt-2 font-semibold">
                        R$ {imoveisData.reduce((acc, im) => {
                          const valor = im.valorEstimado ? parseFloat(im.valorEstimado.replace(/\./g, '').replace(',', '.')) : 0;
                          return acc + valor;
                        }, 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                      </p>
                    </div>
                  </div>

                  {/* Cards de Produção - TODAS AS MODALIDADES */}
                  {(culturasData.length > 0 || fruticultura.length > 0 || producaoData.length > 0) && (
                    <div>
                      <h4 className="text-xl font-bold text-emerald-900 mb-3">🌾 Produção Agropecuária</h4>
                      <div className="grid grid-cols-4 gap-4">
                        
                        {/* Culturas Agrícolas */}
                        {culturasData.sort((a, b) => {
                          if (a.tipo === 'SOJA') return -1;
                          if (b.tipo === 'SOJA') return 1;
                          if (a.tipo === 'MILHO') return -1;
                          if (b.tipo === 'MILHO') return 1;
                          return 0;
                        }).map((cult, i) => (
                          <div 
                            key={cult.id} 
                            onClick={() => {
                              setActiveMenu('producao');
                              setTimeout(() => {
                                const secaoId = cult.tipo === 'SOJA' ? 'secao-soja-cadastrada' : 
                                               cult.tipo === 'MILHO' ? 'secao-milho-cadastrado' : 
                                               `cultura-${cult.tipo.toLowerCase()}`;
                                const elemento = document.getElementById(secaoId);
                                if (elemento) {
                                  elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                }
                              }, 100);
                            }}
                            className="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-400 rounded-xl p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                          >
                            <h5 className="font-bold text-green-900 text-lg mb-1">{cult.tipo}</h5>
                            <p className="text-sm text-green-700 mb-2">{cult.hectares} hectares</p>
                            <div className="space-y-1 text-xs">
                              <div className="flex justify-between">
                                <span className="text-green-700">Bruto:</span>
                                <span className="font-semibold text-green-900">R$ {cult.receitaBruta}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-green-700">Líquido:</span>
                                <span className={`font-semibold ${cult.lucroPositivo ? 'text-emerald-900' : 'text-red-900'}`}>
                                  R$ {cult.lucroLiquido}
                                </span>
                              </div>
                              <div className="bg-green-200 rounded px-2 py-1 mt-2">
                                <div className="flex justify-between items-center">
                                  <span className="font-bold text-green-800">Margem:</span>
                                  <span className="font-bold text-green-900">{cult.margem}%</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        ))}

                        {/* Fruticultura */}
                        {fruticultura.map((frut, i) => {
                          const unmask = (v) => v ? parseFloat(v.replace(',', '.')) : 0;
                          const ha = unmask(frut.hectares);
                          const kilosHa = unmask(frut.kilosHa);
                          const vendaKg = unmask(frut.vendaKg);
                          const custoKg = unmask(frut.custoKg);
                          const receitaBruta = ha * kilosHa * vendaKg;
                          const custoTotal = ha * kilosHa * custoKg;
                          const lucroLiquido = receitaBruta - custoTotal;

                          return (
                            <div 
                              key={i} 
                              onClick={() => {
                                setActiveMenu('producao');
                                setTimeout(() => {
                                  const elemento = document.getElementById('secao-fruticultura-cadastrada');
                                  if (elemento) {
                                    elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                  }
                                }, 100);
                              }}
                              className="bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-400 rounded-xl p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                            >
                              <h5 className="font-bold text-orange-900 text-lg mb-1">{frut.cultura}</h5>
                              <p className="text-sm text-orange-700 mb-2">{frut.hectares} hectares</p>
                              <div className="space-y-1 text-xs">
                                <div className="flex justify-between">
                                  <span className="text-orange-700">Bruto:</span>
                                  <span className="font-semibold text-orange-900">
                                    R$ {receitaBruta.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                                  </span>
                                </div>
                                <div className="flex justify-between">
                                  <span className="text-orange-700">Líquido:</span>
                                  <span className={`font-semibold ${lucroLiquido >= 0 ? 'text-emerald-900' : 'text-red-900'}`}>
                                    R$ {lucroLiquido.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                                  </span>
                                </div>
                                <div className="bg-orange-200 rounded px-2 py-1 mt-2">
                                  <div className="flex justify-between items-center">
                                    <span className="font-bold text-orange-800">Margem:</span>
                                    <span className="font-bold text-orange-900">
                                      {receitaBruta > 0 ? ((lucroLiquido / receitaBruta * 100).toFixed(1)) : '0'}%
                                    </span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          );
                        })}

                        {/* Pecuária */}
                        {producaoData.map((pr, i) => {
                          const bovideoMacho0a12 = parseInt(pr.bovideoMacho0a12 || 0);
                          const bovideoFemea0a12 = parseInt(pr.bovideoFemea0a12 || 0);
                          const bovideoMacho13a24 = parseInt(pr.bovideoMacho13a24 || 0);
                          const bovideoFemea13a24 = parseInt(pr.bovideoFemea13a24 || 0);
                          const bovideoMacho25a36 = parseInt(pr.bovideoMacho25a36 || 0);
                          const bovideoFemea25a36 = parseInt(pr.bovideoFemea25a36 || 0);
                          const bovideoMachoAcima36 = parseInt(pr.bovideoMachoAcima36 || 0);
                          const bovideoFemeaAcima36 = parseInt(pr.bovideoFemeaAcima36 || 0);
                          const totalFicha = bovideoMacho0a12 + bovideoFemea0a12 + bovideoMacho13a24 + bovideoFemea13a24 + 
                                           bovideoMacho25a36 + bovideoFemea25a36 + bovideoMachoAcima36 + bovideoFemeaAcima36;

                          return (
                            <div 
                              key={pr.id} 
                              onClick={() => {
                                setActiveMenu('producao');
                                setTimeout(() => {
                                  const elemento = document.getElementById('secao-fichas-sanitarias');
                                  if (elemento) {
                                    elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                  }
                                }, 100);
                              }}
                              className="bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-400 rounded-xl p-4 cursor-pointer hover:shadow-xl hover:scale-105 transition-all"
                            >
                              <h5 className="font-bold text-amber-900 text-lg mb-3">🐄 Ficha {i+1}</h5>
                              
                              <div className="space-y-2">
                                <div>
                                  <p className="text-xs text-amber-700">Rebanho:</p>
                                  <p className="text-2xl font-bold text-amber-900">{totalFicha} cabeças</p>
                                </div>
                                
                                <div>
                                  <p className="text-xs text-amber-700">Valor Rebanho:</p>
                                  <p className="text-lg font-bold text-amber-900">R$ {(pr.valorRebanho || 0).toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</p>
                                </div>
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  )}
                </div>
              )}

              {/* ============================================ */}
              {/* 8. ENDIVIDAMENTO - EM DESENVOLVIMENTO        */}
              {/* ============================================ */}
              {activeMenu === 'endividamento' && (
                <div className="space-y-6 max-w-6xl">
                  <h3 className="text-3xl font-bold text-emerald-900">💰 8. Endividamento</h3>
                  
                  <div className="bg-gradient-to-br from-yellow-50 to-yellow-100 border-4 border-yellow-400 rounded-2xl p-12 text-center">
                    <div className="text-8xl mb-6">🚧</div>
                    <h4 className="text-3xl font-bold text-yellow-900 mb-4">Módulo em Desenvolvimento</h4>
                    <p className="text-xl text-yellow-800 mb-6">
                      Em breve: Gestão completa de endividamento, controle de saldo devedor, alertas de vencimento e importação de dados do BACEN.
                    </p>
                    <div className="bg-white rounded-lg p-6 max-w-2xl mx-auto">
                      <h5 className="font-bold text-yellow-900 mb-3">Funcionalidades Planejadas:</h5>
                      <ul className="text-left text-yellow-800 space-y-2">
                        <li>✅ Dashboard de saldo devedor total</li>
                        <li>✅ Alertas de vencimentos (30, 60, 90 dias)</li>
                        <li>✅ Importação de dados BACEN (.csv/.xlsx)</li>
                        <li>✅ Cadastro manual de operações de crédito</li>
                        <li>✅ Análise de capacidade de pagamento</li>
                      </ul>
                    </div>
                  </div>
                </div>
              )}

              {/* ============================================ */}
              {/* 9. CONTRATOS - EM DESENVOLVIMENTO            */}
              {/* ============================================ */}
              {activeMenu === 'contratos' && (
                <div className="space-y-6 max-w-6xl">
                  <h3 className="text-3xl font-bold text-emerald-900">📄 9. Contratos</h3>
                  
                  <div className="bg-gradient-to-br from-blue-50 to-blue-100 border-4 border-blue-400 rounded-2xl p-12 text-center">
                    <div className="text-8xl mb-6">🚧</div>
                    <h4 className="text-3xl font-bold text-blue-900 mb-4">Módulo em Desenvolvimento</h4>
                    <p className="text-xl text-blue-800 mb-6">
                      Em breve: Gestão completa de contratos de crédito rural, timeline de vencimentos, histórico de negociações e gestão de garantias.
                    </p>
                    <div className="bg-white rounded-lg p-6 max-w-2xl mx-auto">
                      <h5 className="font-bold text-blue-900 mb-3">Funcionalidades Planejadas:</h5>
                      <ul className="text-left text-blue-800 space-y-2">
                        <li>✅ Cadastro completo de contratos</li>
                        <li>✅ Timeline de vencimentos</li>
                        <li>✅ Gestão de garantias vinculadas</li>
                        <li>✅ Histórico de prorrogações/renegociações</li>
                        <li>✅ Alertas automáticos de vencimento</li>
                        <li>✅ Análise de capacidade de negociação</li>
                      </ul>
                    </div>
                  </div>
                </div>
              )}

              {/* ============================================ */}
              {/* 10. RELATÓRIOS - EM DESENVOLVIMENTO          */}
              {/* ============================================ */}
              {activeMenu === 'relatorios' && (
                <div className="space-y-6 max-w-6xl">
                  <h3 className="text-3xl font-bold text-emerald-900">📊 10. Relatórios</h3>
                  
                  <div className="bg-gradient-to-br from-purple-50 to-purple-100 border-4 border-purple-400 rounded-2xl p-12 text-center">
                    <div className="text-8xl mb-6">🚧</div>
                    <h4 className="text-3xl font-bold text-purple-900 mb-4">Módulo em Desenvolvimento</h4>
                    <p className="text-xl text-purple-800 mb-6">
                      Em breve: Central de relatórios com exportação para Excel e PDF de todas as áreas do sistema.
                    </p>
                    <div className="bg-white rounded-lg p-6 max-w-2xl mx-auto">
                      <h5 className="font-bold text-purple-900 mb-3">Funcionalidades Planejadas:</h5>
                      <ul className="text-left text-purple-800 space-y-2">
                        <li>✅ Relatório de Propriedades (Excel/PDF)</li>
                        <li>✅ Relatório de Produção (Excel/PDF)</li>
                        <li>✅ Relatório Financeiro (Excel/PDF)</li>
                        <li>✅ Relatório de Endividamento (Excel/PDF)</li>
                        <li>✅ Relatório de Patrimônio (Excel/PDF)</li>
                        <li>✅ Dashboard Executivo Completo</li>
                        <li>✅ Análises Comparativas</li>
                      </ul>
                    </div>
                  </div>
                </div>
              )}

            </div>
          </div>

          <div className="bg-emerald-50 border-t-2 border-emerald-200 p-6 flex justify-between items-center sticky bottom-0">
            <button onClick={onClose} className="px-6 py-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition-all">
              Cancelar
            </button>
            
            <div className="flex gap-3">
              {/* Botão Voltar - só aparece se não for a primeira aba */}
              {activeMenu !== 'cliente' && (
                <button 
                  onClick={handleVoltar} 
                  className="px-6 py-3 bg-gray-400 text-white rounded-lg font-semibold hover:bg-gray-500 transition-all flex items-center gap-2"
                >
                  <ArrowLeft size={20} /> Voltar
                </button>
              )}
              
              {/* Botão Salvar Rascunho - sempre visível */}
              <button 
                onClick={handleSalvarRascunho} 
                className="px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-all flex items-center gap-2"
              >
                <Save size={20} /> Salvar Rascunho
              </button>
              
              {/* Botão Avançar - só aparece se não for a última aba */}
              {activeMenu !== 'producao' && (
                <button 
                  onClick={handleAvancar} 
                  className="px-6 py-3 bg-emerald-500 text-white rounded-lg font-semibold hover:bg-emerald-600 transition-all flex items-center gap-2"
                >
                  Avançar <ChevronRight size={20} />
                </button>
              )}
              
              {/* Botão Finalizar - só aparece na última aba */}
              {activeMenu === 'producao' && (
                <button 
                  onClick={handleFinalizar} 
                  className="px-8 py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-lg font-bold text-lg hover:from-emerald-700 hover:to-emerald-800 transition-all shadow-lg flex items-center gap-2"
                >
                  <CheckCircle size={22} /> Finalizar Cadastro
                </button>
              )}
            </div>
          </div>
        </div>
      </div>

      {/* ========== DIÁLOGO DE CONFIRMAÇÃO E APRENDIZADO ========== */}
      {showConfirmDialog && pendingExtraction && (
        <div className="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div className="bg-gradient-to-r from-blue-600 to-blue-700 p-6 text-white">
              <h3 className="text-2xl font-bold">🤖 OCR Inteligente - Confirme os Dados</h3>
              <p className="text-blue-100 mt-1">Revise e corrija os campos. O sistema aprenderá com suas correções!</p>
            </div>

            <div className="p-6 space-y-4">
              <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                <p className="font-semibold text-blue-900 mb-2">
                  ✅ {Object.keys(pendingExtraction.extractedData).filter(k => pendingExtraction.extractedData[k]).length} campos extraídos automaticamente
                </p>
                <p className="text-sm text-blue-700">
                  Campos com fundo verde foram preenchidos. Revise-os e faça correções se necessário.
                </p>
              </div>

              <div className="grid grid-cols-2 gap-4">
                {Object.keys(pendingExtraction.extractedData).filter(k => !k.endsWith('File')).map(field => (
                  <div key={field}>
                    <label className="block text-sm font-semibold text-gray-700 mb-1">
                      {field.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}
                    </label>
                    <input
                      type="text"
                      value={userCorrections[field] !== undefined ? userCorrections[field] : pendingExtraction.extractedData[field] || ''}
                      onChange={(e) => setUserCorrections(prev => ({ ...prev, [field]: e.target.value }))}
                      className={`w-full px-3 py-2 border-2 rounded-lg ${
                        pendingExtraction.extractedData[field] ? 'border-green-500 bg-green-50' : 'border-gray-300'
                      }`}
                      placeholder={`Digite ${field}...`}
                    />
                  </div>
                ))}
              </div>

              <div className="bg-yellow-50 border-2 border-yellow-400 rounded-lg p-4">
                <p className="font-semibold text-yellow-900 mb-2">🎓 Sistema de Aprendizado</p>
                <p className="text-sm text-yellow-800">
                  Ao corrigir os campos, o sistema salvará os padrões e melhorará automaticamente nas próximas extrações!
                </p>
                <p className="text-xs text-yellow-700 mt-2">
                  Padrões salvos: {ocrPatterns[pendingExtraction.documentType]?.length || 0}
                </p>
              </div>
            </div>

            <div className="bg-gray-50 p-6 flex justify-between items-center border-t">
              <button
                onClick={() => {
                  setShowConfirmDialog(false);
                  setPendingExtraction(null);
                  setUserCorrections({});
                }}
                className="px-6 py-2 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600"
              >
                Cancelar
              </button>
              <button
                onClick={applyUserCorrections}
                className="px-8 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg font-bold hover:from-green-700 hover:to-green-800 shadow-lg flex items-center gap-2"
              >
                <CheckCircle size={22} /> Confirmar e Aprender
              </button>
            </div>
          </div>
        </div>
      )}
      {/* ========== FIM DO DIÁLOGO ========== */}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<AgilMasterPC/>);
</script>
</body>
</html>
